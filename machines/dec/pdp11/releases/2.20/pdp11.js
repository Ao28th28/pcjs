(function(){/*
 https://www.pcjs.org/modules/v1/messages.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/diskapi.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/dumpapi.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/reportapi.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/userapi.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/keys.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/strlib.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/weblib.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/messages.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/device.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/cpu.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/rom.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/ram.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/keyboard.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/pc11.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/rk11.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/rl11.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/rx11.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/computer.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/state.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/embed.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v1/format.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/defines.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/usrlib.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/component.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/panel.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/bus.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/memory.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/cpustate.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/cpuops.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/serial.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/disk.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/drive.js (C) 2012-2023 Jeff Parsons
 https://www.pcjs.org/modules/v2/debugger.js (C) 2012-2023 Jeff Parsons
*/
var k;function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:aa(a)}}function ca(a){if(!(a instanceof Array)){a=ba(a);for(var b,c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}
var da="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ea="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function fa(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var ha=fa(this);function t(a,b){if(b)a:{var c=ha;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ea(c,a,{configurable:!0,writable:!0,value:b})}}var ia;
if("function"==typeof Object.setPrototypeOf)ia=Object.setPrototypeOf;else{var ja;a:{var ka={a:!0},la={};try{la.__proto__=ka;ja=la.a;break a}catch(a){}ja=!1}ia=ja?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ma=ia;
function u(a,b){a.prototype=da(b.prototype);a.prototype.constructor=a;if(ma)ma(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.Gk=b.prototype}function na(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}
t("String.prototype.replaceAll",function(a){return a?a:function(b,c){if(b instanceof RegExp&&!b.global)throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument.");return b instanceof RegExp?this.replace(b,c):this.replace(new RegExp(String(b).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),c)}});
t("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var c=Math.floor(Math.abs(b));return 0>b?-c:c}});t("String.prototype.repeat",function(a){return a?a:function(b){if(null==this)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");var c=this;if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}});
t("Number.isNaN",function(a){return a?a:function(b){return"number"===typeof b&&isNaN(b)}});t("Symbol",function(a){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(f||"")+"_"+e++,f)}function c(f,g){this.i=f;ea(this,"description",{configurable:!0,writable:!0,value:g})}if(a)return a;c.prototype.toString=function(){return this.i};var d="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",e=0;return b});
t("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=ha[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&ea(d.prototype,a,{configurable:!0,writable:!0,value:function(){return pa(aa(this))}})}return a});function pa(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}
function qa(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}t("Array.prototype.keys",function(a){return a?a:function(){return qa(this,function(b){return b})}});t("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});
t("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;0>c&&(c=Math.max(0,e+c));if(null==d||d>e)d=e;d=Number(d);0>d&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});function ra(a){return a?a:Array.prototype.fill}t("Int8Array.prototype.fill",ra);t("Uint8Array.prototype.fill",ra);t("Uint8ClampedArray.prototype.fill",ra);t("Int16Array.prototype.fill",ra);t("Uint16Array.prototype.fill",ra);t("Int32Array.prototype.fill",ra);
t("Uint32Array.prototype.fill",ra);t("Float32Array.prototype.fill",ra);t("Float64Array.prototype.fill",ra);function sa(){this.i={};for(var a=0;23>a;a++)this.i["ACDFGHMNSTWYBbdfjcsoXx%"[a]]=null}
function ta(){var a=na.apply(0,arguments);if(void 0===a[0])a=new Date(Date.now());else if("string"===typeof a[0]){var b=a[0];0>b.indexOf(":")?b+=" "+(a[1]||"00:00:00 UTC"):b.match(/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]$/)&&(a[1]||(b+=" UTC"));a=new Date(b)}else a=void 0===a[1]?new Date(a[0]):new Date(Date.UTC.apply(Date,ca(a)));return a}
sa.prototype.g=function(a){var b=na.apply(1,arguments);if(!b||!b.length)return a;var c="",d=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([bwhlL]?)([A-Za-z%])/),e=0,f;for(f=0;f<d.length-6;f+=6){c+=d[f];var g=d[f+5];if(void 0===this.i[g])c+="%"+d[f+1]+d[f+2]+d[f+3]+d[f+4]+g;else{if(e<b.length){var h=b[e];"%"!=g&&e++}else h=b[b.length-1];var l=d[f+1],m=0<=l.indexOf("#"),n=0<=l.indexOf("0"),p=d[f+2];"*"==p?(p=h,h=e<b.length?b[e++]:b[b.length-1]):p=+p||0;var q=d[f+3];q=q?+q.substr(1):-1;var r=d[f+4],w=null,
B=0,z="",x=0<="ACDFGHMNSTWY".indexOf(g)&&"object"!=typeof h?ta(h):h;switch(g){case "C":c+=isNaN(x.getTime())?void 0:this.g("%#W, %#F %#D, %#Y".replaceAll("#",m?"#":""),x);continue;case "D":h=m?x.getUTCDate():x.getDate();g="d";break;case "A":case "G":case "H":h=m?x.getUTCHours():x.getHours();"A"==g?(h=12>h?"am":"pm",g="s"):("G"==g&&(h=h?12<h?h-12:h:12),g="d");break;case "F":case "M":h=m?x.getUTCMonth():x.getMonth();"F"==g?(h=xa[h],g="s"):(h++,g="d");break;case "N":h=m?x.getUTCMinutes():x.getMinutes();
g="d";break;case "S":h=m?x.getUTCSeconds():x.getSeconds();g="d";break;case "T":c+=isNaN(x.getTime())?void 0:this.g("%#Y-%#02M-%#02D %#02H:%#02N:%#02S".replaceAll("#",m?"#":""),x);continue;case "W":h=ya[m?x.getUTCDay():x.getDay()];g="s";break;case "Y":h=m?x.getUTCFullYear():x.getFullYear(),0<q&&(h%=Math.pow(10,q),q=-1),g="d"}switch(g){case "b":c+=h?"true":"false";break;case "d":h=Math.trunc(h),0<=q&&(n=!0,p<q&&(p=q),q=-1);case "f":h=+h;g=h+"";0<=q&&(g=h.toFixed(q));g.length<p&&(n?(0>h&&(p--,g=g.substr(1)),
g=("0".repeat(p)+g).slice(-p),0>h&&(g="-"+g)):g=(" ".repeat(p)+g).slice(-p));c+=g;break;case "j":c+=JSON.stringify(h,null,p||void 0);break;case "c":h="string"==typeof h?h[0]:String.fromCharCode(h);case "s":if(void 0!=h)for("string"!=typeof h&&(h=h.toString()),0<=q&&(h=h.substr(0,q));h.length<p;)h=0<=l.indexOf("-")?h+" ":" "+h;c+=h;break;case "B":B=2,m&&(z="0b");case "o":B||(B=8),!z&&m&&(z="0o");case "X":w=za;case "x":g="";B||(B=16);!z&&m&&(z="0x");w||(w=Aa);h=Math.trunc(h);0<=q&&(n=!0,p<q&&(p=q));
n&&!p&&("b"==r?p=2:"h"==r||"w"==r?p=4:"l"==r?p=8:(p=Math.abs(h),p=255>=p?2:65535>=p?4:4294967295>=p?8:9),p+=z.length);p-=z.length;do m=16,Number.isNaN(h)||(m=h&B-1,h=Math.trunc(h/B)),n||!g||m||h?g=w[m]+g:(z&&(g=z+g,z=""),0<p&&(g=" "+g));while(0<--p||h);c+=z+g;break;case "%":c+="%";break;default:c=this.i[g]?c+this.i[g](g,l,p,q,h):c+("(unimplemented sprintf type: %"+g+")")}}}return c+=d[f]};
var Aa="0123456789abcdef?",za="0123456789ABCDEF?",ya="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),xa="January February March April May June July August September October November December".split(" "),v={warn:549755813888,halt:70368744177664,buffer:0x800000000000},Ba="undefined"!=typeof window?{}:global,y="undefined"!=typeof window?window:global,Ca="undefined"!=typeof document?document:{};y.PCjs||(y.PCjs={});var A=y.PCjs;A.machines||(A.machines={});
A.components||(A.components=[]);A.commands||(A.commands={});y.WEBLOCAL=!1;
var Da={163840:[40,1,8,,254],184320:[40,1,9,,252],327680:[40,2,8,,255],368640:[40,2,9,,253],737280:[80,2,9,,249],1228800:[80,2,15,,249],1474560:[80,2,18,,240],1720320:[80,2,21,,240],1884160:[80,2,23,,249],2949120:[80,2,36,,240],10653696:[306,4,17],21411840:[615,4,17],256256:[77,1,26,128],2494464:[203,2,12,512],5242880:[256,2,40,256],10485760:[512,2,40,256]},Ea={ui:0,Ae:1,Di:2,Ei:3,Fi:4,Gi:5,Hi:6,Ii:7,Id:8,Ji:9,Be:10,Ki:11,Li:12,Ce:13,Mi:14,Ni:15,Oi:16,Pi:17,Qi:18,Ri:19,Si:20,Ti:21,Ui:22,Vi:23,Wi:24,
Xi:25,Yi:26,ej:27," ":32,"!":33,'"':34,"#":35,$:36,"%":37,"&":38,"'":39,"(":40,")":41,"*":42,"+":43,",":44,"-":45,".":46,"/":47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,":":58,";":59,"<":60,"=":61,">":62,"?":63,"@":64,Gd:65,pi:66,xi:67,Zi:68,E:69,gj:70,jj:71,vj:72,xj:73,yj:74,zj:75,Aj:76,Dj:77,Fj:78,Lj:79,Oj:80,Q:81,Qj:82,Tj:83,bk:84,ek:85,gk:86,hk:87,lk:88,mk:89,tf:90,"[":91,"\\":92,"]":93,"^":94,_:95,"`":96,a:97,b:98,c:99,d:100,e:101,f:102,sk:103,tk:104,uk:105,zk:106,k:107,Ak:108,Bk:109,
n:110,Ck:111,p:112,q:113,r:114,Dk:115,t:116,Hk:117,Ik:118,w:119,x:120,y:121,z:122,"{":123,"|":124,"}":125,"~":126,Ub:127};function Fa(){}
function Ga(a,b){if(a){b||(b=10);var c,d=0<a.indexOf(",");d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);"#"==c?(b=8,c=""):"$"==c&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),"0b"==c&&d||"^B"==c?(b=2,c=""):"0o"==c||"^O"==c?(b=8,c=""):"^D"==c?(b=10,c=""):"0x"==c&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);"Y"==c||"y"==c?(b=2,c=""):"."==c?(b=10,c=""):"H"==c||"h"==c?(b=16,c=""):"K"==c?c="000":"M"==c?c="000000":"G"==c&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var f;e=0;10>=b&&(c=a.match(/(-?[0-9]+)B([0-9]*)/))&&
(a=c[1],e=35-((c[2]||35)&255));if((b&&10!=b?16==b?null!==a.match(/^-?[0-9a-f]+$/i):8==b?null!==a.match(/^-?[0-7]+$/):2==b&&null!==a.match(/^-?[01]+$/):null!==a.match(/^-?[0-9]+$/))&&!isNaN(f=parseInt(a,b))){e&&(0>f&&(f+=Math.pow(2,36)),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));var g=f}}return g}
function Ha(a,b,c,d,e){e=void 0===e?0:e;var f="";isNaN(a)||"number"!=typeof a?a=null:(0>a&&-1<a&&(a=-1),0>a&&(a+=Math.pow(b,c)),a>=Math.pow(b,c)&&(c=Math.ceil(Math.log(a)/Math.log(b))));for(var g=e||-1;0<c--;){g||(f=","+f,g=e);if(null==a)f="?"+f;else{var h=a%b;h+=0<=h&&9>=h?48:55;f=String.fromCharCode(h)+f;a=Math.trunc(a/b)}g--}return(void 0===d?"":d)+f}function Ja(a,b,c){b?36<b&&(b=36):(b=Math.abs(a),b=255>=b?8:262143>=b?18:36);return Ha(a,2,b,"",c)}
function Ka(a,b,c){b?12<b&&(b=12):(b=Math.abs(a),b=262143>=b?6:16777215>=b?8:12);return Ha(a,8,b,c?"0o":"")}function La(a,b){b?11<b&&(b=11):b=99999>=Math.abs(a)?5:11;return Ha(a,10,b)}function Ma(a,b,c){b?9<b&&(b=9):(b=Math.abs(a),b=65535>=b?4:4294967295>=b?8:9);return Ha(a,16,b,c?"0x":"")}function Na(a,b){var c=a,d=a.lastIndexOf("/");0<=d&&(c=a.substr(d+1));d=c.indexOf("&");0<d&&(c=c.substr(0,d));b&&(d=c.lastIndexOf("."),0<d&&(c=c.substring(0,d)));return c}
function Qa(a){var b="",c=a.lastIndexOf(".");0<=c&&(b=a.substr(c+1).toLowerCase(),"json5"==b&&(b="json"));return b}function Ra(a,b){return-1!==a.indexOf(b,a.length-b.length)}function Sa(a){return a.replace(/[&<>"'$]/g,function(b){return Ta[b]})}function Ua(a,b){return(a+"                                        ").slice(0,b)}function Va(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}
var Ta={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;",$:"&dollar;"},Wa={0:"NUL",1:"SOH",2:"STX",3:"ETX",4:"EOT",5:"ENQ",6:"ACK",7:"BEL",8:"BS",9:"TAB",10:"LF",11:"VT",12:"FF",13:"CR",14:"SO",15:"SI",16:"DLE",17:"XON",18:"DC2",19:"XOFF",20:"DC4",21:"NAK",22:"SYN",23:"ETB",24:"CAN",25:"EM",26:"SUB",27:"ESC",28:"FS",29:"GS",30:"RS",31:"US",127:"DEL"},Xa=new sa,Ya=Xa.g.bind(Xa);
function Za(a,b,c){var d=0,e=a.length,f=0;for(void 0===c&&(c=function(l,m){return l>m?1:l<m?-1:0});d<e;){var g=d+e>>1,h=void 0;h=c(b,a[g]);0<h?d=g+1:(e=g,f=!h)}return f?d:~d}
function $a(a,b,c,d){function e(){if(4!==m.readyState)return null;try{g=n?m.response:m.responseText}catch(r){C(68719476736,"xmlHTTPRequest(%s) exception: %s\n",a,r.message)}if(null==g||200!=m.status&&(m.status||!g.length||"file:"!=(y.location?y.location.protocol:"file:")))if(f=m.status||-1,C(68719476736,"xmlHTTPRequest(%s) returned error %d\n",a,f),!m.status&&!ab){var q=a.match(/(^https?:\/\/[^/]+)(.*)/);q&&(ab=!0,bb("PCjs was unable to perform a cross-origin resource request to '"+q[1]+"'.\n\nIf you're running an ad blocker, try adding '"+
fb()+"' to your whitelist (or find a smarter ad blocker)."))}d&&d(a,g,f);return[g,f]}b=void 0===b?"text":b;c=void 0===c?!1:c;var f=0,g=null,h=null,l=y.resources;if("object"==typeof l&&(g=l[a]))return d&&d(a,g,f),[g,f];if(c&&"function"==typeof l)return l(a,function(q,r){d&&d(a,q,r)}),h;a=y.WEBLOCAL&&(y.location?y.location.hostname:"localhost").match(/^(.+\.local|localhost|0\.0\.0\.0|pcjs)$/)?a.replace(/^\/(diskettes|gamedisks|miscdisks|harddisks|decdisks|pcsigdisks|pcsig[0-9a-z]*-disks|private)\//,
"/disks/$1/").replace(/^\/discs\/([^/]*)\//,"/disks/cdroms/$1/"):a.replace(/^\/(disks\/|)(diskettes|gamedisks|miscdisks|harddisks|decdisks|pcsigdisks|pcsig[0-9a-z]*-disks|private)\//,"https://$2.pcjs.org/").replace(/^\/(disks\/cdroms|discs)\/([^/]*)\//,"https://$2.pcjs.org/");if(Ba.Xf&&(g=Ba.Xf(a),void 0!==g))return d&&d(a,g,f),[g,f];if(y.XMLHttpRequest)var m=new y.XMLHttpRequest;else if(y.ActiveXObject)m=new y.ActiveXObject("Microsoft.XMLHTTP");else if(y.fetch)return fetch(a).then(function(q){switch(b){case "json":case "text":return q.text();
case "arraybuffer":return q.arrayBuffer();default:throw Error("unsupported response type: "+b);}}).then(function(q){d&&d(a,q,f)}).catch(function(){d&&d(a,g,f)}),h;var n=!1;l="string"===typeof m.responseType;c&&(m.onreadystatechange=e);if(b&&"object"==typeof b){l="";for(var p in b)b.hasOwnProperty(p)&&(l&&(l+="&"),l+=p+"="+encodeURIComponent(b[p]));l=l.replace(/%20/g,"+");m.open("POST",a,c);m.setRequestHeader("Content-type","application/x-www-form-urlencoded");m.send(l)}else m.open("GET",a,c),"arraybuffer"==
b&&(l?(n=!0,m.responseType=b):m.overrideMimeType("text/plain; charset=x-user-defined")),m.send();c||(m.readyState=4,h=e());return h}
function gb(a,b){var c,d={ca:null,ia:null,za:null,ya:null};if("["==b.charAt(0)||"{"==b.charAt(0))try{var e,f;if("<"==b.charAt(0))throw Error(b);if(0>b.indexOf("0x")&&0>b.indexOf("0o")&&'["'!=b.substr(0,2)){0>b.indexOf('"values"')&&(b=b.replace(/([a-z]+):/gm,'"$1":').replace(/\/\/[^\n]*/gm,""));var g=JSON.parse(b)}else g=eval("("+b+")");d.za=g.load;d.ya=g.exec;var h=g.width,l=g.values;h&&l&&(8==h?g.bytes=l:16==h?g.words=l:32==h?g.longs=l:g.data=l);if(e=g.bytes)d.ca=e;else if(e=g.words)for(d.ca=Array(2*
e.length),f=c=0;c<e.length;c++)d.ca[f++]=e[c]&255,d.ca[f++]=e[c]>>8&255;else if(e=g.longs)for(d.ca=Array(4*e.length),f=c=0;c<e.length;c++)d.ca[f++]=e[c]&255,d.ca[f++]=e[c]>>8&255,d.ca[f++]=e[c]>>16&255,d.ca[f++]=e[c]>>24&255;else(e=g.data)?d.nk=e:d.ca=g;d.ca&&(d.ca.length?1==d.ca.length&&(D(d.ca[0]),d=null):(D("Empty resource: "+a),d=null));d.ia=g.symbols}catch(m){D("Resource data error ("+a+"): "+m.message),d=null}else{e=[];b=b.replace(/\n/gm," ").replace(/ +$/,"").split(" ");for(c=0;c<b.length;c++){f=
parseInt(b[c],16);if(isNaN(f)){D("Resource data error ("+a+"): invalid hex byte ("+b[c]+")");break}e.push(f&255)}c==b.length&&(d.ca=e)}return d}function fb(){return y.location?y.location.protocol+"//"+y.location.host:"https://www.pcjs.org"}
function hb(){if(null==ib){var a=!1;if(y.localStorage)try{y.localStorage.setItem("PCjs.localStorage","PCjs.localStorage"),a="PCjs.localStorage"==y.localStorage.getItem("PCjs.localStorage"),y.localStorage.removeItem("PCjs.localStorage")}catch(b){jb(b),a=!1}ib=a}return ib}function jb(a){C(1099511627776,"Local storage error: %s\n",a.message)}function kb(a){if(hb())try{var b=y.localStorage.getItem(a)}catch(c){jb(c)}return b}
function lb(a,b){if(hb())try{return y.localStorage.setItem(a,b),!0}catch(c){jb(c)}return!1}function mb(a){if(y.navigator){var b=y.navigator?y.navigator.userAgent:"";return"iOS"==a&&(!!b.match(/(iPod|iPhone|iPad)/)||"MacIntel"===y.navigator.platform&&1<y.navigator.maxTouchPoints)||"MSIE"==a&&!!b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)}return!1}function nb(){var a,b=ob("mobile");if(b)return"true"==b;if(mb("Mobi")){if(!a)return!0;(b="!"==a[0])&&(a=a.substr(1));return mb(a)!=b}return!1}
function ob(a){if(!pb){var b,c={};if(y.location){b||(b=y.location.search.substr(1));for(var d,e=/\+/g,f=/([^&=]+)=?([^&]*)/g;d=f.exec(b);)c[decodeURIComponent(d[1].replace(e," "))]=decodeURIComponent(d[2].replace(e," "))}pb=c}return pb[a]||pb[a.toLowerCase()]}function qb(a,b,c){function d(){--a;0<=a&&(b()||(a=0));0<a?setTimeout(d,0):c()}d()}
function tb(a,b){function c(){b(100===d)&&(e=setTimeout(c,d),d=100)}var d=0,e=null,f=!1;a.onmousedown=function(){f||e||(d=500,c())};a.ontouchstart=function(){e||(d=500,c())};a.onmouseup=a.onmouseout=function(){e&&(clearTimeout(e),e=null)};a.ontouchend=a.ontouchcancel=function(){e&&(clearTimeout(e),e=null);f=!0}}function ub(a,b){var c=y[a];y[a]="function"!==typeof c?b:function(){c&&c();b()}}function vb(a){wb.init.push(a)}
function xb(a){C(274877906944,"%s\n\nIf it happens again, please send the URL to support@pcjs.org. Thanks.\n",a)}function yb(a){if((a=wb[a])&&zb)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){xb("An unexpected error occurred: "+c.message)}}function Ab(a){!zb&&a?(zb=!0,Gb&&yb("init"),Hb&&yb("show")):zb=a}var pb=null,wb={init:[],show:[],exit:[]},Gb=!1,Hb=!1,zb=!0,ab=!1,ib=null;ub("onload",function(){Gb=!0;yb("init",!0)});ub("onpageshow",function(){Hb=!0;yb("show",!0)});
ub(mb("iOS")?"onpagehide":mb("Opera")?"onunload":"onbeforeunload",function(){yb("exit",!0)});
function E(a,b,c){this.type=a;b||(b={id:"",name:""});this.name=b.name;this.Qd=b.comment;this.rf=b;this.id=this.id=b.id||"";this.exports={};this.J=this.bindings={};a=this.id.indexOf(".");0>a?(this.fb="PCjs",this.Sc=this.id):(this.fb=this.id.substr(0,a),this.Sc=this.id.substr(a+1));this.flags={ready:!1,bb:!1,sd:!1,yk:!1,da:!1,Ed:!1,error:!1};this.Hc=null;this.flags.error=!1;this.ja=c||0;this.H=this.i=this.G=this.L=null;A.components.push(this)}
function Ib(a,b,c){A.machines[a]&&b&&(A.machines[a][b]=c,"parms"==b&&"string"==typeof c&&(A.machines[a].config=eval("("+c+")")))}function Jb(){return Date.now()||+new Date}function C(a){var b=na.apply(1,arguments);if(68719476736<=a&&1099511627776>=a){var c=!1;if("number"==typeof a){var d=a;a=b.shift();1099511627776==d?(c=!0,a="Error: "+a):549755813888==d?(c=!0,a="Warning: "+a):274877906944==d&&(c=!0)}b=Ya.apply(Fa,[a].concat(ca(b))).trim();c?bb(b):console.log(b)}}
function D(a){C(1099511627776,a)}function bb(a){y.alert&&y.alert(a);console.log(a)}function Kb(a){var b=!1;y.confirm&&(b=y.confirm(a));return b}
function Lb(a,b){b=Mb("pdp11-control","",b.parentNode);for(var c=0;c<b.length;c++)for(var d=b[c].childNodes,e=0;e<d.length;e++){var f=d[e];if(1===f.nodeType){var g=f.getAttribute("class");if(g)for(var h=g.split(" "),l=0;l<h.length;l++)switch(g=h[l],g){case "pdp11-binding":(g=Nb(f))&&void 0!==g.binding?a.ua(g.type,g.binding,f,g.value):g&&"description"==g.type||C(549755813888,'Component "%s" missing binding%s\n',a.toString(),g?" for "+g.type:""),l=h.length}}}}
function Ob(a){var b,c=[];a&&(a=0<(b=a.indexOf("."))?a.substr(0,b+1):"");var d=A.components;for(b=0;b<d.length;b++){var e=d[b];a&&e.id.indexOf(a)||c.push(e)}return c}function Pb(a,b){b=void 0===b?null:b;if(void 0!==a){var c;b&&0<(c=b.indexOf("."))&&(a=b.substr(0,c+1)+a);var d=A.components;for(c=0;c<d.length;c++)if(d[c].id===a)return d[c];d.length&&!1!==b&&C(549755813888,'Component ID "%s" not found\n',a)}return null}
function Qb(a,b){var c=void 0===c?null:c;if(void 0!==a){var d;b&&(b=0<(d=b.indexOf("."))?b.substr(0,d+1):"");var e=A.components;for(d=0;d<e.length;d++)if(c)c==e[d]&&(c=null);else if(!(a!=e[d].type||b&&e[d].id.indexOf(b)))return e[d]}return null}function Nb(a){var b=null;if(a.getAttribute){if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(d){D(d.message+" ("+a+")")}}else if(b=a.config||null){a=a.id;var c=b.id;a&&c&&0>c.indexOf(".")&&(b.id=a+"."+c)}return b}
function Mb(a,b,c){b=void 0===b?"":b;c=void 0===c?Ca:c;var d=[];b&&(a+="-"+b,"machine"!=b&&(a+="-object"));if(c.getElementsByClassName)d=c.getElementsByClassName(a);else if(c.getElementsByTagName){b=c.getElementsByTagName("*");var e=new RegExp("(^| )"+a+"( |$)");a=0;for(c=b.length;a<c;a++)e.test(b[a].className)&&d.push(b[a])}else for(a=Object.keys(A.machines),c=0;c<a.length;c++){e=a[c];var f=A.machines[e].config;if(f&&(f=f[b])){Array.isArray(f)||(f=[f]);f=ba(f);for(var g=f.next();!g.done;g=f.next())d.push({id:e,
config:g.value})}}return d}
function Rb(a){for(var b=!0,c=A.commands[a];c&&c.length;){var d=c.splice(0,1)[0],e=d[0];C(8796093022208,d.join(" "));var f=null;0<=Sb.indexOf(e)&&(f=function(){return function(){Rb(a)}}());var g=Tb[e];if(g)if(!f)b=g(d[1],d[2],d[3]);else{if(!g(f,d[1],d[2],d[3]))break}else{b=!1;var h=Qb(d[1],a);if(h)if(g=Ub[e])b=g(h,d[2],d[3]);else{var l=h.exports;if(l&&(g=l[e]))if(b=!0,!f)b=g.call(h,d[2],d[3]);else if(!g.call(h,f,d[2],d[3]))break}}if(!b){bb("Script error: '"+e+"' command "+(g?" failed":" not recognized"));
break}}c&&!c.length&&delete c[a];return b}k=E.prototype;k.toString=function(){return this.name?this.name:this.id||this.type};
k.ua=function(a,b,c){switch(b){case "clear":return this.J[b]||(this.J[b]=c,c.onclick=function(d){return function(){d.J.print&&(d.J.print.value="")}}(this)),!0;case "print":return this.J[b]||(this.J[b]=c,this.V=function(d){this.v(137438953472,"%s\n",d);return!0},c.value="",this.print=function(d,e){return function(f,g){f||(f="");if(4398046511104==(void 0===g?0:g)&&"...\n"==f.slice(-4)){g=f.slice(0,-1);var h=e.value,l=h.lastIndexOf(g);h=0>l?h+(g+"\n"):h.substr(0,l)+(f.slice(0,-1)+".")+h.substr(l+g.length);
8192<h.length&&(h=h.substr(h.length-4096));e.value=h}else e.value+=f,f=e.value,8192<f.length&&(e.value=f.substr(f.length-4096));e.scrollTop=e.scrollHeight}}(this,c)),!0;default:return!1}};k.log=function(){};k.print=function(a,b){C(void 0===b?0:b,a)};k.V=function(a,b,c){if(!b){var d=Qb("Computer",this.id);if(d&&d.flags.Ed)return console.log("ignoring notice during unload: "+a),!1}C(b?0:274877906944,"%s: %s\n",c||this.type,a);return!0};function Vb(a,b){a.flags.error=!0;a.V(b)}
function Wb(a){return a.flags.error?(a.print(a.toString()+" error\n"),!0):!1}function Xb(a,b){b&&(a.flags.ready?b():a.Hc=b);return a.flags.ready}function F(a,b){a.flags.error||(a.flags.ready=!1!==b,a.flags.ready&&(b=a.Hc,a.Hc=null,b&&b()))}function Yb(a,b){a.flags.bb&&(b?a.flags.sd=!0:void 0===b&&a.print(a.toString()+" busy\n"));return a.flags.bb}
function Zb(a,b){if(a.flags.sd)return a.flags.bb=!1,a.flags.sd=!1;if(a.flags.error)return a.print(a.toString()+" error\n"),!1;a.flags.bb=b;return a.flags.bb}k.Ca=function(){return this.flags.da=!0};k.Ba=function(a,b){b&&(this.flags.da=!1);return!0};function $b(a,b){var c=Math.pow(2,32),d=b/c|0;return(a&b)==(b|0)&&((a/c|0)&d)==d}function ec(a,b){b=void 0===b?0:b;b&1&&--b;b=b||a.ja;return!b||$b(0xff000000000,b)||a.H&&$b(a.H.ja,b)?!0:!1}
k.v=function(a){var b=na.apply(1,arguments),c=0;"number"==typeof a&&(c=a||4398046511104,a=b.shift(),68719476736==c?a=(this.id||this.type||"log")+": "+a:137438953472==c&&(a=this.type+": "+a));ec(this,c)&&(b=Ya.apply(Fa,[a].concat(ca(b))),this.H&&this.H.message?this.H.message(b,c):this.print(b,c),549755813888!=c&&1099511627776!=c||bb(b.trim()))};
var Sb=["hold","sleep","wait"],Tb={alert:function(a){bb(a);return!0},sleep:function(a,b){setTimeout(a,+b);return!1}},Ub={select:function(a,b,c){var d=!1;if(a=a.bindings[b])for(b=0;b<a.options.length;b++)if(a.options[b].textContent==c){a.selectedIndex!=b&&(a.selectedIndex=b);d=!0;break}return d}};Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;b++)if(this[b]===a)return b;return-1});Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return e.apply(this instanceof c&&a?this:a,d.concat(Array.prototype.slice.call(arguments)))}function c(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind: non-callable object");var d=Array.prototype.slice.call(arguments,1),e=this;c.prototype=this.prototype;b.prototype=new c;return b});
var fc="UNKNOWN PANIC ABORT ILLEGAL RED YELLOW FAULT TRACE HALT OPCODE INTERRUPT".split(" "),gc={md:5,qd:144,Vc:8,Bc:{kf:15,Uj:16,kk:32,Xd:64,Ea:128,ae:256,Yj:512,dj:1024,Ac:2048,cj:4096,fd:57344,la:{fd:13}},Ze:{ce:1,Ci:2,lf:3,Db:28,zc:32,yc:64,Rd:128,ck:256,De:512,Xb:1024,Pj:2048,$d:4096,ik:8192,Nj:16384,Ee:32768,ad:32736},Xe:{Vb:1,va:14,Cb:48,Bb:64,Ya:128,ak:256,fj:512,hj:1024,Le:2048,od:8192,ad:16384,eb:32768,Db:4608,Yb:61438,Sa:3967,la:{va:1,Cb:4}},Ye:{nd:15,dd:16,Tb:8160,nb:57344,la:{dd:4,Tb:5,
nb:13}},va:{ze:0,$b:2,ob:4,rd:6,Ec:8,Se:10,Fe:12,jk:14}},hc={md:5,qd:112,Vc:4,Re:"DY",cf:{Ea:1,va:14,Xa:48,Bb:64,Ya:128,nb:768,Jd:15360,aj:16384,eb:32768,yi:16254,Xj:128,Yb:65535,Sa:1022,la:{va:1,Xa:4,nb:8}},af:{Sa:65534},df:{mf:1,nf:4,pf:16,Vj:65408,Yd:63,Dc:64,Zb:65408,He:3,oj:8,la:{Dc:6,Zb:7}},Cc:{Ke:{Bj:0,$j:1,vi:2,Cj:3,Ec:4,Pe:5,fk:6,Zj:7},Kd:8,Je:16,lj:32,nj:64,Ie:128,mj:256,rj:512,tj:1024,qj:2048,pj:4096,uj:8192,kj:16384,sj:32768},bf:{$a:63},Jd:{Mj:1024,$i:2048,ce:2048,wj:3072,De:4096,Za:5120,
Xb:8192,Ej:9216},va:{Gj:0,rd:2,qf:4,Ec:6,We:8,sf:10,Te:12,Rj:14}},ic={md:5,qd:180,Vc:2,Re:"DX",ff:{Vb:1,va:14,pd:16,DONE:32,Bb:64,ab:128,INIT:16384,eb:32768,Db:16128,Yb:32992,Sa:16479},Sj:{},jf:{$a:127},hf:{$a:31},gf:{Hd:1,Ud:2,fd:4,Ub:64,Ea:128},va:{Yc:0,EMPTY:2,$b:4,ob:6,Db:8,Ve:10,Fc:12,Ue:14},Ge:{bd:8,cd:16,ri:24,Qe:32,ij:40,Wj:48,ld:56,Kj:72,Jj:80,Ij:88,Bi:96,ti:104,Hj:112,kd:120,Ai:128,si:136}},jc={48:"DL11R",52:"DL11X",56:"PC11R",60:"PC11X",64:"KW11",112:"RL11",144:"RK11",180:"RX11"},kc={};
ic.ef=["DX",77,1,26,128,1,0,0,128,0];gc.Ac=["RK",203,2,12,512,0,0,0,512,gc.Bc.Ac|gc.Bc.ae|gc.Bc.Xd];hc.$e=["RL",512,2,40,256,0,0,0,256,hc.Cc.Ke.Pe|hc.Cc.Kd|hc.Cc.Je];v.cpu=2;v.trap=4;v.fault=8;v["int"]=16;v.bus=32;v.memory=64;v.mmu=128;v.rom=256;v.device=512;v.panel=1024;v.keyboard=2048;v.key=4096;v.pc11=8192;v.paper=16384;v.disk=32768;v.read=65536;v.write=131072;v.rk11=262144;v.rl11=524288;v.rx11=1048576;v.dl11=2097152;v.serial=4194304;v.kw11=8388608;v.timer=16777216;v.speaker=33554432;
v.computer=67108864;
function lc(a,b){E.call(this,"Panel",a,1024);this.B=this.C=0;this.M=b;this.ga=this.u=this.Va=this.yb=0;this.F=this.I=-1;this.j=this.D=!1;this.K=mc;this.A={};this.g={START:[1,1,!0,!1,this.Pf],STEP:[1,1,!1,!1,this.Qf],ENABLE:[1,1,!1,!1,this.Kf],CONT:[1,1,!0,!1,this.If],DEP:[0,0,!0,!1,this.Jf],EXAM:[1,1,!0,!1,this.Lf],LOAD:[1,1,!0,!1,this.Nf],TEST:[0,0,!0,!1,this.Mf]};for(a=0;22>a;a++)this.g["S"+a]=[0,0,!1,!1,this.Of,a];this.H=this.i=this.G=this.L=null;this.exports={hold:this.Df,toggle:this.hh,reset:this.ah,
set:this.gh};F(this)}u(lc,E);function nc(a,b){return oc(a,a.yb=b)}k=lc.prototype;k.reset=function(a){this.stop();a&&nc(this,0)};
k.ua=function(a,b,c,d){if(this.L&&this.L.ua(a,b,c,d)||this.i&&this.i.ua(a,b,c,d)||this.H&&this.H.ua(a,b,c,d))return!0;switch(b){case "R0":case "R1":case "R2":case "R3":case "R4":case "R5":case "R6":case "R7":case "NF":case "ZF":case "VF":case "CF":case "PS":return this.J[b]=c,this.C++,!0;default:return"led"==a||"rled"==a?(this.J[b]=c,this.A[b]=d?1:0,this.C++,!0):"switch"==a?(void 0===this.g[b]&&(this.g[b]=[d?1:0,d?1:0]),this.J[b]=c,a=c.parentElement||c,a=a.parentElement||a,a.onmousedown=function(e,
f){return function(){pc(e,f)}}(this,b),a.onmouseup=a.onmouseout=function(e,f){return function(){qc(e,f)}}(this,b),a.ontouchstart=function(e,f){return function(g){pc(e,f);g.preventDefault()}}(this,b),a.ontouchend=function(e,f){return function(){qc(e,f)}}(this,b),!0):E.prototype.ua.call(this,a,b,c,d)}};k.Aa=function(a,b,c,d){this.L=a;this.G=b;this.i=c;this.H=d;rc(b,this,sc);tc(b,this.reset.bind(this));uc(this);vc(this)};
k.Ca=function(a,b){if(!b)if(this.M&&wc(),!a)this.reset(!0);else if(!this.restore(a))return!1;return!0};k.Ba=function(a){return a?this.save():!0};k.save=function(){var a=new xc(this);a.set(0,[this.ga,this.yb,this.Va]);return a.data()};k.restore=function(a){if(a=a[0])yc(this,this.ga=a[0]),nc(this,a[1]),zc(this,a[2]);return!0};k.ah=function(){for(var a in this.g){var b=this.g[a];b[1]=b[0]}vc(this);return!0};function Ac(a,b,c){if(a=a.J[b])a.style.backgroundColor=c?"#ff0000":"#000000"}
function uc(a,b){for(var c in a.A)Ac(a,c,null!=b?b:a.A[c])}function Bc(a,b,c){if(a=a.J[b])a.style.marginTop=c?"0px":"20px",a.style.backgroundColor=c?"#00ff00":"#228B22"}function vc(a){for(var b in a.g)Bc(a,b,a.g[b][1])}function Cc(a,b,c,d){if(a.J[b]){var e=a.H&&a.H.Y||8;c=c||0;c=8==e?Ka(c,d):Ma(c,d);a.J[b].textContent!=c&&(a.J[b].textContent=c)}}k.Df=function(a,b,c){if(pc(this,b)){if(c){var d=this;setTimeout(function(){qc(d,b);a&&a()},+c);return!1}qc(this,b)}return!0};
k.gh=function(a,b){if("SR"==a)return zc(this,Ga(b,8));var c=this.g[a];return c?(c[1]=+b?1:0,Bc(this,a,c[1]),!0):!1};k.hh=function(a){return pc(this,a)?(qc(this,a),!0):!1};function pc(a,b){var c=a.g[b];return c?(Bc(a,b,c[1]=1-c[1]),c[3]=!0,c[4]&&c[4].call(a,c[1],c[5]),b==Dc&&(a.j=!1),!0):!1}function qc(a,b){var c=a.g[b];c&&(c[2]&&c[3]&&(Bc(a,b,c[1]=c[0]),c[4]&&c[4].call(a,c[1],c[5])),c[3]=!1)}
k.Pf=function(a){a||this.i.flags.X||(Ec(this.i,this.ga),a=this.i,a.G.reset(),Fc(a),this.g[Gc]&&this.g[Gc][1]&&Hc(this.i))};k.Qf=function(){};k.Kf=function(a){a||Ic(this.i)};k.If=function(a){if(!a&&!this.i.flags.X)if(this.g[Gc]&&this.g[Gc][1])Hc(this.i);else{if((a=this.H)&&!Yb(a,!0))Zb(a,!0),Jc(a,0,null),Zb(a,!1);else try{var b=this.i.xc(1);0<b&&(Kc(this.i,b),Lc(this.i,b,!0),Wc(this.i,b))}catch(c){"number"!=typeof c&&(b=c,Vb(this.i,b.stack||b.message))}this.stop();this.L&&Xc(this.L)}};
k.Jf=function(a){if(a&&!this.i.flags.X)if(this.j&&Yc(this),this.j=!0,a=nc(this,this.Va),this.K==mc)Zc(this.G,this.ga,a);else{var b=this.i,c=this.ga;b.pa++;b.G.Wb($c(b,c,4),a);b.pa--}};k.Lf=function(a){a||this.i.flags.X||(this.j&&Yc(this),this.j=!0,a=this.K==mc?ad(this.G,this.ga):bd(this.i,this.ga),nc(this,a))};k.Nf=function(a){a||this.i.flags.X||yc(this,this.Va)};k.Mf=function(a){a?(this.D=!0,uc(this,!0)):(this.D=!1,uc(this),zc(this,0))};k.Of=function(a,b){this.Va=a?this.Va|1<<b:this.Va&~(1<<b)};
function Yc(a){var b=1140>=a.i.model?8:16,c=65472<=a.ga&&a.ga<65472+b;b=c?1:2;c=c?15:a.G.K;a.g[cd]&&a.g[cd][1]||(b=-b);yc(a,a.ga&~c|a.ga+b&c)}function yc(a,b){a.ga=b&a.G.K;if(a.F!==a.ga){a.F=a.ga;b=a.F;for(var c=0;22>c;c++)dd(a,"A"+c,b&1<<c)}}function oc(a,b){a.u=b&65535;if(a.I!==a.u){a.I=a.u;b=a.I;for(var c=0;16>c;c++)dd(a,"D"+c,b&1<<c)}return a.u}function dd(a,b,c){a.A[b]=c;a.D||Ac(a,b,c)}function zc(a,b){a.Va=b|0;for(b=0;22>b;b++)a.g["S"+b][1]=a.Va&1<<b?1:0;vc(a);return!0}
k.stop=function(){yc(this,this.i.j[7])};k.Cd=function(a){this.ga=a};k.setData=function(a,b){b?this.yb=a:this.u=a};k.Uf=function(a,b){return(b?this.yb:this.Va)&65535};k.mh=function(a){this.yb=a};function wc(){for(var a=Mb("pdp11","panel"),b=0;b<a.length;b++){var c=a[b],d=Nb(c),e=Pb(d.id,!1);e||(e=new lc(d,!0));Lb(e,c)}}var mc=7,Gc="ENABLE",Dc="LOAD",cd="STEP",ed={},sc=(ed[65400]=[null,null,lc.prototype.Uf,lc.prototype.mh,"CNSW"],ed);vb(wc);
function fd(a,b,c){E.call(this,"Bus",a,32);this.i=b;this.H=c;this.W=+a.busWidth||16;this.P=1<<this.W;this.K=this.P-1;this.u=gd;this.j=Math.log2(this.u);this.U=this.u>>2;this.A=this.u-1;this.M=this.P/this.u|0;this.Oa=[];this.B=0;this.I=!1;this.R=[];this.uf=[hd,id,jd,kd];this.g=this.C=[];this.F=this.O=this.D=this.S=this.T=0;a=new ld(this);md(a,this.H);this.g=Array(this.M);this.C=Array(this.M);for(b=0;b<this.M;b++)this.g[b]=this.C[b]=a;this.F=this.P-gd;nd(this,this.F,gd,od,this);this.T=this.S=(this.F&
this.K)>>>this.j;this.O=0;this.D=this.K;F(this)}u(fd,E);function pd(a,b){if(b!=a.O){for(var c=0;c<a.M;c++)a.C[c]=a.g[c];a.O=0;a.D=a.K;b&&(a.O=b,b=1<<b,a.D=b-1,b-=gd,a.T=(b&a.D)>>>a.j,a.C[a.T]=a.g[a.S])}}k=fd.prototype;k.reset=function(){for(var a=0;a<this.R.length;a++)this.R[a]();pd(this,16)};k.Ca=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};k.Ba=function(a){return a?this.save():!0};
k.save=function(){for(var a=new xc(this),b=a.set,c=0,d=[],e=0;e<this.M;e++){var f=this.g[e];if(f.wb||f.Bf){d[c++]=e;var g=c++;if(f=f.save()){for(var h=0,l=0,m=[];h<f.length;){for(var n=f[h],p=h+1;p<f.length&&f[p]===n;)p++;m[l++]=p-h;m[l++]=n;h=p}m.length<f.length&&(f=m)}d[g]=f}}b.call(a,0,d);return a.data()};
k.restore=function(a){a:{a=a[0];var b;for(b=0;b<a.length-1;b+=2){var c=a[b],d=a[b+1];if(d&&d.length<this.U){var e=this.U,f=0;e=e?Array(e):[];for(var g=0;g<d.length-1;)for(var h=d[g++],l=d[g++];h--;)e[f++]=l;d=e}f=this.g[c];if(!f||!f.restore(d)){D("Unable to restore memory block "+c);a=!1;break a}}a=!0}return a};
function nd(a,b,c,d,e){for(var f=b,g=c,h=f>>>a.j;0<g&&h<a.g.length;){var l=a.g[h],m=h*a.u,n=a.u-(f-m);n>g&&(n=g);if(!e&&l&&l.size){if(l.type==d){if(f+g<=l.N)return l.Pb+=l.N-f,l.N=f,!0;if(f>=l.N+l.Pb){n=l.size-(f-m);n>g&&(n=g);l.Pb=f-l.N+n;f=m+a.u;g-=n;h++;continue}}return qd(a,rd,f,g)}f=new ld(a,f,n,a.u,d,e);md(f,a.H,l);a.g[h++]=f;f=m+a.u;g-=n}return 0>=g?(a.v(137438953472,"Added %dKb %s at %o\n",c>>10,sd[d],b),!0):qd(a,td,b,c)}k.Ld=function(a){return this.C[(a&this.D)>>>this.j].pc(a&this.A,a)};
k.wc=function(a){return this.C[(a&this.D)>>>this.j].oa(a&this.A,a)};k.Md=function(a,b){this.C[(a&this.D)>>>this.j].sc(a&this.A,b,a)};k.Wb=function(a,b){this.C[(a&this.D)>>>this.j].Ab(a&this.A,b,a)};function ud(a,b){return a.g[(b&a.K)>>>a.j]}function ad(a,b){a.I=!1;a.B++;b=ud(a,b).C(b&a.A,b);a.B--;return b}function vd(a,b,c){a.I=!1;a.B++;ud(a,b).u(b&a.A,c&255,b);a.B--}function Zc(a,b,c){a.I=!1;a.B++;ud(a,b).D(b&a.A,c&65535,b);a.B--}
function wd(a){for(var b=xd,c=0,d=0;d<a.g.length;d++){var e=a.g[d];e.type==b&&(c=e.N+e.Pb)}return c}function yd(a,b,c,d,e,f,g,h,l){for(var m=b==c?-1:0;b<=c;b+=2){var n=b&zd;if(void 0!==a.Oa[n])return C(549755813888,"I/O address already registered: "+Ma(b,8,!0)),!1;var p=l||"unknown";p&&0<=m&&(p+=m++);a.Oa[n]=[d,e,f,g,p,h||32,!1]}return!0}
function rc(a,b,c,d){for(var e in c){var f=+e+(d||0),g=c[e];if(!(g[6]&&g[6]>a.i.model)){var h=g[0]?g[0].bind(b):null,l=g[1]?g[1].bind(b):null,m=g[2]?g[2].bind(b):null,n=g[3]?g[3].bind(b):null;65472<=f&&65487>=f&&(!h&&m&&(h=function(w){return function(B){return w(B)&255}.bind(b)}(m)),!l&&n&&(l=function(w){return function(B,z){return w(B,z)}.bind(b)}(n)));for(var p=g[4],q=g[5]||1,r=0;r<q;r++,f+=2)if(p&&1<q&&(p=g[4]+r),!yd(a,f,f,h,l,m,n,g[7]||b.ja,p||b.Sc))return!1}}return!0}
function tc(a,b){a.R.push(b)}function Ad(a,b,c,d){a.I=!0;a.B||(a.H&&a.H.v(9,"memory fault (%d) on %s\n",d,G(a.H,b)),c&&(a.i.S|=c),H(a.i,4,0,b))}function Bd(a){var b=a.I;a.I=!1;return b}function qd(a,b,c,d){a.v(1099511627776,"Memory block error (%d: %#x,%#x)\n",b,c,d);return!1}var gd=8192,zd=gd-1,rd=1,td=2;
function hd(a,b){var c=-1,d=this.controller,e=d.Oa[a],f=b&65535;e?e[0]?c=e[0](f):e[2]&&(c=f&1?e[2](f&-2)>>8:e[2](f)&255):f&1&&(e=d.Oa[a&-2])&&(e[2]?c=e[2](f&-2)>>8:e[0]&&(c=e[0](f)));if(0<=c)return this.i&&this.i.v(32+e[5],"%s.readByte(%s): %s\n",e[4],G(this.i,b),G(this.i,c)),c;Ad(d,b,16,3);c=255;this.i&&this.i.v(32,"warning: unconverted read access to byte @%s: %s\n",G(this.i,b),G(this.i,c));return c}
function id(a,b,c){var d=!1,e=this.controller,f=e.Oa[a],g=c&65535;if(f)if(f[1])f[1](b,g),d=!0;else{if(f[3]){a=f[2]?f[2](g,!0):0;if(g&1)f[3](a&255|b<<8,g&-2);else f[3](a&-256|b,g);d=!0}}else g&1&&(f=e.Oa[a&-2])&&(f[3]?(g&=-2,a=f[2]?f[2](g,!0):0,f[3](a&255|b<<8,g),d=!0):f[1]&&(f[1](b,g),d=!0));d?this.i&&this.i.v(32+f[5],"%s.writeByte(%s,%s)\n",f[4],G(this.i,c),G(this.i,b)):(Ad(e,c,16,5),this.i&&this.i.v(32,"warning: unconverted write access to byte @%s: %s\n",G(this.i,c),G(this.i,b)))}
function jd(a,b){var c=-1,d=this.controller;a=d.Oa[a];var e=b&65535;a&&(a[2]?c=a[2](e):a[0]&&(c=a[0](e)|a[0](e+1)<<8));if(0<=c)return this.i&&this.i.v(32+a[5],"%s.readWord(%s): %s\n",a[4],G(this.i,b),G(this.i,c)),c;Ad(d,b,16,2);c=65535;this.i&&this.i.v(32,"warning: unconverted read access to word @%s: %s\n",G(this.i,b),G(this.i,c));return c}
function kd(a,b,c){var d=!1,e=this.controller;a=e.Oa[a];var f=c&65535;a&&(a[3]?(a[3](b,f),d=!0):a[1]&&(a[1](b&255,f),a[1](b>>8,f+1),d=!0));d?this.i&&this.i.v(32+a[5],"%s.writeWord(%s,%s)\n",a[4],G(this.i,c),G(this.i,b)):(Ad(e,c,16,4),this.i&&this.i.v(32,"warning: unconverted write access to word @%s: %s\n",G(this.i,c),G(this.i,b)))}function J(a){E.call(this,"Device",a,512);this.g={cb:128,Dd:-1}}u(J,E);k=J.prototype;
k.Aa=function(a,b,c,d){this.G=b;this.L=a;this.i=c;this.H=d;var e=this;this.g.Dd=Cd(c,function(){e.g.cb|=128;e.g.cb&64&&Dd(e.i,e.g.Pa);e.L&&Xc(e.L,1);Ed(e.i,e.g.Dd,1E3/60)});this.g.Pa=Fd(c,64,6,8388608);rc(b,this,Gd);tc(b,this.reset.bind(this));d&&Hd(d,128,function(f){var g=e.i;Id(e,"KIPDR",g.D[0],0,f[0]);Id(e,"KDPDR",g.D[0],8,f[0]);Id(e,"KIPAR",g.O[0],0,f[0]);Id(e,"KDPAR",g.O[0],8,f[0],!0);Id(e,"SIPDR",g.D[1],0,f[0]);Id(e,"SDPDR",g.D[1],8,f[0]);Id(e,"SIPAR",g.O[1],0,f[0]);Id(e,"SDPAR",g.O[1],8,f[0],
!0);Id(e,"UIPDR",g.D[3],0,f[0]);Id(e,"UDPDR",g.D[3],8,f[0]);Id(e,"UIPAR",g.O[3],0,f[0]);Id(e,"UDPAR",g.O[3],8,f[0],!0);g.Z&32&&Id(e,"UNIMAP",g.Fa,-1,f[0])});F(this)};function Id(a,b,c,d,e,f){a=a.H;if(!(e&&0>b.indexOf(e.toUpperCase()))){e=0;var g=8,h="",l=!1,m=8;0>d&&(e=22,g=c.length,d=0,l=!0,m=4);for(var n=0;n<g;n++)0==n%m&&(h&&(h+="\n"),h+=b+(l?"["+La(n,2)+"]":"")+":"),h+=" "+G(a,c[d+n],e);a.v("%s",h+(f?"\n":""))}}k.Ca=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};
k.Ba=function(a){return a?this.save():!0};k.reset=function(){this.g.cb=128;Ed(this.i,this.g.Dd,1E3/60,!0)};k.save=function(){var a=new xc(this);a.set(0,[this.g.cb]);return a.data()};k.restore=function(a){a=ba(a[0]);this.g.cb=a.next().value;return!0};k.bg=function(){return this.g.cb};k.th=function(a){this.g.cb=a&192;this.g.cb&64||Jd(this.i,this.g.Pa)};k.dg=function(){return Kd(this.i)};k.vh=function(a){Ld(this.i,a&-129|this.i.U&128)};k.eg=function(){return Md(this.i)};k.fg=function(){return Nd(this.i)};
k.gg=function(){return this.i.Z};k.wh=function(a){Od(this.i,a)};k.Sg=function(a){a=a>>1&63;var b=this.i.Fa[a>>1];return a&1?b>>16:b&65535};k.hi=function(a,b){b=b>>1&63;var c=b>>1;this.i.Fa[c]=b&1?this.i.Fa[c]&65535|(a&63)<<16:this.i.Fa[c]&-65536|a&65534};k.Lg=function(a){return this.i.D[1][a>>1&7]};k.ai=function(a,b){this.i.D[1][b>>1&7]=a&65295};k.Jg=function(a){return this.i.D[1][(a>>1&7)+8]};k.Zh=function(a,b){this.i.D[1][(b>>1&7)+8]=a&65295};k.Kg=function(a){return this.i.O[1][a>>1&7]};
k.$h=function(a,b){b=b>>1&7;this.i.O[1][b]=a;this.i.D[1][b]&=65295};k.Ig=function(a){return this.i.O[1][(a>>1&7)+8]};k.Yh=function(a,b){b=(b>>1&7)+8;this.i.O[1][b]=a;this.i.D[1][b]&=65295};k.ag=function(a){return this.i.D[0][a>>1&7]};k.sh=function(a,b){this.i.D[0][b>>1&7]=a&65295};k.Zf=function(a){return this.i.D[0][(a>>1&7)+8]};k.qh=function(a,b){this.i.D[0][(b>>1&7)+8]=a&65295};k.$f=function(a){return this.i.O[0][a>>1&7]};k.rh=function(a,b){b=b>>1&7;this.i.O[0][b]=a;this.i.D[0][b]&=65295};
k.Yf=function(a){return this.i.O[0][(a>>1&7)+8]};k.ph=function(a,b){b=(b>>1&7)+8;this.i.O[0][b]=a;this.i.D[0][b]&=65295};k.Rg=function(a){return this.i.D[3][a>>1&7]};k.gi=function(a,b){this.i.D[3][b>>1&7]=a&65295};k.Pg=function(a){return this.i.D[3][(a>>1&7)+8]};k.ei=function(a,b){this.i.D[3][(b>>1&7)+8]=a&65295};k.Qg=function(a){return this.i.O[3][a>>1&7]};k.fi=function(a,b){b=b>>1&7;this.i.O[3][b]=a;this.i.D[3][b]&=65295};k.Og=function(a){return this.i.O[3][(a>>1&7)+8]};
k.di=function(a,b){b=(b>>1&7)+8;this.i.O[3][b]=a;this.i.D[3][b]&=65295};k.Nb=function(a){a&=7;return this.i.C&2048?this.i.sa[a]:this.i.j[a]};k.Rb=function(a,b){b&=7;this.i.C&2048?this.i.sa[b]=a:this.i.j[b]=a};k.ng=function(){return this.i.C&49152?this.i.aa[0]:this.i.j[6]};k.Dh=function(a){this.i.C&49152?this.i.aa[0]=a:this.i.j[6]=a};k.qg=function(){return this.i.j[7]};k.Gh=function(a){this.i.j[7]=a};k.Ob=function(a){a&=7;return this.i.C&2048?this.i.j[a]:this.i.sa[a]};
k.Sb=function(a,b){b&=7;this.i.C&2048?this.i.j[b]=a:this.i.sa[b]=a};k.og=function(){return 1==(this.i.C&49152)>>14?this.i.j[6]:this.i.aa[1]};k.Eh=function(a){1==(this.i.C&49152)>>14?this.i.j[6]=a:this.i.aa[1]=a};k.pg=function(){return 3==(this.i.C&49152)>>14?this.i.j[6]:this.i.aa[3]};k.Fh=function(a){3==(this.i.C&49152)>>14?this.i.j[6]=a:this.i.aa[3]=a};k.Wf=function(a){return this.i.rc[a-65504>>1]};k.oh=function(a,b){this.i.rc[b-65504>>1]=a};k.se=function(a){return 65520==a?(wd(this.G)>>6)-1:0};
k.xe=function(){};k.Ng=function(){return 1};k.ci=function(){};k.Vf=function(){return this.i.S};k.nh=function(){this.i.S=0};k.cg=function(){return this.i.nc};k.uh=function(a,b){b&1||(a&=255);this.i.nc=a};k.hg=function(a,b){return b?0:this.i.kb};k.xh=function(a){Pd(this.i,a)};k.Mg=function(a,b){return b?0:this.i.xa&65280};k.bi=function(a){this.i.xa=a|255};k.mg=function(){return Qd(this.i)};k.Ch=function(a){$d(this.i,a)};k.we=function(a,b){this.v(1,"writeIgnored(%o): %o\n",b,a)};
var K={},Gd=(K[61568]=[null,null,J.prototype.Sg,J.prototype.hi,"UNIMAP",64,1170],K[62592]=[null,null,J.prototype.Lg,J.prototype.ai,"SIPDR",8,1145,128],K[62608]=[null,null,J.prototype.Jg,J.prototype.Zh,"SDPDR",8,1145,128],K[62624]=[null,null,J.prototype.Kg,J.prototype.$h,"SIPAR",8,1145,128],K[62640]=[null,null,J.prototype.Ig,J.prototype.Yh,"SDPAR",8,1145,128],K[62656]=[null,null,J.prototype.ag,J.prototype.sh,"KIPDR",8,1140,128],K[62672]=[null,null,J.prototype.Zf,J.prototype.qh,"KDPDR",8,1145,128],
K[62688]=[null,null,J.prototype.$f,J.prototype.rh,"KIPAR",8,1140,128],K[62704]=[null,null,J.prototype.Yf,J.prototype.ph,"KDPAR",8,1145,128],K[62798]=[null,null,J.prototype.gg,J.prototype.wh,"MMR3",1,1145,128],K[65382]=[null,null,J.prototype.bg,J.prototype.th,"LKS"],K[65402]=[null,null,J.prototype.dg,J.prototype.vh,"MMR0",1,1140,128],K[65404]=[null,null,J.prototype.eg,J.prototype.we,"MMR1",1,1145,128],K[65406]=[null,null,J.prototype.fg,J.prototype.we,"MMR2",1,1140,128],K[65408]=[null,null,J.prototype.Rg,
J.prototype.gi,"UIPDR",8,1140,128],K[65424]=[null,null,J.prototype.Pg,J.prototype.ei,"UDPDR",8,1145,128],K[65440]=[null,null,J.prototype.Qg,J.prototype.fi,"UIPAR",8,1140,128],K[65456]=[null,null,J.prototype.Og,J.prototype.di,"UDPAR",8,1145,128],K[65472]=[null,null,J.prototype.Nb,J.prototype.Rb,"R0SET0"],K[65473]=[null,null,J.prototype.Nb,J.prototype.Rb,"R1SET0"],K[65474]=[null,null,J.prototype.Nb,J.prototype.Rb,"R2SET0"],K[65475]=[null,null,J.prototype.Nb,J.prototype.Rb,"R3SET0"],K[65476]=[null,null,
J.prototype.Nb,J.prototype.Rb,"R4SET0"],K[65477]=[null,null,J.prototype.Nb,J.prototype.Rb,"R5SET0"],K[65478]=[null,null,J.prototype.ng,J.prototype.Dh,"R6KERNEL"],K[65479]=[null,null,J.prototype.qg,J.prototype.Gh,"R7KERNEL"],K[65480]=[null,null,J.prototype.Ob,J.prototype.Sb,"R0SET1",1,1145],K[65481]=[null,null,J.prototype.Ob,J.prototype.Sb,"R1SET1",1,1145],K[65482]=[null,null,J.prototype.Ob,J.prototype.Sb,"R2SET1",1,1145],K[65483]=[null,null,J.prototype.Ob,J.prototype.Sb,"R3SET1",1,1145],K[65484]=
[null,null,J.prototype.Ob,J.prototype.Sb,"R4SET1",1,1145],K[65485]=[null,null,J.prototype.Ob,J.prototype.Sb,"R5SET1",1,1145],K[65486]=[null,null,J.prototype.og,J.prototype.Eh,"R6SUPER",1,1145],K[65487]=[null,null,J.prototype.pg,J.prototype.Fh,"R6USER",1,1145],K[65504]=[null,null,J.prototype.Wf,J.prototype.oh,"CTRL",8,1170],K[65520]=[null,null,J.prototype.se,J.prototype.xe,"LSIZE",1,1170],K[65522]=[null,null,J.prototype.se,J.prototype.xe,"HSIZE",1,1170],K[65524]=[null,null,J.prototype.Ng,J.prototype.ci,
"SYSID",1,1170],K[65526]=[null,null,J.prototype.Vf,J.prototype.nh,"ERR",1,1170],K[65528]=[null,null,J.prototype.cg,J.prototype.uh,"MBR",1,1170],K[65530]=[null,null,J.prototype.hg,J.prototype.xh,"PIR"],K[65532]=[null,null,J.prototype.Mg,J.prototype.bi,"SLR"],K[65534]=[null,null,J.prototype.mg,J.prototype.Ch,"PSW"],K);
vb(function(){for(var a=Mb("pdp11","device"),b=0;b<a.length;b++){var c=a[b];var d=Nb(c);switch(d.type){case "default":d=new J(d);Lb(d,c);break;case "pc11":d=new ae(d);Lb(d,c);break;case "rl11":d=new be(d);Lb(d,c);break;case "rk11":d=new L(d);Lb(d,c);break;case "rx11":d=new ce(d),Lb(d,c)}}});
function ld(a,b,c,d,e,f){this.j=a;this.id=de+=2;this.N=b;this.Pb=c;this.size=d||0;this.type=e||ee;this.J=e==fe;this.i=this.controller=null;this.pc=this.B=this.yd;this.oa=this.C=this.zd;this.sc=this.u=this.Qb;this.Ab=this.D=this.Rc;this.G=this.H=0;md(this);this.wb=this.Bf=!1;this.size?f?(this.controller=f,ge(this,f.uf)):(this.L=new ArrayBuffer(this.size),this.A=new DataView(this.L,0,this.size),this.g=new Uint8Array(this.L,0,this.size),this.F=new Uint16Array(this.L,0,this.size>>1),new Int32Array(this.L,
0,this.size>>2),ge(this,he?ie:je)):ge(this)}k=ld.prototype;k.save=function(){var a;if(this.controller)var b=null;else for(b=Array(this.size>>2),a=0;a<b.length;a++)b[a]=this.A.getInt32(a<<2,!0);return b};k.restore=function(a){if(this.controller)return null==a;if(a&&this.size==a.length<<2){var b;for(b=0;b<a.length;b++)this.A.setInt32(b<<2,a[b],!0);return this.wb=!0}return!1};function ge(a,b){b||(b=ke);le(a,b);me(a,b)}
function le(a,b,c){c&&a.G||(a.pc=b[0]||a.yd,a.oa=b[2]||a.zd);if(c||void 0===c)a.B=b[0]||a.yd,a.C=b[2]||a.zd}function me(a,b,c){c&&a.H||(a.sc=!a.J&&b[1]||a.Qb,a.Ab=!a.J&&b[3]||a.Rc);if(c||void 0===c)a.u=b[1]||a.Qb,a.D=b[3]||a.Rc}k.vb=function(a,b){b?0===this.H++&&me(this,ne,!1):0===this.G++&&le(this,ne,!1)};function oe(a,b){b?0===--a.H&&(a.sc=a.J?a.Qb:a.u,a.Ab=a.J?a.Rc:a.D):0===--a.G&&(a.pc=a.B,a.oa=a.C)}function md(a,b,c){a.i=b;a.G=a.H=0;c&&((a.G=c.G)&&le(a,ne,!1),(a.H=c.H)&&me(a,ne,!1))}
k.yd=function(a,b){this.i&&this.i.v(64,"attempt to read invalid address %s\n",G(this.i,b));Ad(this.j,b,32,2);return 255};k.Qb=function(a,b,c){this.i&&this.i.v(64,"attempt to write %s to invalid addresses %s\n",G(this.i,b),G(this.i,c));Ad(this.j,c,32,4)};k.zd=function(a,b){return this.pc(a++,b++)|this.pc(a,b)<<8};k.Rc=function(a,b,c){this.sc(a++,b&255,c++);this.sc(a,b>>8,c)};k.Sf=function(a,b){this.i&&null!=this.N&&pe(this.i,this.N+a);return this.B(a,b)};
k.Ug=function(a,b){this.i&&null!=this.N&&pe(this.i,this.N+a,2);return this.C(a,b)};k.kh=function(a,b,c){this.i&&null!=this.N&&qe(this.i,this.N+a);this.J?this.Qb(a,b,c):this.u(a,b,c)};k.ji=function(a,b,c){this.i&&null!=this.N&&qe(this.i,this.N+a,2);this.J?this.Qb(a,b,c):this.D(a,b,c)};k.Rf=function(a){return this.g[a]};k.Tf=function(a,b){a=this.g[a];this.i&&this.i.v(64,"Memory.readByte(%s): %s\n",G(this.i,b),G(this.i,a));return a};
k.Tg=function(a,b){a&1&&Ad(this.j,b,64,2);return this.A.getUint16(a,!0)};k.Xg=function(a,b){a&1&&Ad(this.j,b,64,2);a=this.F[a>>1];this.i&&this.i.v(64,"Memory.readWord(%s): %s\n",G(this.i,b),G(this.i,a));return a};k.jh=function(a,b){this.g[a]=b;this.wb=!0};k.lh=function(a,b,c){this.g[a]=b;this.wb=!0;this.i&&this.i.v(64,"Memory.writeByte(%s,%s)\n",G(this.i,c),G(this.i,b))};k.ii=function(a,b,c){a&1&&Ad(this.j,c,64,4);this.A.setUint16(a,b,!0);this.wb=!0};
k.ki=function(a,b,c){a&1&&Ad(this.j,c,64,4);this.F[a>>1]=b;this.wb=!0;this.i&&this.i.v(64,"Memory.writeWord(%s,%s)\n",G(this.i,c),G(this.i,b))};var ee=0,xd=1,fe=2,od=4,sd=["NONE","RAM","ROM","VID","H/W"],de=0,ke=[],ne=[ld.prototype.Sf,ld.prototype.kh,ld.prototype.Ug,ld.prototype.ji],je=[ld.prototype.Rf,ld.prototype.jh,ld.prototype.Tg,ld.prototype.ii],ie=[ld.prototype.Tf,ld.prototype.lh,ld.prototype.Xg,ld.prototype.ki],he,re=new ArrayBuffer(2);(new DataView(re)).setUint16(0,256,!0);he=256===(new Uint16Array(re))[0];
function se(a,b){E.call(this,"CPU",a,2);b=+a.cycles||b;var c=+a.multiplier||1;this.ed=0;this.Tc=b;this.ib=c;this.gd=Math.round(this.Tc/1E4)/100;this.rb=this.gd*this.ib;this.hd=this.jc=this.mb=this.Uc=0;this.flags.X=this.flags.Mc=!1;this.flags.qa=a.autoStart;"string"==typeof this.flags.qa&&(this.flags.qa="true"==this.flags.qa);this.flags.Hb=!1;this.hc=this.Gb=0;this.ic=+a.csStart;this.Fb=+a.csInterval;this.Ib=+a.csStop;this.ha=[];this.Vd=this.bh.bind(this);this.jb=this.Ia=this.hb=this.g=this.ka=this.Ha=
this.fc=this.gb=this.Kb=this.jd=this.qb=0;this.ra=null;F(this)}u(se,E);k=se.prototype;k.Aa=function(a,b,c,d){this.L=a;this.G=b;this.H=d;this.ra=a.u;for(a=0;a<te.length;a++)(b=this.J[te[a]])&&this.L.ua("",te[a],b);F(this)};k.reset=function(){};k.save=function(){return null};k.restore=function(){return!1};
k.Ca=function(a,b){var c=ue(this.L,"autoStart");null!=c?this.flags.qa="true"==c?!0:"false"==c?!1:!!c:null==this.flags.qa&&(this.flags.qa=!this.H&&void 0===this.J.run);if(!b){if(a){ve(this);if(!this.restore(a))return!1;we(this)}else this.reset();this.H?(a=this.H,b=this.flags.qa,a.Ga=!0,a.v("Type ? for help with PDPjs Debugger commands\n"),xe(a),b||ye(a),a.xa&&(b=a.xa,a.xa=null,ze(a,b))):this.v(137438953472,"No debugger detected\n");this.flags.qa||this.v("CPU will not be auto-started %s\n",this.ra?
"(click Run to start)":"(type 'go' to start)")}return!0};k.Ba=function(a){return a?this.save():!0};k.qa=function(){return this.flags.X?!0:this.flags.qa?Hc(this):!1};k.le=function(){return 0};function we(a){void 0===a.ic&&(a.ic=0);void 0===a.Fb&&(a.Fb=-1);void 0===a.Ib&&(a.Ib=-1);a.flags.Hb=0<=a.ic&&0<a.Fb;a.flags.Hb&&(a.hc=0,a.Gb=a.ic-a.jb)}
function Wc(a,b){if(a.flags.Hb){var c=!1;a.hc=a.hc+a.le()|0;a.Gb-=b;0>=a.Gb&&(a.Gb+=a.Fb,c=!0);0<=a.Ib&&a.Ib<=Ae(a)&&(a.Fb=a.Ib=-1,we(a),Ic(a),c=!0);c&&a.v("%d cycles: checksum=%x\n",Ae(a),a.hc)}}
k.ua=function(a,b,c){var d=this;switch(b){case "power":case "reset":return this.J[b]=c,!0;case "run":return this.J[b]=c,c.onclick=function(){var e;if(e=d.L)if(e=d.L,e.flags.da)e=!0;else{var f=null,g,h=Ob(e.id);for(g=0;g<h.length&&(f=h[g],f===e||f.flags.ready);g++);if(g==h.length)for(g=0;g<h.length&&(f=h[g],f===e||f.flags.da);g++);g==h.length&&(f=e);bb("The "+f.type+" component ("+f.id+") is not "+(f.flags.ready?"powered yet":"ready yet"+(f.Hc?" (waiting for notification)":""))+".");e=!1}e&&(d.flags.X?
Ic(d):Hc(d))},!0;case "speed":return this.J[b]=c,!0;case "setSpeed":return this.J[b]=c,c.onclick=function(){Be(d,d.ib<<1,!0)},c.textContent=this.rb.toFixed(2)+"Mhz",!0}return!1};function Lc(a,b,c){a.jb+=b;c&&(a.hb=a.g=a.ka=0)}function Ce(a,b){var c=1;b&&1<a.ib&&a.qb&&(c=a.qb/a.gd);a.hd=Math.round(1E3/De);a.jc=Math.floor(a.Tc/De*c);b||(a.mb=a.jc);a.Uc=0}function Ae(a){return a.jb+a.Ia+a.hb-a.g}function ve(a){a.qb=0;a.jd=0;a.jb=a.Ia=a.hb=a.g=a.ka=0;we(a);Be(a,1)}
function Be(a,b,c){var d=!1;if(void 0!==b){.8>a.qb/a.rb?b=1:d=!0;a.ib=b;b=a.gd*a.ib;if(a.rb!=b){a.rb=b;b=a.rb.toFixed(2)+"Mhz";var e=a.J.setSpeed;e&&(e.textContent=b);a.v("target speed: %s\n",b)}c&&a.L&&Ee(a.L)}Lc(a,a.Ia);a.Ia=0;a.Ha=Jb();a.gb=0;Ce(a);return d}function Cd(a,b){var c=a.ha.length;a.ha.push([-1,b]);return c}function Ed(a,b,c,d){0<=b&&b<a.ha.length&&(d||0>a.ha[b][0])&&(c=a.Tc*a.ib/1E3*c|0,a.flags.X&&(c+=Fe(a)),a.ha[b][0]=c)}
function Ge(a,b){for(var c=a.ha.length-1;0<=c;c--){var d=a.ha[c];0>d[0]||b>d[0]&&(b=d[0])}return b}function Kc(a,b){for(var c=a.ha.length-1;0<=c;c--){var d=a.ha[c];0>d[0]||(d[0]-=b,0>=d[0]&&(d[0]=-1,d[1]()))}}function Fe(a,b){var c=a.hb-=a.g;a.g=a.ka=0;b&&(a.hb=0);return c}
k.bh=function(){if(this.flags.X){this.Uc>=this.Tc&&Ce(this,!0);this.Kb=0;this.fc=Jb();if(this.gb){var a=this.fc-this.gb;a>this.hd&&(this.Ha+=a,this.Ha>this.fc&&(this.Ha=this.fc))}try{do{var b=Ge(this,this.flags.Hb?1:this.jc);try{this.xc(b)}catch(e){if("number"!=typeof e)throw e;}b=Fe(this,!0);this.Kb+=b;this.Ia+=b;Wc(this,b);Kc(this,b);this.mb-=b;if(0>=this.mb){this.mb+=this.jc;++this.jd>=He&&(this.L&&Xc(this.L),this.jd=0);break}}while(this.flags.X)}catch(e){Ic(this);this.L&&this.L.stop(Jb(),Ae(this));
Vb(this,e.stack||e.message);return}if(this.flags.X){a=setTimeout;b=this.Vd;this.gb=Jb();var c=this.hd;this.Kb&&(c=Math.round(c*this.Kb/this.jc));c-=this.gb-this.fc;var d=this.gb-this.Ha;d&&(this.qb=Math.round(this.Ia/(10*d))/100,864E5<=d&&(this.jb=0,Be(this)));if(0>c||this.qb<this.rb)-1E3>c&&(this.Ha-=c),c=0;this.Uc+=this.Kb;this.gb+=c;a(b,c)}}};
function Hc(a,b){if(Wb(a))return!1;if(a.flags.X)return a.v("%s busy\n",a.toString()),!1;Be(a);a.flags.X=!0;a.flags.Mc=!0;var c=a.J.run;c&&(c.textContent="Halt");a.L&&(b&&Ee(a.L,!0),a.L.start(a.Ha,Ae(a)));a.H||a.v(137438953472,"Started\n");setTimeout(a.Vd,0);return!0}k.xc=function(){return 0};function Ic(a,b){var c=!1;if(a.flags.X){Fe(a);Lc(a,a.Ia);a.Ia=0;a.flags.X=!1;if(c=a.J.run)c.textContent="Run";a.L&&a.L.stop(Jb(),Ae(a));c=!0;a.H||a.v(137438953472,"Stopped\n")}a.flags.complete=b;return c}
var De=30,He=15,te=["power","reset"];
function Ie(a){var b=+a.model||1170;se.call(this,a,6666667);this.model=b;this.Oc=+a.addrReset||0;this.Ja=this.C=this.P=this.F=this.I=this.M=this.K=0;this.j=this.sa=this.aa=[];this.O=this.D=this.Fa=this.rc=[];this.Na=this.R=this.Pd=this.sb=this.tb=this.ub=this.Ra=this.S=this.nc=this.kb=this.xa=this.U=this.oc=this.qc=this.Z=this.u=0;this.Sd=[4,2,0,1];this.tc=0;this.Td=255;1120>=this.model?(this.Wd=Je.bind(this),this.Eb=this.yf,this.tc=8,this.Td=-1,this.be=255,this.Zd=0):(this.Wd=Ke.bind(this),this.Eb=
this.zf,this.be=~(1792|(1140>=this.model?2048:0))&65535,this.Zd=1140<this.model?2048:0);this.vc=this.uc=this.pa=0;this.T=null;this.ec=[];this.bc=this.Wc=this.ke;this.cc=this.Xc=this.oe;this.Nc=this.Zc=this.ue;this.dc=this.$c=this.ve;this.Ga=this.pb=this.kc=this.lc=0;this.wa=this.ne;this.oa=this.Ad;this.Ab=this.Fd;this.B=this.A=this.Pc=this.W=this.ba=0;this.flags.complete=!1}u(Ie,se);k=Ie.prototype;
k.Aa=function(a,b,c,d){se.prototype.Aa.call(this,a,b,c,d);this.Wc=b.Ld.bind(b);this.Xc=b.wc.bind(b);this.Zc=b.Md.bind(b);this.$c=b.Wb.bind(b)};k.Ca=function(a,b){for(var c=192,d=0;d<this.ec.length;d++){var e=this.ec[d];0>e.zb&&(e.zb=c,c+=4)}return se.prototype.Ca.call(this,a,b)};
k.reset=function(){this.v(137438953472,"Model %d\n",this.model);this.flags.X&&Ic(this);this.F=65536;this.I=32768;this.M=65535;this.K=32768;this.C=15;this.j=[0,0,0,0,0,0,0,this.Oc,-1,-2,-3,-4,-5,-6,-7,-8];this.sa=[0,0,0,0,0,0];this.aa=[0,0,0,0];this.O=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];this.D=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[65535,65535,65535,65535,65535,65535,
65535,65535,65535,65535,65535,65535,65535,65535,65535,65535],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];this.Fa=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.rc=[0,0,0,0,0,0,0,0];this.P=0;this.Ja=-1;this.B=this.A=this.Pc=this.W=this.ba=this.u=this.nc=0;Fc(this);ve(this);this.flags.error=!1;se.prototype.reset.call(this)};function Fc(a){a.U=0;a.oc=0;a.qc=0;a.Z=0;a.S=0;a.kb=0;a.xa=255;a.sb=0;a.tb=0;a.ub=0;a.Ra=262143;a.Na=a.j[7];a.R=0;a.T=null;a.G&&(Le(a),a.Pd=wd(a.G))}
function Le(a){a.bc=a.Wc;a.cc=a.Xc;a.Nc=a.Zc;a.dc=a.$c;a.kc&&(a.bc=a.ke,a.cc=a.oe);a.lc&&(a.Nc=a.ue,a.dc=a.ve);a.sb?(a.Ga=65536,a.pb=a.Z&16?4186112:253952,a.wa=a.ne,a.oa=a.kc?a.Wg:a.Ad,a.Ab=a.lc?a.mi:a.Fd,pd(a.G,a.Z&16?22:18)):(a.Ga=0,a.pb=57344,a.wa=a.Cf,a.oa=a.kc?a.Vg:a.te,a.Ab=a.lc?a.li:a.ye,pd(a.G,16))}function Kd(a){var b=a.U;b&57344||(b=b&-3199|a.tb<<5|a.ub<<1);return b}
function Ld(a,b){b&=-3073;if(a.U!=b){b&57344&&!(a.U&57344)&&(a.oc=a.R>>16&65535,a.qc=a.R&65535);a.U=b;a.tb=(b&96)>>5;a.ub=(b&30)>>1;var c=0;b&257&&(c=4,b&1&&(c|=2));a.sb!=c&&(a.sb=c,Le(a))}}function Md(a){a.U&57344||(a.oc=a.R>>16&65535);a=a.oc;a&65280&&(a=(a<<8|a>>8)&65535);return a}function Nd(a){a.U&57344||(a.qc=a.R&65535);return a.qc}function Od(a,b){1170>a.model&&(b&=-49);a.Z!=b&&(a.Z=b,a.Ra=b&16?4194303:262143,Le(a))}
function Me(a,b,c,d){a.Oc=b;Ec(a,b);$d(a,0);a.G.reset();Fc(a);if(c){a.j[0]=d||0;for(b=1;5>=b;b++)a.j[b]=0;a.j[6]=1024;a.flags.da?a.flags.X||Hc(a):a.flags.qa=!0}else a.H&&a.flags.da?Ic(a)||a.L.flags.reset||(xe(a.H),Xc(a.L,-1)):!1===c&&Ic(a);!a.flags.X&&a.ra&&a.ra.stop()}k.le=function(){return 0};
k.save=function(){var a=new xc(this);a.set(0,[this.j,this.sa,this.aa,this.O,this.D,this.Fa,this.rc,this.S,this.nc,this.kb,this.xa,this.tb,this.ub,this.Na,this.u,this.R,this.Ja,this.uc,this.vc,this.Oc]);a.set(1,[Qd(this),Kd(this),Md(this),Nd(this),this.Z]);a.set(2,[this.jb,this.ib,this.flags.qa]);for(var b=a.set,c=[],d=this.T;d;)c.push(d.zb),d=d.next;b.call(a,3,c);b=a.set;c=[];for(d=0;d<this.ha.length;d++)c.push(this.ha[d][0]);b.call(a,4,c);return a.data()};
k.restore=function(a){var b=ba(a[0]);this.j=b.next().value;this.sa=b.next().value;this.aa=b.next().value;this.O=b.next().value;this.D=b.next().value;this.Fa=b.next().value;this.rc=b.next().value;this.S=b.next().value;this.nc=b.next().value;this.kb=b.next().value;this.xa=b.next().value;this.tb=b.next().value;this.ub=b.next().value;this.Na=b.next().value;this.u=b.next().value;this.R=b.next().value;this.Ja=b.next().value;this.uc=b.next().value;this.vc=b.next().value;this.Oc=b.next().value;b=a[1];$d(this,
b[0]);Ld(this,b[1]);this.oc=b[2];this.qc=b[3];Od(this,b[4]);b=a[2];this.jb=b[0];Be(this,b[1]);this.flags.qa=b[2];b=a[3];for(var c=b.length-1;0<=c;c--){var d;a:{for(d=0;d<this.ec.length;d++){var e=this.ec[d];if(e.zb===b[c]){d=e;break a}}d=null}d&&(d.next=this.T,this.T=d)}a=a[4];for(b=0;b<this.ha.length&&b<a.length;b++)this.ha[b][0]=a[b];return!0};function Ne(a){return a.F&65536?1:0}function Oe(a){return a.I&32768?2:0}function Pe(a){return a.M&65535?0:4}function Qe(a){return a.K&32768?8:0}
function Re(a,b){var c=a.j[7];a.j[7]=c+b&65535;return c}function Se(a,b,c){c&&(Ec(a,a.j[7]+(b<<24>>23)),a.g-=2);a.g-=3}function Ec(a,b){a.j[7]=b&65535}function Fd(a,b,c,d){b={zb:b,priority:c,message:d||0,name:jc[b],next:null};a.ec.push(b);return b}function Te(a,b){var c=a.T;if(c==b)a.T=b.next;else for(;c;){var d=c.next;if(d==b){c.next=d.next;break}c=d}a.T&&(a.u|=1)}
function Dd(a,b){if(b){if(b!=a.T){var c=a.T;if(!c||c.priority<=b.priority)b.next=c,a.T=b;else{do{var d=c.next;if(!d||d.priority<=b.priority){b.next=d;c.next=b;break}c=d}while(c)}}a.u|=1;a.v(b.message+17,"setIRQ(vector=%o,priority=%d)\n",b.zb,b.priority)}}function Jd(a,b){b&&(Te(a,b),a.v(b.message+17,"clearIRQ(vector=%o,priority=%d)\n",b.zb,b.priority))}function Ue(a){return a.u&64?(H(a,168,64,-6),!0):a.u&32?(H(a,4,32,-5),!0):a.u&16?(H(a,12,16,-7),!0):!1}
function Qd(a){return a.C=a.C&63728|Qe(a)|Pe(a)|Oe(a)|Ne(a)}function $d(a,b){b&=a.be;a.K=b<<12;a.M=~b&4;a.I=b<<14;a.F=b<<16;if((b^a.C)&a.Zd)for(var c=a.sa.length;0<=--c;){var d=a.j[c];a.j[c]=a.sa[c];a.sa[c]=d}a.P=b>>14&3;c=a.C>>14&3;a.P!=c&&(a.aa[c]=a.j[6],a.j[6]=a.aa[a.P]);a.C=b;a.u&=-3;a.u|=a.T?2:1}function Pd(a,b){if(b&=65024){var c=b>>9;do b+=34;while(c>>=1);a.u|=1}a.kb=b}k.Da=function(a){this.K=this.M=a;this.I=0};k.lb=function(a,b){this.K=this.M=this.F=a;this.I=b||0};
function Ve(a,b){a.K=a.M=a.F=b;a.I=a.K^a.F>>1}function We(a,b,c,d){a.K=a.M=a.F=b;a.I=(c^d)&(d^b)}function H(a,b,c,d){if(!a.pa){0>a.Ja?a.Ja=Qd(a):a.P||(d=-4);-4==d&&(a.u&256&&(d=-1),a.u|=256,a.S|=4,a.j[6]=b=4);if(-1!=d){a.R=b|4143316992;a.P=0;var e=a.oa(b|a.Ga),f=a.oa(b+2&65535|a.Ga);$d(a,f&-12289|a.Ja>>2&12288);Xe(a,a.Ja);Xe(a,a.j[7]);Ec(a,e)}a.g-=5;a.u&=~(c|19);a.u|=129;a.Ja=-1;a.uc=d;a.vc=b;-1==d&&Ic(a);if(-4<=d)throw b;}}
function Ye(a){var b=Ze(a),c=Ze(a);a.C&49152&&(c=c&-225|a.C&63712);Ec(a,b);$d(a,c);a.u&=-17}function $e(a,b){var c=b>>13&31;31>c&&(b=a.Z&32?a.Fa[c]+(b&8191)&4194303:b&-3932161);return b}
function af(a,b,c){var d=[];if(c){c=$e(a,b);var e=b>>13&31;d.push(c);d.push(e);a.Z&32&&(d.push(a.Fa[e]),d.push(b&8191))}else if(a.sb){e=a.P<<1;var f=b>>13;7<f&&(e|=1);a.Z&a.Sd[a.P]||(f&=7);b&=8191;var g=a.O[a.P][f]<<6;c=g+b&a.Ra;3932160<=c&&(c=$e(a,c));d.push(c);d.push(b);d.push(e);d.push(f&7);d.push(g);d.push(a.Ra)}else c=b&65535,57344<=c&&(c|=a.pb),d.push(c);return d}
function $c(a,b,c){if(!(c&a.sb)){var d=b&65535;57344<=d&&(d|=a.pb);return d}var e=b>>13;a.Z&a.Sd[a.P]||(e&=7);var f=a.D[a.P][e];d=(a.O[a.P][e]<<6)+(b&8191)&a.Ra;3932160<=d&&(d=$e(a,d));if(a.pa)return d;d>=a.Pd&&d<a.pb?(a.S|=32,H(a,4,0,d)):d&1&&!(c&1)&&(a.S|=64,H(a,4,0,d));var g=0;switch(f&7){case 1:g=4096;case 2:f|=128;c&4&&(g=8192);break;case 4:g=4096;case 5:c&4&&(g=4096);case 6:f|=c&4?192:128;break;default:g=32768}32512!=(f&32520)&&(f&8?f&32512&&(b&8128)<(f>>2&8128)&&(g|=16384):(b&8128)>(f>>2&8128)&&
(g|=16384));a.D[a.P][e]=f;if(d!=(4194170&a.Ra)||a.P)a.tb=a.P,a.ub=e;g&&(g&57344&&(0<=a.Ja&&(g|=128),a.U&57344||(g|=a.U&4096|a.tb<<5|a.ub<<1,Ld(a,a.U&-61695|g&61694)),H(a,168,64,-2)),a.U&61440||!(d<(4191360&a.Ra)||d>(4194239&a.Ra))||(a.U|=4096,a.U&512&&(a.u|=64)));return d}function Ze(a){var b=a.oa(a.j[6]|a.Ga);a.j[6]=a.j[6]+2&65535;return b}function Xe(a,b){var c=a.j[6]-2&65535;a.j[6]=c;a.R=a.R&65535|(a.R&-65536)<<8|16121856;a.u&256||a.Eb(4,-2,c);a.Ab(c,b)}
function bf(a,b,c,d){var e=d&8?0:a.Ga;switch(b){case 0:return H(a,4,0,-3),0;case 1:return 6==c&&a.Eb(d,0,a.j[6]),a.g-=3,7==c?a.j[c]:a.j[c]|e;case 2:var f=2;var g=a.j[c];6==c&&a.Eb(d,f,g);7!=c&&(g|=e,6>c&&d&1&&(f=1));a.g-=3;break;case 3:f=2;g=a.j[c];7!=c&&(g|=e);g=a.oa(g);g|=e;a.g-=7;break;case 4:f=-2;6>c&&d&1&&(f=-1);g=a.j[c]+f&65535;6==c&&a.Eb(d,f,g);7!=c&&(g|=e);a.g-=4;break;case 5:f=-2;g=a.j[c]-2&65535;7!=c&&(g|=e);g=a.oa(g)|e;a.g-=8;break;case 6:return g=a.oa(Re(a,2)),g=g+a.j[c]&65535,6==c&&a.Eb(d,
0,g),a.g-=6,g|e;case 7:return g=a.oa(Re(a,2)),g=g+a.j[c]&65535,g=a.oa(g|a.Ga),a.g-=10,g|e}a.j[c]=a.j[c]+f&65535;a.R=a.R&65535|(a.R&-65536)<<8|(f<<3&248|c)<<16;return g}k.yf=function(a,b,c){!this.P&&0>=b&&c<=this.xa&&(this.u|=32)};k.zf=function(a,b,c){this.P||(65534<=c&&(c|=-65536),a&4&&c<=this.xa&&(c<=this.xa-32?H(this,4,0,-4):(this.S|=8,this.u|=32)))};k.ke=function(a){this.H&&pe(this.H,a,1);return this.Wc(a)};k.oe=function(a){this.H&&pe(this.H,a,2);return this.Xc(a)};
k.ue=function(a,b){this.H&&qe(this.H,a,1);this.Zc(a,b)};k.ve=function(a,b){this.H&&qe(this.H,a,2);this.$c(a,b)};function bd(a,b){a.pa++;b=a.G.wc($c(a,b,2));a.pa--;return b}function cf(a,b){(b?--a.lc:--a.kc)||Le(a)}k.Cf=function(a,b,c){return bf(this,a,b,c)};k.ne=function(a,b,c){return $c(this,bf(this,a,b,c),c)};k.te=function(a){return this.G.wc(this.Na=a)};k.Vg=function(a){this.H&&pe(this.H,a,2);return this.te(a)};k.Ad=function(a){return this.G.wc(this.Na=$c(this,a,2))};
k.Wg=function(a){this.H&&pe(this.H,a,2);return this.Ad(a)};k.ye=function(a,b){this.G.Wb(this.Na=a,b)};k.li=function(a,b){this.H&&qe(this.H,a,2);this.ye(a,b)};k.Fd=function(a,b){this.G.Wb(this.Na=$c(this,a,4),b)};k.mi=function(a,b){this.H&&qe(this.H,a,2);this.Fd(a,b)};function df(a,b,c){var d=a.A=b&7;(b=a.B=(b&56)>>3)?(d=bf(a,b,d,2),c&65536||61440!==(a.C&61440)&&(d&=65535),a.P=a.C>>12&3,c=a.oa(d|c&a.Ga),a.P=a.C>>14&3):c=6!=d||(a.C>>2&12288)===(a.C&12288)?a.j[d]:a.aa[a.C>>12&3];return c}
function ef(a,b,c,d){a.R=a.R&65535|1441792;var e=a.A=b&7;(b=a.B=(b&56)>>3)?(e=bf(a,b,e,4),c&65536||(e&=65535),a.P=a.C>>12&3,e=$c(a,e|c&65536,4),a.P=a.C>>14&3,a.dc(e,d)):6!=e||(a.C>>2&12288)===(a.C&12288)?a.j[e]=d:a.aa[a.C>>12&3]=d}function ff(a,b){b>>=6;var c=a.ba=b&7;return(b=a.W=(b&56)>>3)?a.bc(a.wa(b,c,3)):a.j[c+a.tc]&a.Td}function gf(a,b){var c;b>>=6;var d=a.ba=b&7;(b=a.W=(b&56)>>3)?c=a.cc(a.wa(b,d,2)):c=a.j[d+a.tc];return c}function zf(a,b){var c=a.A=b&7;b=a.B=(b&56)>>3;return bf(a,b,c,8)}
function Af(a,b){var c=a.A=b&7;return(b=a.B=(b&56)>>3)?a.bc(a.wa(b,c,3)):a.j[c]&255}function Bf(a,b){var c,d=a.A=b&7;(b=a.B=(b&56)>>3)?c=a.cc(a.wa(b,d,2)):c=a.j[d];return c}function Cf(a,b,c,d){var e=a.A=b&7;(b=a.B=(b&56)>>3)?(e=a.Pc=a.wa(b,e,7),c=0>c?a.j[-c-1]&255:c,a.Nc(e,d.call(a,c,a.bc(e))),e&1&&a.g--):(b=a.j[e],c=0>c?a.j[-c-1]&255:c,a.j[e]=b&65280|d.call(a,c,b&255))}
function N(a,b,c,d){var e=a.A=b&7;(b=a.B=(b&56)>>3)?(e=a.wa(b,e,6),a.dc(e,d.call(a,0>c?a.j[-c-1]:c,a.cc(e)))):a.j[e]=d.call(a,0>c?a.j[-c-1]:c,a.j[e])}function Df(a,b,c,d,e){var f=a.A=b&7;(b=a.B=(b&56)>>3)?(d=a.wa(b,f,5),e.call(a,(c=0>c?a.j[-c-1]&255:c)<<8),a.Nc(d,c),d&1&&a.g--):(c?(c=0>c?a.j[-c-1]&255:c,a.j[f]=a.j[f]&~d|c<<24>>24&d):a.j[f]&=~d,e.call(a,c<<8))}
function Ef(a,b,c,d){var e=a.A=b&7;(b=a.B=(b&56)>>3)?(e=a.wa(b,e,4),d.call(a,c=0>c?a.j[-c-1]:c),a.dc(e,c)):(a.j[e]=c=0>c?a.j[-c-1]:c,d.call(a,c))}
k.xc=function(a){this.flags.complete=!0;var b=this.H?Ff(this.H)?1:this.flags.Mc?-1:0:0,c=a?this.flags.Mc?0:1:-1;this.flags.Mc=!1;this.hb=this.g=a;this.u=this.u&-5|(b?4:0);do{if(this.u){if(this.u&4){if(Gf(this.H,this.j[7],c)){Ic(this);break}++b||(this.u&=-5);c||c++}if(a=this.u&11)if(a=!1,this.u&2){var d=160,e=(this.kb&224)>>5,f=this.T&&this.T.priority>e?this.T:null;f&&(d=f.zb,e=f.priority);e>(this.C&224)>>5?(this.u&8&&(Re(this,2),this.u&=-9),H(this,d,0,-10),e=!0):e=!1;e&&(f&&Te(this,f),a=!0);this.T||
this.kb||(this.u&=-3)}else this.u&1&&this.u++;if(a){if(this.u&4&&Gf(this.H,this.j[7],c)){Ic(this);break}if(0>c)break}if(this.u&112&&Ue(this)){if(this.u&4&&Gf(this.H,this.j[7],c)){Ic(this);break}if(0>c)break}}this.u=this.u&15|this.C&16;a=this.R=this.j[7];f=this.oa(a);this.j[7]=a+2&65535;this.Wd(f)}while(0<this.g);return this.flags.complete?this.hb-this.g:!1===this.flags.complete?-1:0};vb(function(){for(var a=Mb("pdp11","cpu"),b=0;b<a.length;b++){var c=a[b],d=Nb(c);d=new Ie(d);Lb(d,c)}});
function Hf(a,b){var c=b+a;this.K=this.M=this.F=c;this.I=(a^c)&(b^c);return c&65535}function If(a,b){var c=b+a,d=c<<8;this.K=this.M=this.F=d;this.I=(a<<8^d)&(b<<8^d);return c&255}function Jf(a,b){a=b<<1;Ve(this,a);return a&65535}function Kf(a,b){a=b<<1;Ve(this,a<<8);return a&255}function Lf(a,b){a=b&32768|b>>1|b<<16;Ve(this,a);return a&65535}function Mf(a,b){a=b&128|b>>1|b<<8;Ve(this,a<<8);return a&255}function Nf(a,b){a=b&~a;this.Da(a);return a}function Of(a,b){a=b&~a;this.Da(a<<8);return a}
function Pf(a,b){a|=b;this.Da(a);return a}function Qf(a,b){a|=b;this.Da(a<<8);return a}function Rf(a,b){a=~b|65536;this.lb(a);return a&65535}function Sf(a,b){a=~b|256;this.lb(a<<8);return a&255}function Tf(a,b){this.K=this.M=a=b-a;this.I=b&(b^a);return a&65535}function Uf(a,b){a=b-a;var c=a<<8;b<<=8;this.K=this.M=c;this.I=b&(b^c);return a&255}function Vf(a,b){this.K=this.M=a=b+a;this.I=a&(b^a);return a&65535}function Wf(a,b){a=b+a;var c=a<<8;this.K=this.M=c;this.I=c&(b<<8^c);return a&255}
function Xf(a,b){a=-b;this.lb(a,a&b&32768);return a&65535}function Yf(a,b){a=-b;this.lb(a<<8,(a&b&128)<<8);return a&255}function Zf(a,b){a=b<<1|this.F>>16&1;Ve(this,a);return a&65535}function $f(a,b){a=b<<1|this.F>>16&1;Ve(this,a<<8);return a&255}function ag(a,b){a=(this.F&65536|b)>>1|b<<16;Ve(this,a);return a&65535}function bg(a,b){a=((this.F&65536)>>8|b)>>1|b<<8;Ve(this,a<<8);return a&255}function cg(a,b){var c=b-a;We(this,c,a,b);return c&65535}
function dg(a,b){var c=b-a;We(this,c<<8,a<<8,b<<8);return c&255}function eg(a,b){this.K=this.M=b&65280;this.I=this.F=0;return(b<<8|b>>8)&65535}function fg(a,b){a^=b;this.Da(a);return a&65535}function gg(a){N(this,a,gf(this,a),Hf);this.g-=this.B?9+(this.ba&&6<=this.A?1:0):(this.W?5:3)+(7==this.A?2:0)}
function hg(a){var b=Bf(this,a);a=a>>6&7;var c=this.j[a];c&32768&&(c|=4294901760);this.F=this.I=0;b&=63;if(b&32)b=64-b,16<b&&(b=16),this.F=c<<17-b,c>>=b;else if(b)if(16<b)this.I=c,c=0;else{this.F=c<<=b;var d=c>>15&65535;d&&65535!==d&&(this.I=32768)}this.j[a]=c&65535;this.K=this.M=c;this.g-=(this.B?6:7)+b}
function ig(a){var b=Bf(this,a);a=a>>6&7;var c=this.j[a]<<16|this.j[a|1];this.F=this.I=0;b&=63;if(b&32){b=64-b;32<b&&(b=32);var d=c>>b-1;this.F=d<<16;d>>=1;c&2147483648&&(d|=4294967295<<32-b)}else b?(d=c<<b-1,this.F=d>>15,d<<=1,32<b&&(b=32),(c>>=32-b)&&4294967295!==(c|4294967295<<b&4294967295)&&(this.I=32768)):d=c;this.j[a]=d>>16&65535;this.j[a|1]=d&65535;this.K=d>>16;this.M=d>>16|d;this.g-=(this.B?6:7)+b}function jg(a){Se(this,a,!Ne(this))}function kg(a){Se(this,a,Ne(this))}
function lg(a){N(this,a,gf(this,a),Nf);this.g-=this.B?9+(this.ba&&6<=this.A?1:0):(this.W?5:3)+(7==this.A?2:0)}function mg(a){Cf(this,a,ff(this,a),Of);this.g-=this.B?9+(this.ba&&6<=this.A?1:0):(this.W?5:3)+(7==this.A?2:0)}function ng(a){N(this,a,gf(this,a),Pf);this.g-=this.B?9+(this.ba&&6<=this.A?1:0):(this.W?5:3)+(7==this.A?2:0)}function og(a){Cf(this,a,ff(this,a),Qf);this.g-=this.B?9+(this.ba&&6<=this.A?1:0):(this.W?5:3)+(7==this.A?2:0)}
function pg(a){var b=gf(this,a);a=Bf(this,a);this.Da((0>b?this.j[-b-1]:b)&a);this.g-=this.B?4+(this.ba&&6<=this.A?1:0):(this.W?4:3)+(7==this.A?2:0)}function qg(a){var b=ff(this,a);a=Af(this,a);this.Da(((0>b?this.j[-b-1]&255:b)&a)<<8);this.g-=this.B?4+(this.ba&&6<=this.A?1:0):(this.W?4:3)+(7==this.A?2:0)}function rg(a){Se(this,a,Pe(this))}function sg(a){Se(this,a,!Qe(this)==!Oe(this))}function tg(a){Se(this,a,!Pe(this)&&!Qe(this)==!Oe(this))}function ug(a){Se(this,a,!Ne(this)&&!Pe(this))}
function vg(a){Se(this,a,Pe(this)||!Qe(this)!=!Oe(this))}function wg(a){Se(this,a,Ne(this)||Pe(this))}function xg(a){Se(this,a,!Qe(this)!=!Oe(this))}function yg(a){Se(this,a,Qe(this))}function zg(a){Se(this,a,!Pe(this))}function Ag(a){Se(this,a,!Qe(this))}function Bg(){H(this,12,0,-9)}function Cg(a){Se(this,a,!0)}function Dg(a){Se(this,a,!Oe(this))}function Eg(a){Se(this,a,Oe(this))}function Fg(a){a&1&&(this.F=0);a&2&&(this.I=0);a&4&&(this.M=1);a&8&&(this.K=0);this.g-=5}
function Gg(a){var b=gf(this,a);a=Bf(this,a);var c=(b=0>b?this.j[-b-1]:b)-a;We(this,c,a,b);this.g-=this.B?4+(this.ba&&6<=this.A?1:0):(this.W?4:3)+(7==this.A?2:0)}function Hg(a){var b=ff(this,a);a=Af(this,a);var c=(b=(0>b?this.j[-b-1]&255:b)<<8)-(a<<=8);We(this,c,a,b);this.g-=this.B?4+(this.ba&&6<=this.A?1:0):(this.W?4:3)+(7==this.A?2:0)}
function Ig(a){var b=Bf(this,a);if(b){a=a>>6&7;var c=this.j[a]<<16|this.j[a|1];this.F=this.I=0;b&32768&&(b|=-65536);var d=~~(c/b);-32768<=d&&32767>=d?(this.j[a]=d&65535,this.j[a|1]=c-d*b&65535,this.M=d>>16|d,this.K=d>>16):(this.I=32768,this.M=d>>15|d,this.K=c>>16,-1===b&&65534===this.j[a]&&(this.j[a]=this.j[a|1]=1));this.g-=53}else this.M=this.K=0,this.I=32768,this.F=65536,this.g-=7}function Jg(){H(this,24,0,-9);this.g-=20}
function Kg(){this.C&49152?(this.S|=128,H(this,4,0,-8)):(this.ra&&1120==this.model&&this.ra.setData(this.j[0],!0),this.H?Lg(this.H):Ic(this));this.g-=7}function Mg(){H(this,16,0,-9);this.g-=20}var Ng=[0,7,7,10,7,11,9,13];function Og(a){this.ka=this.g;Ec(this,zf(this,a));this.g=this.ka-Ng[this.B]}var Pg=[0,14,14,17,14,18,16,20];function Qg(a){this.ka=this.g;var b=zf(this,a);a=a>>6&7;Xe(this,this.j[a]);this.j[a]=this.j[7];Ec(this,b);this.g=this.ka-Pg[this.B]}
var Rg=[3,9,9,13,10,14,12,16,4,9,9,13,10,14,13,17];function Sg(a){var b=gf(this,a);this.ka=this.g;Ef(this,a,b,this.Da);this.g=this.ka-Rg[(this.W?8:0)+this.B]+(7!=this.A||this.B?0:2)}function Tg(a){var b=ff(this,a);Df(this,a,b,65535,this.Da);this.g-=this.B?9+(this.ba&&6<=this.A?1:0):(this.W?5:3)+(7==this.A?2:0)}var Ug=[7,13,13,17,14,18,17,21];
function Vg(a){var b=Bf(this,a);a=a>>6&7;b=(b<<16>>16)*(this.j[a]<<16>>16);this.j[a]=b>>16&65535;this.j[a|1]=b&65535;b|=0;this.K=b>>16;this.M=this.K|b;this.I=0;this.F=-32768>b||32767<b?65536:0;this.g-=23}function Wg(){this.g-=5}function Xg(){this.C&49152||(this.G.reset(),Fc(this),this.ra&&this.ra.setData(this.j[0],!0));this.g-=667}function Yg(a){if(a&8)O.call(this,a);else{var b=Ze(this);a&=7;7==a?Ec(this,b):(Ec(this,this.j[a]),this.j[a]=b);this.g-=9}}function Zg(){Ye(this);this.g-=13}
function $g(a){a&1&&(this.F=65536);a&2&&(this.I=32768);a&4&&(this.M=0);a&8&&(this.K=32768);this.g-=5}function ah(a){var b=(a&448)>>6;if(this.j[b]=this.j[b]-1&65535)Ec(this,this.j[7]-((a&63)<<1)),this.g+=1;this.g-=6}function bh(a){N(this,a,gf(this,a),cg);this.g-=this.B?9+(this.ba&&6<=this.A?1:0):(this.W?5:3)+(7==this.A?2:0)}function ch(a){N(this,a,0,eg);this.g-=this.B?9:3+(7==this.A?2:0)}function dh(){H(this,28,0,-9)}
function eh(){this.ra&&(this.ra.Cd(this.j[7],!0),this.ra.setData(this.j[0],!0));this.u|=8;Re(this,-2);this.g-=3}function fh(a){N(this,a,this.j[(a>>6&7)+this.tc],fg);this.g-=this.B?9:3+(7==this.A?2:0)}function O(a){var b;if(b=this.H)b=this.H,ec(b,2)?(b.v(3,"undefined opcode %s\n",G(b,a)),b=Lg(b)):b=!1;b||H(this,8,0,-9)}function Je(a){gh[a>>12].call(this,a)}function hh(a){ih[a>>6&3].call(this,a)}function jh(a){kh[a>>6&3].call(this,a)}function lh(a){mh[a>>6&3].call(this,a)}
function nh(a){oh[a&15].call(this,a)}function ph(a){qh[a&15].call(this,a)}function rh(a){sh[a>>6&3].call(this,a)}function th(a){uh[a>>6&3].call(this,a)}function vh(a){wh[a>>6&3].call(this,a)}
var gh=[function(a){xh[a>>8&15].call(this,a)},Sg,Gg,pg,lg,ng,gg,O,function(a){yh[a>>8&15].call(this,a)},Tg,Hg,qg,mg,og,bh,O],xh=[function(a){zh[a>>4&15].call(this,a)},Cg,zg,rg,sg,xg,tg,vg,Qg,Qg,hh,jh,lh,O,O,O],ih=[function(a){Ef(this,a,0,this.lb);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){N(this,a,0,Rf);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){N(this,a,1,Vf);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){N(this,a,1,Tf);this.g-=this.B?9:3+(7==this.A?2:0)}],kh=[function(a){N(this,a,0,Xf);
this.g-=this.B?11:6},function(a){N(this,a,Ne(this)?1:0,Hf);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){N(this,a,Ne(this)?1:0,cg);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){a=Bf(this,a);this.lb(a);this.g-=this.B?4:3+(7==this.A?2:0)}],mh=[function(a){N(this,a,0,ag);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){N(this,a,0,Zf);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){N(this,a,0,Lf);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){N(this,a,0,Jf);this.g-=this.B?9:3+(7==this.A?2:0)}],zh=
[function(a){Ah[a&15].call(this,a)},O,O,O,Og,Og,Og,Og,Yg,O,nh,ph,ch,ch,ch,ch],Ah=[Kg,eh,Zg,Bg,Mg,Xg,O,O,O,O,O,O,O,O,O,O],oh=[Wg,function(){this.F=0;this.g-=5},function(){this.I=0;this.g-=5},Fg,function(){this.M=1;this.g-=5},Fg,Fg,Fg,function(){this.K=0;this.g-=5},Fg,Fg,Fg,Fg,Fg,Fg,Fg],qh=[Wg,function(){this.F=65536;this.g-=5},function(){this.I=32768;this.g-=5},$g,function(){this.M=0;this.g-=5},$g,$g,$g,function(){this.K=32768;this.g-=5},$g,$g,$g,$g,$g,$g,$g],yh=[Ag,yg,ug,wg,Dg,Eg,jg,kg,Jg,dh,rh,th,
vh,O,O,O],sh=[function(a){Df(this,a,0,255,this.lb);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){Cf(this,a,0,Sf);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){Cf(this,a,1,Wf);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){Cf(this,a,1,Uf);this.g-=this.B?9:3+(7==this.A?2:0)}],uh=[function(a){Cf(this,a,0,Yf);this.g-=this.B?11:6},function(a){Cf(this,a,Ne(this)?1:0,If);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){Cf(this,a,Ne(this)?1:0,dg);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){a=Af(this,
a);this.lb(a<<8);this.g-=this.B?4:3+(7==this.A?2:0)}],wh=[function(a){Cf(this,a,0,bg);this.g-=this.B?9+(this.Pc&1):3+(7==this.A?2:0)},function(a){Cf(this,a,0,$f);this.g-=this.B?9:3+(7==this.A?2:0)},function(a){Cf(this,a,0,Mf);this.g-=this.B?9+(this.Pc&1):3+(7==this.A?2:0)},function(a){Cf(this,a,0,Kf);this.g-=this.B?9:3+(7==this.A?2:0)}];function Ke(a){Bh[a>>12].call(this,a)}
var Bh=[function(a){Ch[a>>8&15].call(this,a)},Sg,Gg,pg,lg,ng,gg,function(a){Dh[a>>8&15].call(this,a)},function(a){Eh[a>>8&15].call(this,a)},Tg,Hg,qg,mg,og,bh,O],Ch=[function(a){Fh[a>>4&15].call(this,a)},Cg,zg,rg,sg,xg,tg,vg,Qg,Qg,hh,jh,lh,function(a){Gh[a>>6&3].call(this,a)},O,O],Gh=[function(a){a=this.j[7]+((a&63)<<1)&65535;var b=this.oa(a|this.Ga);Ec(this,this.j[5]);this.j[6]=a+2&65535;this.j[5]=b;this.g-=8},function(a){a=df(this,a,0);this.Da(a);Xe(this,a);this.g-=11},function(a){var b=Ze(this);
this.ka=this.g;this.Da(b);ef(this,a,0,b);this.g=this.ka-Ug[this.B]},function(a){Ef(this,a,Qe(this)?65535:0,this.Da);this.g-=this.B?9:3+(7==this.A?2:0)}],Fh=[function(a){Hh[a&15].call(this,a)},O,O,O,Og,Og,Og,Og,Yg,function(a){!(a&8)||1145>this.model?O.call(this,a):(this.C&49152||(this.C=this.C&-225|(a&7)<<5,this.u|=1,this.u&=-3),this.g-=5)},nh,ph,ch,ch,ch,ch],Hh=[Kg,eh,function(){Ye(this);this.u|=this.C&16;this.g-=13},Bg,Mg,Xg,Zg,function(a){O.call(this,a)},O,O,O,O,O,O,O,O],Dh=[Vg,Vg,Ig,Ig,hg,hg,ig,
ig,fh,fh,O,O,O,O,ah,ah],Eh=[Ag,yg,ug,wg,Dg,Eg,jg,kg,Jg,dh,rh,th,vh,function(a){1145>this.model?O.call(this,a):Ih[a>>6&3].call(this,a)},O,O],Ih=[function(a){O.call(this,a)},function(a){a=df(this,a,65536);this.Da(a);Xe(this,a);this.g-=11},function(a){var b=Ze(this);this.ka=this.g;this.Da(b);ef(this,a,65536,b);this.g=this.ka-Ug[this.B]},function(a){O.call(this,a)}];
function Jh(a){E.call(this,"ROM",a,256);this.ia=this.j=null;this.B=+a.addr;this.g=+a.size;this.C=!1;this.u=a.alias;"string"==typeof this.u&&(this.u=eval(this.u));this.A=a.file;this.D=Na(this.A);if(this.A){a=this.A;var b=Qa(this.D);"json"!=b&&"hex"!=b&&(a=fb()+"/api/v1/dump?file="+this.A+"&format=bytes&decimal=true");var c=this;$a(a,null,!0,function(d,e,f){f?(c.V("Unable to load ROM resource (error "+f+": "+d+")"),c.A=null):(Ib(c.fb,d,e),(d=gb(d,e))?(c.j=d.ca,c.ia=d.ia):c.A=null);Kh(c)})}}u(Jh,E);
k=Jh.prototype;k.Aa=function(a,b,c,d){this.G=b;this.i=c;this.H=d;Kh(this)};k.Ca=function(){this.ia&&(this.H&&Lh(this.H,this.id,this.B,this.g,this.ia),delete this.ia);return!0};k.Ba=function(){return!0};
function Kh(a){if(!Xb(a)){if(a.A){if(!a.j||!a.G)return;a.g||(a.g=a.j.length);if(a.j.length!=a.g)Vb(a,"ROM size ("+Ma(a.j.length,8,!0)+") does not match specified size ("+Ma(a.g,8,!0)+")");else{a:{var b=a.B;if(57344<=b&&b<57344+gd){var c={};c=(c[b]=[Jh.prototype.Fg,Jh.prototype.Vh,null,null,null,a.g>>1],c);if(rc(a.G,a,c)){a.v(137438953472,"Added %d-byte ROM at %o\n",a.g,b);b=a.C=!0;break a}}else if(nd(a.G,b,a.g,fe)){for(c=0;c<a.j.length;c++)vd(a.G,b+c,a.j[c]);b=!0;break a}b=!1}if(b){b=[];"number"==
typeof a.u?b.push(a.u):null!=a.u&&a.u.length&&(b=a.u);for(c=0;c<b.length;c++){for(var d=a,e=b[c],f=d.G,g=d.g,h=[],l=d.B>>>f.j;0<g&&l<f.g.length;)h.push(f.g[l++]),g-=f.u;f=d.G;d=d.g;g=0;for(e>>>=f.j;0<d&&e<f.g.length;){l=h[g++];if(!l)break;f.g[e++]=l;d-=f.u}}a.C||delete a.j}}}F(a)}}k.Fg=function(a){return this.j[a-this.B]};k.Vh=function(){};vb(function(){for(var a=Mb("pdp11","rom"),b=0;b<a.length;b++){var c=a[b],d=Nb(c);d=new Jh(d);Lb(d,c)}});
function Mh(a){E.call(this,"RAM",a);this.ia=this.j=null;this.u=+a.addr;this.A=+a.size;this.za=a.load;this.ya=a.exec;null!=this.za&&(this.za=+this.za);null!=this.ya&&(this.ya=+this.ya);this.B=this.D=!1;this.g=a.file;this.C=Na(this.g);if(this.g){a=this.g;var b=Qa(this.C);"json"!=b&&"hex"!=b&&(a=fb()+"/api/v1/dump?file="+this.g+"&format=bytes&decimal=true");var c=this;$a(a,null,!0,function(d,e,f){f?(c.V("Unable to load RAM resource (error "+f+": "+d+")"),c.g=null):(Ib(c.fb,d,e),(d=gb(d,e))?(c.j=d.ca,
c.ia=d.ia,null==c.za&&(c.za=d.za),null==c.ya&&(c.ya=d.ya)):c.g=null);Nh(c)})}}u(Mh,E);Mh.prototype.Aa=function(a,b,c,d){this.G=b;this.i=c;this.H=d;Nh(this)};Mh.prototype.Ca=function(a,b){this.ia&&(this.H&&Lh(this.H,this.id,this.u,this.A,this.ia),delete this.ia);b||this.reset();return!0};Mh.prototype.Ba=function(){return!0};
function Nh(a){if(a.G&&(!a.B&&a.A&&(nd(a.G,a.u,a.A,xd)?a.B=!0:a.A=0),!Xb(a))){if(!a.B)D("No RAM allocated");else if(a.g){if(!a.j)return;Oh(a,a.j,a.za,a.ya,a.u)?a.v(137438953472,'Loaded image "%s"\n',a.C):a.V('Error loading image "'+a.C+'"')}a.D=!0;F(a)}}
Mh.prototype.reset=function(){if(this.B&&!this.D){var a=this.G,b=this.u,c=this.A,d=b&a.A;for(b>>>=a.j;0<c&&b<a.g.length;){var e=a.g[b],f=d,g=c,h=0;f=f||0;h=(h||0)&255;void 0===g&&(g=e.size);if(e.g)for(d=f;g--&&d<e.g.length;d++)e.g[d]=h;else for(d=f;g--&&d<e.size;d++)e.u(f,h,e.N+f);c-=a.u;b++;d=0}this.j&&Oh(this,this.j,this.za,this.ya,this.u,!this.H)}this.D=!1};
function Oh(a,b,c,d,e,f){var g=!1,h=!1;if(null==c)for(var l=0;l<b.length-1;){var m=b[l]&255|(b[l+1]&255)<<8;if(m)if(m&255){var n=l;if(1!=m){a.v(16384,"invalid signature (%#06x) at offset %#06x\n",m,n);break}if(l+6>=b.length){a.v(16384,"invalid block at offset %#06x\n",n);break}l+=2;var p=b[l++]&255|(b[l++]&255)<<8,q=b[l++]&255|(b[l++]&255)<<8;m+=(p&255)+(p>>8)+(q&255)+(q>>8);for(var r=l,w=p-=6;0<p&&l<b.length;)m+=b[l++]&255,p--;if(0!=p||l>=b.length){a.v(16384,"insufficient data for block at offset %#06x\n",
n);break}m+=b[l++]&255;if(m&255){a.v(16384,"invalid checksum (%#04x) for block at offset %#06x\n",m,n);break}if(w)for(a.v(16384,"loading %#06x bytes at %#06x-%%#06x\n",w,q,q+w);w--;)vd(a.G,q++,b[r++]&255);else q&1?g=!0:null==d&&(d=q),null!=d&&a.v(16384,"starting address: %#06x\n",d);h=!0}else l++;else l+=2}if(!h&&(null==c&&(c=e),null!=c)){for(e=0;e<b.length;e++)vd(a.G,c+e,b[e]);h=!0}if(h){if(null==d||g)Ic(a.i),f=!1;null!=d&&Me(a.i,d,f)}return h}
vb(function(){for(var a=Mb("pdp11","ram"),b=0;b<a.length;b++){var c=a[b],d=Nb(c);d=new Mh(d);Lb(d,c)}});function Ph(a){E.call(this,"Keyboard",a,2048);F(this)}u(Ph,E);Ph.prototype.ua=function(){return!1};Ph.prototype.Aa=function(a,b,c,d){this.L=a;this.i=c;this.H=d};vb(function(){for(var a=Mb("pdp11","keyboard"),b=0;b<a.length;b++){var c=a[b],d=Nb(c);d=new Ph(d);Lb(d,c)}});
function Qh(a){E.call(this,"SerialPort",a,4194304);this.O=+a.adapter;this.U=+a.baudReceive||9600;this.ba=+a.baudTransmit||9600;this.M=a.upperCase;"string"==typeof this.M&&(this.M="true"==this.M);this.B=this.C=null;this.Z=+a.tabSize;this.W=+a.charBOL;this.D=0;this.K=!0;this.S=this.P=null;this.T=this.aa=-1;this.F=this.g=this.j=0;this.A=[];a=a.binding;if("console"==a)this.C="";else if(a){var b=Qb("Panel",this.id);b&&(b=b.J[a])&&this.ua("",a,b)}this.u=this.I=this.R=null;this.exports={connect:this.pe,
receiveData:this.Ic,receiveStatus:this.$g,setConnection:this.fh}}u(Qh,E);k=Qh.prototype;
k.ua=function(a,b,c){if(!a||"textarea"==a){var d=this;this.J[b]=this.B=c;c.onkeydown=function(e){e=e||window.event;var f=0,g=e.keyCode;8==g?f=e.altKey?Ea.Id:Ea.Ub:46==g?f=Ea.Id:e.ctrlKey&&g>=Ea.Gd&&g<=Ea.tf&&(f=g-(Ea.Gd-Ea.Ae));f&&(e.preventDefault&&e.preventDefault(),d.Ic(f));return!0};c.onkeypress=function(e){e=e||window.event;if(!e.metaKey){var f=e.which||e.keyCode;e.altKey&&f==Ea.Ce&&(f=Ea.Be);d.Ic(f);e.preventDefault&&e.preventDefault()}return!0};c.onpaste=function(e){e.stopPropagation&&e.stopPropagation();
e.preventDefault&&e.preventDefault();(e=e.clipboardData||window.clipboardData)&&d.Ic(e.getData("Text"))};c.removeAttribute("readonly");return!0}return!1};
k.Aa=function(a,b,c,d){this.L=a;this.G=b;this.i=c;this.H=d;var e=this;this.S=Fd(this.i,this.O?-1:48,4,2097152);this.T=Cd(this.i,function(){var f=-1;e.A.length&&(f=e.A.shift()&255,e.v("receiveByte(%#04x)\n",f),e.M&&97<=f&&122>f&&(f-=32),Ed(e.i,e.T,1E3/Math.round(e.U/10)));0<=f&&(e.F=f,e.g&128?e.F|=49152:e.g|=128,e.g&64&&Dd(c,e.S))});this.P=Fd(this.i,this.O?-1:52,4,2097152);this.aa=Cd(this.i,function(){e.j|=128;e.j&64&&Dd(c,e.P)});rc(b,this,Rh,this.O?64832+8*(this.O-1)-65392:0);tc(b,this.reset.bind(this));
F(this)};k.pe=function(a){if(!this.u){var b=ue(this.L,"connection");if(b){var c=b.split("->");if(2==c.length){var d=Va(c[0]);if(d!=this.Sc)return;c=Va(c[1]);if(this.u=Pb(c)){var e=this.u.exports;if(e){var f=e.connect;f&&f.call(this.u,this.K);if(this.I=e.receiveData){this.K=a;this.R=e.receiveStatus;this.v(137438953472,"Connected %s.%s to %s\n",this.fb,d,c);return}}}}this.v(137438953472,"Unable to establish connection: %s\n",b)}}};
k.Ca=function(a,b){if(!b)if(this.pe(this.K),!a)this.reset();else if(!this.restore(a))return!1;return!0};k.Ba=function(a){return a?this.save():!0};k.reset=function(){Sh(this)};k.save=function(){var a=new xc(this);a.set(0,[this.F,this.g,this.j,this.A]);return a.data()};k.restore=function(a){return Sh(this,a[0])};function Sh(a,b){b||(b=[0,8192,128,a.A]);b=ba(b);a.F=b.next().value;a.g=b.next().value;a.j=b.next().value;a.A=b.next().value;return!0}
k.Ic=function(a){if("number"==typeof a)this.A.push(a);else if("string"==typeof a)for(var b=0,c,d=0;d<a.length;d++){c=b;b=a.charCodeAt(d);if(10==b){if(13==c)continue;b=13}this.A.push(b)}else this.A=this.A.concat(a);Ed(this.i,this.T,1E3/Math.round(this.U/10));return!0};k.$g=function(a){var b=this.g;this.g&=-12289;a&32&&(this.g|=8192);a&256&&(this.g|=4096);b!=this.g&&(this.g|=32768,this.g&32&&Dd(this.i,this.S))};k.fh=function(a,b){return this.u?!1:(this.u=a,this.I=b,!0)};
k.sg=function(){var a=this.g&65534;this.g&=-32769;return a};k.Ih=function(a){var b=a^this.g;this.g=this.g&-112|a&111;this.R&&b&6&&(b=0,b=this.K?b|(a&4?32:0)|(a&2?320:0):b|(a&4?16:0)|(a&2?1048576:0),this.R.call(this.u,b))};k.rg=function(){this.g&=-129;return this.F};k.Hh=function(){};k.Zg=function(){return this.j};k.oi=function(a){this.j&128&&(a&64?Dd(this.i,this.P):Jd(this.i,this.P));this.j=this.j&-70|a&69};k.Yg=function(){return 0};
k.ni=function(a){a&=255;this.I&&this.I.call(this.u,a);a&=127;if(this.B)if(13==a)this.D=0;else if(8==a)this.B.value=this.B.value.slice(0,-1),0<this.D&&this.D--;else{if(a){var b;13!=a&&10!=a&&(b=Wa[a]);b=b?"<"+b+">":String.fromCharCode(a);var c=b.length;32>a&&1==c&&(c=0);9==a&&(a=this.Z||8,c=a-this.D%a,this.Z&&(b=Ua("",c)));this.W&&!this.D&&c&&(b=String.fromCharCode(this.W)+b);this.B.value+=b;this.B.scrollTop=this.B.scrollHeight;this.D+=c}}else if(null!=this.C){if(10==a||1024<=this.C.length)this.print(this.C),
this.C="";10!=a&&(this.C+=String.fromCharCode(a))}Ed(this.i,this.aa,1E3/Math.round(this.ba/10));this.j&=-129};var Th={},Rh=(Th[65392]=[null,null,Qh.prototype.sg,Qh.prototype.Ih,"RCSR"],Th[65394]=[null,null,Qh.prototype.rg,Qh.prototype.Hh,"RBUF"],Th[65396]=[null,null,Qh.prototype.Zg,Qh.prototype.oi,"XCSR"],Th[65398]=[null,null,Qh.prototype.Yg,Qh.prototype.ni,"XBUF"],Th);vb(function(){for(var a=Mb("pdp11","serial"),b=0;b<a.length;b++){var c=a[b],d=Nb(c);d=new Qh(d);Lb(d,c)}});
function ae(a){E.call(this,"PC11",a,8192);this.P=Uh(this,a.autoMount);this.j=0;this.W=+a.baudReceive||3600;this.C=this.g=0;this.M=32768;this.u=this.T=0;this.F=[];this.D=Vh;this.A=Wh;this.O=this.B="";this.ca=this.za=this.ya=null;this.S=-1;this.R=!nb()&&window&&"FileReader"in window;this.I=null;this.U=-1;this.K=null}u(ae,E);function Uh(a,b){if(b&&"string"==typeof b)try{b=eval("("+b+")")}catch(c){D(a.type+" auto-mount error: "+c.message+" ("+b+")"),b=null}return b||{}}k=ae.prototype;
k.ua=function(a,b,c){var d=this,e=Wh;switch(b){case "listTapes":return this.J[b]=c,c.onchange=function(){var f=d.J.descTape,g=c.options[c.selectedIndex];if(f&&g){var h={};if(g=g.getAttribute("data-value"))try{h=eval("("+g+")")}catch(l){D("PC11 option error: "+l.message)}g=h.desc;void 0===g&&(g="");h=h.href;void 0!==h&&(g='<a href="'+h+'" target="_blank">'+g+"</a>");f.innerHTML=g}},!0;case "descTape":return this.J[b]=c,!0;case "readTape":e=Xh;case "loadTape":return e||(e=Yh),this.J[b]=c,c.onclick=
function(){var f=d.J.listTapes;f&&Zh(d,f.options[f.selectedIndex].text,f.value,e)},!0;case "mountTape":if(!this.R){c.parentNode.removeChild(c);break}this.J[b]=c;c.addEventListener("change",function(){var f=c.children[0];f.children[1].disabled=!f.children[0].files.length});c.onsubmit=function(f){if(f=f.currentTarget[1].files[0]){var g=f.name;Zh(d,Na(g,!0),g,Yh,f)}return!1};return!0;case $h:return this.J[b]=c,!0}return!1};
k.Aa=function(a,b,c,d){this.L=a;this.G=b;this.i=c;this.H=d;this.K=ai(a);var e=this;if(a=Uh(this,ue(this.L,"autoMount")))for(var f in a)"PTR"==f&&(this.P[f]=a[f]);this.I=Fd(this.i,56,4,8192);this.U=Cd(this.i,function(){1!=(e.g&32769)||e.g&128||(e.u<e.F.length?(e.C=e.F[e.u]&255,e.v("%s.advanceReader(%d): %#04x\n",e.type,e.u,e.C),e.u++,bi(e,e.u/e.F.length*100)):e.g|=32768,e.g|=128,e.g&=-2049,e.g&64&&Dd(e.i,e.I))});rc(b,this,ci);tc(b,this.reset.bind(this));di(this,"None",Vh,!0);this.R&&di(this,"Local Tape",
ei);di(this,"Remote Tape",fi);gi(this)||F(this)};k.Ca=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};k.Ba=function(a){return a?this.save():!0};k.reset=function(){this.g&=-2241;this.C=0};function gi(a){a.j=0;var b=a.P.PTR;if(b){var c=b.path||"";if(!(b=b.name))a:{if((b=a.J.listTapes)&&b.options)for(var d=0;d<b.options.length;d++){var e=b.options[d];if(e.value==c){b=e.text;break a}}b=Na(c,!0)}c&&b?hi(a,b,c,Yh,!0):ii(a)}return!!a.j}
function Zh(a,b,c,d,e){if(c)if(c==ei)a.V('Use "Choose File" and "Mount" to select and load a local tape.');else{if(c==fi){c=window.prompt("Enter the URL of a remote tape image.","")||"";if(!c)return;b=Na(c);a.v(137438953472,'Attempting to load %s as "%s"\n',c,b);a.D=fi}else a.D=c;hi(a,b,c,d,!1,e)}else ji(a,!1)}
function hi(a,b,c,d,e,f){var g=-1;if(a.B.toLowerCase()!=c.toLowerCase()||a.A!=d)g++,ji(a,!0),a.flags.bb?a.V("PC11 busy"):(e&&(a.j++,a.v('auto-loading tape "%s"\n',b)),a.load(b,c,d,f)?g++:a.flags.bb=!0);g&&ki(a,a.O,a.B,a.A,a.ca,a.za,a.ya)}
k.load=function(a,b,c,d){var e=this,f=b;if(d){var g=new FileReader;g.onload=function(){var h=g.result;h&&(h=new Uint8Array(h,0,h.byteLength),ki(e,a,b,c,h),e.D=ei);e.flags.bb=!1;ii(e)};g.readAsArrayBuffer(d);return!1}0>b.indexOf("/api/v1/dump")&&(d=Qa(b),f="json"==d||"gz"==d?encodeURI(b):fb()+"/api/v1/dump?path="+encodeURIComponent(b)+"&format=json");return!!$a(f,null,!0,function(h,l,m){var n=0>m&&!!e.L&&!e.L.flags.da;m?e.V('Unable to load tape "'+a+'" (error '+m+": "+h+")",n):(Ib(e.fb,h,l),(h=gb(h,
l))&&ki(e,a,b,c,h.ca,h.za,h.ya));e.flags.bb=!1;e.j&&(e.j--,e.j||F(e));ii(e)})};function di(a,b,c,d){if((a=a.J.listTapes)&&a.options){for(var e=0;e<a.options.length;e++)if(a.options[e].value==c)return;e=document.createElement("option");e.text=b;e.value=c;d&&a.childNodes[0]?a.insertBefore(e,a.childNodes[0]):a.appendChild(e)}}
function ii(a){var b=a.J.listTapes;if(b&&b.options){a=a.D||a.B;for(var c=0;c<b.options.length;c++)if(b.options[c].value==a){b.selectedIndex!=c&&(b.selectedIndex=c);break}c==b.options.length&&(b.selectedIndex=0)}}function bi(a,b){b|=0;if(b!==a.S){var c=a.J[$h];c&&(c=(c=Mb(c,li))&&c[0])&&c.style&&(c.style.width=b+"%");a.S=b}}
function ki(a,b,c,d,e,f,g){a.O=b;a.B=c;a.A=d;a.ca=e;a.za=f;a.ya=g;d==Xh?a.K&&Oh(a.K,e,f,g,null,!1)?a.v(137438953472,'Read tape "%s"\n',b):a.V('No valid memory address for tape "'+b+'"'):(a.u=0,a.F=e,a.g&=-32769,a.v(137438953472,'Loaded tape "%s" (%d bytes)\n',b,e.length),bi(a,0))}function ji(a,b){if(a.B||!1===b)a.O="",a.B="",b||(a.A&&a.v(137438953472,"%s\n",a.A==Yh?"tape detached":"tape unloaded"),a.D=Vh,a.A=Wh,ii(a))}k.save=function(){return(new xc(this)).data()};k.restore=function(){return!0};
k.lg=function(){return this.g&65534};k.Bh=function(a){a&1&&(this.g&32768?(a&=-2,this.g&64&&Dd(this.i,this.I)):(this.g&=-129,this.g|=2048,this.C=0,Ed(this.i,this.U,1E3/Math.round(this.W/10))));this.g=this.g&-66|a&65};k.kg=function(){this.g&=-129;this.g|=2048;return this.C};k.Ah=function(){};k.jg=function(){return this.M};k.zh=function(a){this.M=this.M&-65|a&64};k.ig=function(){return this.T};k.yh=function(a){this.T=a&255};
var Vh="",ei="?",fi="??",Wh=0,Yh=1,Xh=2,$h="readProgress",li="pcjs-progress-bar",mi={},ci=(mi[65384]=[null,null,ae.prototype.lg,ae.prototype.Bh,"PRS"],mi[65386]=[null,null,ae.prototype.kg,ae.prototype.Ah,"PRB"],mi[65388]=[null,null,ae.prototype.jg,ae.prototype.zh,"PPS"],mi[65390]=[null,null,ae.prototype.ig,ae.prototype.yh,"PPB"],mi);
function ni(a,b,c){E.call(this,"Disk",{id:a.fb+".disk"+Ma(++oi,4)},32768);this.controller=a;this.L=a.L;this.H=a.H;this.B=b;this.Wa=b.name;this.Ma=this.Bd="";this.vd=b.vd;this.fa=this.ma=this.na=this.ta=this.mode=0;this.g=[];this.u=null;this.A=!1;this.create(c,b.fa,b.ma,b.na,b.ta);this.j=this.C=null;F(this)}u(ni,E);k=ni.prototype;k.Aa=function(a,b,c,d){this.H=d};
k.create=function(a,b,c,d,e){this.mode=a;this.fa=b;this.ma=c;this.na=d;this.ta=e;this.g=[];if("preload"!=this.mode){a=Array(this.fa);for(b=0;b<a.length;b++){c=Array(this.ma);for(d=0;d<c.length;d++){e=Array(this.na);for(var f=1;f<=e.length;f++)e[f-1]=pi(null,b,d,f,this.ta,0);c[d]=e}a[b]=c}this.g=a}this.u=null};
k.load=function(a,b,c,d,e){var f=b;if(this.j)return!0;this.Wa=a;this.Ma=b;this.Bd=Na(b);var g=this;this.j=d;this.C=e||this.controller;if(c){var h=new FileReader;h.onload=function(){var l=h.result,m=l?l.byteLength:0,n=Da[m];if(n){g.fa=n[0];g.ma=n[1];g.na=n[2];g.ta=n[3]||512;var p=g.ta>>2;var q=n=0;l=new DataView(l,0,m);g.g=Array(g.fa);for(m=0;m<g.g.length;m++)for(var r=g.g[m]=Array(g.ma),w=0;w<r.length;w++)for(var B=r[w]=Array(g.na),z=0;z<B.length;z++){for(var x=pi(null,m,w,z+1,g.ta,0),W=x.data,oa=
0;oa<p;oa++,q+=4){var I=W[oa]=l.getInt32(q,!0);n=n+I&-1}x.Ka=p;B[z]=x}g.u=n;p=g}else g.V("Unrecognized disk format ("+m+" bytes)");g.j&&(g.j.call(g.controller,g.B,p,g.Wa,g.Ma),g.j=null)};h.readAsArrayBuffer(c);return!0}0>b.indexOf("/api/v1/dump")&&(a=Qa(b),"json"==a||"gz"==a?f=encodeURI(b):(c="path",d="&mbhd=10",!b.indexOf("http:")||!b.indexOf("ftp:")||0<="dsk ima img 360 720 12 144".split(" ").indexOf(a)?(c="disk",d="&mbhd=0"):Ra(b,"/")&&(c="dir"),f=fb()+"/api/v1/dump?"+c+"="+encodeURIComponent(b)+
(this.vd?"":d)+"&format=json"));return!!$a(f,null,!0,function(l,m,n){qi(g,l,m,n)})};
function qi(a,b,c,d){var e=null,f=0>d&&!!a.L&&!a.L.flags.da;a.A=!1;if(d)a.controller.V('Unable to load disk "'+a.Wa+'" (error '+d+": "+b+")",f);else{Ib(a.controller.fb,b,c);try{if(0<Na(a.Bd,!0).toLowerCase().indexOf("-readonly"))a.A=!0;else{var g=c.indexOf("\n");0<g&&1024>g&&0<c.substring(0,g).indexOf("write-protected")&&(a.A=!0)}var h;"<"==c.substr(0,1)?h=["Missing disk image: "+a.Wa]:h=0>c.indexOf("0x")&&'["'!=c.substr(0,2)?JSON.parse(c.replace(/([a-z]+):/gm,'"$1":').replace(/\/\/[^\n]*/gm,"")):
eval("("+c+")");if(h.length)if(1==h.length)D(h[0]);else{a.fa=h.length;a.ma=h[0].length;a.na=h[0][0].length;var l=h[0][0][0];a.ta=l&&l.length||512;for(d=c=0;d<a.fa;d++)for(f=0;f<a.ma;f++)for(g=0;g<a.na;g++)if(l=h[d][f][g]){var m=l.length;void 0===m&&(m=l.length=512);m>>=2;var n=l.pattern;void 0===n&&(n=l.pattern=0);var p=l.data;if(void 0===p){var q=l.bytes;if(void 0!==q&&q.length){for(var r=m<<2,w=q.length;w<r;w++)q[w]=n;a.fill(l,q,0)}else p=[],n=l.pattern=n|n<<8|n<<16|n<<24,l.data=p;delete l.bytes}pi(l,
d,f);for(r=0;r<p.length;r++)c=c+p[r]&-1}a.g=h;a.u=c;e=a}else D("Empty disk image: "+a.Wa)}catch(B){D("Disk image error ("+b+"): "+B.message)}}a.j&&(a.j.call(a.C,a.B,e,a.Wa,a.Ma),a.j=null)}function pi(a,b,c,d,e,f){a||(a={sector:d,length:e,data:[],pattern:f});a.vk=b;a.wk=c;a.Ua=a.Ka=0;a.wb=!1;return a}k.info=function(){return this.g.length?[this.g.length,this.g[0].length,this.g[0][0].length,this.g[0][0][0].length]:[0,0,0,0]};
k.seek=function(a,b,c,d,e){d=null;var f=this.B,g=this.g[a];if(g){var h=g[b];if(!h&&f.vf&&b<f.ma)for(h=g[b]=Array(f.wf),g=0;g<h.length;g++)h[g]=pi(null,a,b,g+1,f.qe,0);if(h){for(g=0;g<h.length;g++)if(h[g]&&h[g].sector==c){d=h[g];break}!d&&f.vf&&9==f.fe&&(d=h[g]=pi(null,a,b,f.fe,f.qe,0))}}e&&e(d,!1);return d};k.fill=function(a,b,c){for(var d=a.length>>2,e=Array(d),f=0;f<d;f++)e[f]=b[c]|b[c+1]<<8|b[c+2]<<16|b[c+3]<<24,c+=4;a.data=e};
k.read=function(a,b){var c=-1;if(a&&b<a.length){c=a.data;var d=b>>2;c=(d<c.length?c[d]:a.pattern)>>((b&3)<<3)&255}return c};k.write=function(a,b,c){if(this.A)return!1;if(b<a.length){if(c!=this.read(a,b,!0)){var d=a.data,e=a.pattern,f=b>>2;b=(b&3)<<3;for(var g=d.length;g<=f;g++)d[g]=e;a.Ka?f<a.Ua?(a.Ka+=a.Ua-f,a.Ua=f):f>=a.Ua+a.Ka&&(a.Ka+=f-(a.Ua+a.Ka)+1):(a.Ua=f,a.Ka=1);d[f]=d[f]&~(255<<b)|c<<b}return!0}return null};
k.save=function(){var a=0,b=[];b[a++]=[this.Ma,this.u,this.fa,this.ma,this.na,this.ta];if(!this.A)for(var c=this.g,d=0;d<c.length;d++)for(var e=0;e<c[d].length;e++)for(var f=0;f<c[d][e].length;f++){var g=c[d][e][f];if(g&&g.Ka){for(var h=[],l=0,m=g.Ua,n=g.Ua+g.Ka;m<n;)h[l++]=g.data[m++];b[a++]=[d,e,f,g.Ua,h]}}return b};
k.restore=function(a){var b=0,c="unsupported restore format";if(a&&0<a.length){var d=0,e=a[d++];e&&2<=e.length&&(!this.g.length&&6<=e.length?this.create("local",e[2],e[3],e[4],e[5]):null!=e[1]&&null!=this.u&&e[1]!=this.u&&(c="original checksum ("+e[1]+") differs from current checksum ("+this.u+")",b=-2));for(this.g.length||(b=-1);d<a.length&&0<=b;){var f=0,g=a[d++],h=g[f++],l=g[f++],m=g[f++];if(h>=this.g.length||l>=this.g[h].length||m>=this.g[h][l].length){c="sector (CHS="+h+":"+l+":"+m+") out of range ("+
b+" changes applied)";b=-1;break}if(this.A){c="unable to modify write-protected disk";b=-1;break}e=g[f++];f=g[f++];g=e+f.length;if(h=this.g[h][l][m]){for(l=h.data.length;l<e;)h.data[l++]=h.pattern;l=0;h.Ua=e;for(h.Ka=f.length;e<g;)h.data[e++]=f[l++];b++}}}0>b&&-2!=b&&this.controller.V("Unable to restore disk '"+this.Wa+": "+c);return b};var oi=0;
function ri(a,b,c,d,e,f){E.call(this,a,b,c);this.P=si(this,b.autoMount);this.O=0;this.T=d;this.U=e;this.W=f;this.S=d.Vc;this.j=Array(this.S);this.R=!nb()&&"FileReader"in y;this.D=[];this.Pa=null;this.exports={bootDisk:this.ge,loadDisk:this.xd,selectDrive:this.eh,wait:this.ih}}u(ri,E);function si(a,b){if(b&&"string"==typeof b)try{b=eval("("+b+")")}catch(c){D(a.type+" auto-mount error: "+c.message+" ("+b+")"),b=null}return b||{}}k=ri.prototype;
k.ua=function(a,b,c){var d=this;switch(b){case "listDisks":return this.J[b]=c,c.onchange=function(){ti(d)},!0;case "descDisk":case "listDrives":return this.J[b]=c,c.onchange=function(){var e=Ga(c.value,10);null!=e&&ui(d,e)},!0;case "loadDisk":return this.J[b]=c,c.onclick=function(){d.xd()},!0;case "bootDisk":return this.J[b]=c,c.onclick=function(){d.ge()},!0;case "saveDisk":if(!this.R){c.parentNode.removeChild(c);break}this.J[b]=c;c.onclick=function(){var e=d.J.listDrives;if(e&&e.options&&d.j)if(e=
d.j[Ga(e.value,10)||0]){var f=e.ea;if(f){e=f.rk();f=f.Bd.replace(".json",".img");var g=null,h;"string"!=typeof e?"function"==typeof Blob&&"undefined"!=typeof URL&&URL&&"function"==typeof URL.createObjectURL&&(h=URL.createObjectURL(new Blob([e],{type:"application/octet-stream"}))):h="data:application/octet-stream;base64,"+e;if(h)if(f&&(g=document.createElement("a"),"string"!=typeof g.download&&(g=null)),g){g.href=h;g.download=f;document.body.appendChild(g);g.click();document.body.removeChild(g);var l=
"Check your Downloads folder for "+f+"."}else y.open&&(y.open(h),l="Check your browser for a new window/tab containing the requested data"+(f?" ("+f+")":"")+".");else l="Operation unsupported by your browser.";bb(l)}else d.V("No disk loaded in drive.")}else d.V("No disk drive selected.")};return!0;case "mountDisk":if(this.R)return this.J[b]=c,c.addEventListener("change",function(){var e=c.children[0];e.children[1].disabled=!e.children[0].files.length}),c.onsubmit=function(e){if(e=e.currentTarget[1].files[0]){var f=
e.name;d.xd(Na(f,!0),f,e)}return!1},!0;c.parentNode.removeChild(c)}return!1};k.Aa=function(a,b,c,d){this.L=a;this.G=b;this.i=c;this.H=d;if(a=si(this,ue(this.L,"autoMount")))for(var e in a)e.substr(0,2)==this.type.substr(0,2)&&(this.P[e]=a[e]);this.reset();this.Pa=Fd(this.i,this.T.qd,this.T.md,this.ja);rc(b,this,this.W);tc(b,this.reset.bind(this));vi(this,"None",wi,!0);this.R&&vi(this,"Local Disk",xi);vi(this,"Remote Disk",yi);Yi(this)||F(this)};
k.Ca=function(a,b){if(!b){if(!a){if(this.reset(),this.L.P){this.D=[];for(a=0;a<this.j.length;a++)$i(this,a,!0);Yi(this,!0)}}else if(!this.restore(a))return!1;if(a=this.J.listDrives){for(;a.firstChild;)a.removeChild(a.firstChild);a.value="";for(b=0;b<this.S;b++){var c=document.createElement("option");c.value=b;c.text=this.j[b].Kc||"---";a.appendChild(c)}0<this.S&&(a.value="0",ui(this,0))}}return!0};k.Ba=function(a){return a?this.save():!0};k.reset=function(){this.xb();aj(this)};
k.save=function(){var a=new xc(this);a.set(0,this.Lc());for(var b=a.set,c=0;c<this.j.length;c++){var d=this.j[c];d.ea&&bj(this,d.Ma,d.ea)}b.call(a,1,this.D);b=a.set;c=[];for(d=0;d<this.j.length;d++){var e=this.j[d];c.push([e.Jb,e.Wa,e.Ma])}b.call(a,2,c);return a.data()};k.restore=function(a){var b=!0;this.xb(a[0])||(b=!1);var c=a[1];c&&(this.D=c);aj(this,a[2])||(b=!1);return b};k.xb=function(){return!0};k.Lc=function(){return[]};
function aj(a,b){for(var c=0;c<a.j.length;c++){var d=a.j[c];void 0===d&&(d=a.j[c]={});var e=a,f=d;d=c;var g=a.U,h=b&&b[c],l=0;f.Lb=d;f.name=e.Sc;f.Gc=f.Jb=!1;f.ac=null;f.vd=!0;f.Kc=g[l++]+d;f.fa=g[l++];f.ma=g[l++];f.na=g[l++];f.ta=g[l++];f.Ef=g[l++];f.Ff=g[l++];f.Gf=g[l++];f.xf=g[l++];f.status=g[l];f.qk=0;f.pk=0;f.fe=1;f.wf=f.na;f.qe=f.ta;f.xk=0;f.Fk=null;f.ea||(f.Ma="");h&&(l=h[1],g=h[2],h[0]?(f=l,h=g,g=e.j[d],$i(e,d,!0),g.Jb=!0,d=new ni(e,g,"preload"),e.ie(g,d,f,h,!0)):cj(e,d,l,g,!0)?f.ea&&g&&dj(e,
l,g,f.ea):F(e,!1))}return!0}function Yi(a,b){b||(a.O=0);for(var c in a.P){var d=a.P[c],e=d.path||"",f;if(!(f=d.name))a:{if((f=a.J.listDisks)&&f.options)for(var g=0;g<f.options.length;g++){var h=f.options[g];if(h.value==e){f=h.text;break a}}f=Na(e,!0)}if(e&&f&&(g=-1,c&&(g=c.charCodeAt(c.length-1)-48,0>g||9<g)&&(g=-1),0<=g&&g<a.j.length)){!cj(a,g,f,e,!0)&&b&&F(a,!1);continue}a.V("Incorrect auto-mount settings for drive "+c+" ("+JSON.stringify(d)+")")}return!!a.O}
k.xd=function(a,b,c){if(!a&&!b){var d=this.J.listDisks;d&&d.options&&(a=d.options[d.selectedIndex].text,b=d.value)}d=(d=this.J.listDrives)&&Ga(d.value,10);if(void 0===d||0>d||d>=this.j.length)return this.V("Unable to load the selected drive"),!1;if(!b)return $i(this,d),!0;if(b==xi)return this.V('Use "Choose File" and "Mount" to select and load a local disk.'),!1;if(b==yi){b=y.prompt("Enter the URL of a remote disk image.","")||"";if(!b)return!1;a=Na(b);this.v(137438953472,'Attempting to load %s as "%s"\n',
b,a)}cj(this,d,a,b,!1,c);return!0};k.ge=function(){var a,b=this.J.listDrives;b=b&&Ga(b.value,10);if(null==b||0>b||b>=this.j.length||!(a=this.j[b]))return this.V("Unable to boot the selected drive"),!1;if(!a.ea)return this.V("Load a disk into the drive first"),!1;Me(this.i,0,!0,b);return(a=this.Mb(a,a.Ef,a.Ff,a.Gf,a.xf,0,2))?(this.V("Unable to read the boot sector ("+a+")"),!1):!0};
function cj(a,b,c,d,e,f){var g=-1,h=a.j[b];h.Ma.toLowerCase()!=d.toLowerCase()&&(g++,$i(a,b,!0),h.Gc?a.V(a.type+" busy"):(h.Gc=!0,e&&(h.ud=!0,a.O++,a.v('auto-loading disk "%s"\n',c)),h.Jb=!!f,(new ni(a,h,"preload")).load(c,d,f,a.ie)&&g++));return g}
k.ie=function(a,b,c,d,e){a.Gc=!1;b&&(b.fa>a.fa||b.ma>a.ma)&&(this.V('Disk "'+c+'" too large for drive '+(this.j[a.Lb].Kc||"---")),b=null);b?(a.ea=b,a.Wa=c,a.Ma=d,this.re(a.Lb),dj(this,c,d,b),this.V('Loaded disk "'+c+'" in drive '+(this.j[a.Lb].Kc||"---"),a.ud||e),this.L&&Ee(this.L)):a.Jb=!1;a.ud&&(a.ud=!1,--this.O||F(this));ui(this,a.Lb);a.ac&&(a.ac(),a.ac=null)};
function vi(a,b,c,d){if((a=a.J.listDisks)&&a.options){for(var e=0;e<a.options.length;e++)if(a.options[e].value==c)return;e=document.createElement("option");e.text=b;e.value=c;d&&a.childNodes[0]?a.insertBefore(e,a.childNodes[0]):a.appendChild(e)}}
function ui(a,b,c){var d=!1;if(0<=b&&b<a.j.length){var e=a.j[b],f=a.J.listDisks;a=a.J.listDrives;if(f&&a&&f.options&&a.options){if(c)for(c=0;c<a.options.length;c++)if(Ga(a.options[c].value,10)==e.Lb){a.selectedIndex!=c&&(a.selectedIndex=c);d=!0;break}c=Ga(a.value,10);e=e.Jb?xi:e.Ma;if(!isNaN(c)&&c==b){for(c=0;c<f.options.length;c++)if(f.options[c].value==e){f.selectedIndex!=c&&(f.selectedIndex=c);d=!0;break}c==f.options.length&&(f.selectedIndex=0)}}}return d}
k.eh=function(a){var b=this.J.listDrives;if(b&&b.options)for(var c=b.options.length,d=0;d<c;d++)if(b.options[d].textContent==a){var e=Ga(b.options[d].value,10);if(0<=e)return ui(this,e,!0)}return!1};
function ti(a){var b=a.J.listDisks,c=a.J.descDisk,d=b.options&&b.options[b.selectedIndex];if(c&&d){b={};if(d=d.getAttribute("data-value"))try{b=eval("("+d+")")}catch(e){D(a.type+" option error: "+e.message)}a=b.desc;void 0===a&&(a="");b=b.href;void 0!==b&&(a='<a href="'+b+'" target="_blank">'+a+"</a>");c.innerHTML=a}}k.ih=function(a){for(var b=0;b<this.j.length;b++){var c=this.j[b];if(c&&c.Gc)return c.ac||(c.ac=a),!1}return!0};
function $i(a,b,c){var d=a.j[b];if(d.ea||!1===c)bj(a,d.Ma,d.ea),d.Wa="",d.Ma="",d.ea=null,d.Jb=!1,c||(a.V("Drive "+(a.j[b].Kc||"---")+" unloaded",c),ui(a,b))}function dj(a,b,c,d){var e;for(e=0;e<a.D.length;e++)if(a.D[e][1]==c){d.restore(a.D[e][2]);return}a.D[e]=[b,c,[]]}function bj(a,b,c){var d;for(d=0;d<a.D.length;d++)if(a.D[d][1]==b){a.D[d][2]=c.save();break}}k.re=function(){};k.Mb=function(){return-1};k.Qc=function(){return-1};var wi="",xi="?",yi="??";
function L(a){ri.call(this,"RK11",a,262144,gc,gc.Ac,ej);this.I=this.u=this.g=this.C=this.B=this.A=this.F=0}u(L,ri);k=L.prototype;k.xb=function(a){a||(a=[fj.Ac|fj.ae|fj.Xd,0,P.Ya,0,0,0,0]);a=ba(a);this.I=a.next().value;this.u=a.next().value;this.g=a.next().value;this.C=a.next().value;this.B=a.next().value;this.A=a.next().value;this.F=a.next().value;return!0};k.Lc=function(){return[this.I,this.u,this.g,this.C,this.B,this.A,this.F]};
k.Mb=function(a,b,c,d,e,f,g,h,l){var m=0;a=a.ea;var n=null;a||(m=Q.Rd,e=0);for(;e;){if(!n){if(b>=a.fa){m=Q.yc;break}n=a.seek(b,c,d+1);if(!n){m=Q.$d;break}var p=0;++d>=a.na&&(d=0,++c>=a.ma&&(c=0,++b))}var q,r;if(0>(q=a.read(n,p++))||0>(r=a.read(n,p++))){m=Q.zc;break}if(!h&&(Zc(this.G,$e(this.i,f),q|r<<8),Bd(this.G))){m=Q.Xb;break}p>=a.ta&&(n=null);f+=g;e--}return l?l(m,b,c,d,e,f):m};
k.Qc=function(a,b,c,d,e,f,g,h,l){var m=0;a=a.ea;var n=null;a||(m=Q.Rd,e=0);for(;e;){var p=ad(this.G,$e(this.i,f));if(Bd(this.G)){m=Q.Xb;break}if(!n){if(b>=a.fa){m=Q.yc;break}n=a.seek(b,c,d+1,!0);if(!n){m=Q.$d;break}var q=0;++d>=a.na&&(d=0,++c>=a.ma&&(c=0,++b))}if(h){var r,w;if(0>(r=a.read(n,q++))||0>(w=a.read(n,q++))){m=Q.zc;break}if(p!=(r|w<<8)){m=Q.ce;break}}else if(!a.write(n,q++,p&255)||!a.write(n,q++,p>>8)){m=Q.zc;break}q>=a.ta&&(n=null);f+=g;e--}return l?l(m,b,c,d,e,f):m};
k.Me=function(a,b,c,d,e,f){this.B=f&65535;this.g=this.g&~P.Cb|f>>16-P.la.Cb&P.Cb;this.C=65536-e&65535;this.A=this.A&~gj.nd|d&gj.nd;this.u|=a;hj(this);return!0};function hj(a){a.g&=~P.eb;a.u&&(a.u|=Q.Ee,a.g|=P.eb,a.u&Q.ad&&(a.g|=P.ad),a.v("%s: ERROR: %o\n",a.type,a.u))}k.xg=function(){return this.I};k.Nh=function(){};k.yg=function(){return this.u};k.Oh=function(){};k.ug=function(){return this.g&P.Yb};
k.Kh=function(a){this.g=this.g&~P.Sa|a&P.Sa;if(this.g&P.Vb){a=!0;var b,c="",d=(this.A&gj.nb)>>gj.la.nb,e=this.j[d];this.g&=~(P.Ya|P.od);this.u&=~Q.lf;switch(b=this.g&P.va){case ij.ze:this.v("%s: CRESET(%d)\n",this.type,d);this.u=this.A=0;this.g=P.Ya;break;case ij.Se:c="RCHK";case ij.ob:c||(c="READ");var f=this.Mb;case ij.rd:c||(c="WCHK");case ij.$b:c||(c="WRITE");f||(f=this.Qc);var g=(this.A&gj.Tb)>>gj.la.Tb;var h=(this.A&gj.dd)>>gj.la.dd;var l=this.A&gj.nd;var m=65536-this.C&65535;var n=(this.g&
P.Cb)<<16-P.la.Cb|this.B;var p=this.g&P.Le?0:2;this.v(1,"%s: %s(%d:%d:%d) %o-%o\n",this.type,c,g,h,l,n,n+(m<<1));if(g>=e.fa){this.u|=Q.yc;break}if(l>=e.na){this.u|=Q.zc;break}a=f.call(this,e,g,h,l,m,n,p,b>=ij.rd,this.Me.bind(this));break;case ij.Ec:g=(this.A&gj.Tb)>>gj.la.Tb;this.v("%s: SEEK(%d)\n",this.type,g);g<e.fa?this.g|=P.od:this.u|=Q.yc;break;case ij.Fe:this.v("%s: DRESET(%d)\n",this.type,d);this.u=this.A=0;this.g=P.Ya|P.od;break;default:this.v("%s: UNSUPPORTED(%s)\n",this.type,b)}this.I=e.status|
(e.ea?fj.Ea:0)|d<<fj.la.fd|this.A&fj.kf;hj(this);a&&(this.g&=~P.Vb,this.g|=P.Ya,this.g&P.Bb&&Dd(this.i,this.Pa))}};k.zg=function(){return this.C};k.Ph=function(a){this.C=a};k.tg=function(){return this.B};k.Jh=function(a){this.B=a};k.vg=function(){return this.A};k.Lh=function(a){this.A=a};k.wg=function(){return this.F};k.Mh=function(a){this.F=a};
var fj=gc.Bc,Q=gc.Ze,P=gc.Xe,gj=gc.Ye,ij=gc.va,jj={},ej=(jj[65280]=[null,null,L.prototype.xg,L.prototype.Nh,"RKDS"],jj[65282]=[null,null,L.prototype.yg,L.prototype.Oh,"RKER"],jj[65284]=[null,null,L.prototype.ug,L.prototype.Kh,"RKCS"],jj[65286]=[null,null,L.prototype.zg,L.prototype.Ph,"RKWC"],jj[65288]=[null,null,L.prototype.tg,L.prototype.Jh,"RKBA"],jj[65290]=[null,null,L.prototype.vg,L.prototype.Lh,"RKDA"],jj[65294]=[null,null,L.prototype.wg,L.prototype.Mh,"RKDB"],jj);
function be(a){ri.call(this,"RL11",a,524288,hc,hc.$e,kj);this.g=this.F=this.u=this.A=this.C=this.B=0}u(be,ri);k=be.prototype;k.xb=function(a){a||(a=[R.Ea|R.Ya,0,0,0,0,0]);a=ba(a);this.g=a.next().value;this.F=a.next().value;this.u=a.next().value;this.A=a.next().value;this.C=a.next().value;this.B=a.next().value;return!0};k.Lc=function(){return[this.g,this.F,this.u,this.A,this.C,this.B]};
k.Mb=function(a,b,c,d,e,f,g,h,l){g=0;a=a.ea;h=null;a||(g=lj.Za,e=0);for(;e;){if(!h){h=a.seek(b,c,d+1);if(!h){g=lj.Za;break}var m=0}var n,p;if(0>(n=a.read(h,m++))||0>(p=a.read(h,m++))){g=lj.Za;break}Zc(this.G,$e(this.i,f),n|p<<8);if(Bd(this.G)){g=lj.Xb;break}f+=2;e--;if(m>=a.ta&&(h=null,++d>=a.na&&(d=0,++c>=a.ma&&(c=0,++b>=a.fa)))){g=lj.Za;break}}return l?l(g,b,c,d,e,f):g};
k.Qc=function(a,b,c,d,e,f,g,h,l){g=0;a=a.ea;h=null;a||(g=lj.Za,e=0);for(;e;){var m=ad(this.G,$e(this.i,f));if(Bd(this.G)){g=lj.Xb;break}f+=2;e--;if(!h){h=a.seek(b,c,d+1,!0);if(!h){g=lj.Za;break}var n=0}if(!a.write(h,n++,m&255)||!a.write(h,n++,m>>8)){g=lj.Za;break}if(n>=a.ta&&(h=null,++d>=a.na&&(d=0,++c>=a.ma&&(c=0,++b>=a.fa)))){g=lj.Za;break}}return l?l(g,b,c,d,e,f):g};
k.Ne=function(a,b,c,d,e,f){this.F=f&65535;this.g=this.g&~R.Xa|f>>16-R.la.Xa&R.Xa;this.B=f>>16&mj.$a;this.A=this.u=b<<nj.la.Zb|(c?nj.Dc:0)|d&nj.Yd;this.C=65536-e&65535;a&&(this.g=this.g|a|R.eb);return!0};k.Cg=function(){return this.g&R.Yb};
k.Sh=function(a){this.g=this.g&~R.Sa|a&R.Sa;this.B=this.B&60|(a&R.Xa)>>R.la.Xa;if(!(this.g&R.Ya)){a=!0;var b="",c=this.j[(this.g&R.nb)>>R.la.nb],d=c.ea;this.g&=~R.Ea;switch(this.g&R.va){case oj.qf:this.C&pj.Kd&&(this.g&=R.Ea|R.va|R.Xa);this.C=c.status|this.A&nj.Dc|(d&&512==d.fa?pj.Ie:0);break;case oj.Ec:if((this.u&nj.He)==nj.mf){var e=this.u&nj.Zb;b=(this.u&nj.pf)<<2;this.A=this.u&nj.nf?this.A+e:this.A-e;this.u=this.A=this.A&nj.Zb|b}break;case oj.We:this.C=this.A;break;case oj.Te:b="READ",e=this.Mb;
case oj.sf:b||(b="WRITE");e||(e=this.Qc);var f=this.u>>nj.la.Zb;var g=this.u&nj.Dc?1:0;var h=this.u&nj.Yd;!d||f>=d.fa||h>=d.na?this.g=this.g|lj.Za|R.eb:(a=65536-this.C&65535,d=(this.B&mj.$a)<<16|this.F,this.v(1,"%s: %s(%d:%d:%d) %o-%o\n",this.type,b,f,g,h,d,d+(a<<1)),a=e.call(this,c,f,g,h,a,d,2,!1,this.Ne.bind(this)))}a&&(this.g=this.g|R.Ea|R.Ya,this.g&R.Bb&&Dd(this.i,this.Pa))}};k.Ag=function(){return this.F};k.Qh=function(a){this.F=a&qj.Sa};k.Dg=function(){return this.u};
k.Th=function(a){this.u=a};k.Eg=function(){return this.C};k.Uh=function(a){this.C=a};k.Bg=function(){return this.B};k.Rh=function(a){this.B=a&mj.$a;this.g=this.g&~R.Xa|(this.B&3)<<R.la.Xa};
var R=hc.cf,qj=hc.af,nj=hc.df,pj=hc.Cc,mj=hc.bf,lj=hc.Jd,oj=hc.va,rj={},kj=(rj[63744]=[null,null,be.prototype.Cg,be.prototype.Sh,"RLCS"],rj[63746]=[null,null,be.prototype.Ag,be.prototype.Qh,"RLBA"],rj[63748]=[null,null,be.prototype.Dg,be.prototype.Th,"RLDA"],rj[63750]=[null,null,be.prototype.Eg,be.prototype.Uh,"RLMP"],rj[63752]=[null,null,be.prototype.Bg,be.prototype.Rh,"RLBE"],rj);
function ce(a){ri.call(this,"RX11",a,1048576,ic,ic.ef,sj);this.K=this.I=this.u=this.M=this.g=this.F=0;this.A=T.Db;this.B=0;this.C=Array(128).fill(0)}u(ce,ri);k=ce.prototype;k.xb=function(a){a?(a=ba(a),this.g=a.next().value,this.F=a.next().value,this.K=a.next().value,this.I=a.next().value,this.u=a.next().value,this.M=a.next().value,this.A=a.next().value,this.B=a.next().value,this.C=a.next().value):(this.F=this.g=0,this.I=this.K=1,this.M=this.u=0,this.A=T.ob,this.B=0,Jd(this.i,this.Pa),tj(this));return!0};
k.Lc=function(){return[this.g,this.F,this.K,this.I,this.u,this.M,this.A,this.B,this.C]};k.re=function(a){0==a&&this.xb()};function uj(a,b){b&&(a.M=b,a.F=a.u,a.g|=U.eb);a.A=T.Db;a.g|=U.DONE;a.g&U.Bb&&Dd(a.i,a.Pa)}
k.Mb=function(a,b,c,d,e,f,g,h,l){h=0;var m=a.ea,n=null;this.v(1,"%s.readData(%d:%d:%d) %o-%o\n",this.type,b,c,d,f,f+(e<<1));m||(h=a.Lb?vj.cd:vj.bd,e=0);for(;e;){if(!n){if(b>=m.fa){h=vj.Qe;break}n=m.seek(b,c,d+1);if(!n){h=vj.ld;break}var p=0;++d>=m.na&&(d=0,++c>=m.ma&&(c=0,++b))}var q;if(0>(a=m.read(n,p++))||0>(q=m.read(n,p++))){h=vj.kd;break}Zc(this.G,$e(this.i,f),a|q<<8);p>=m.ta&&(n=null);f+=g;e--}return l?l(h,b,c,d,e,f):h};
function tj(a){var b=0,c=a.g&U.pd?1:0,d=a.j[c];d=d&&d.ea;var e=a.K&wj.$a,f=a.I&xj.$a;a.u&=~(yj.Hd|yj.Ud|yj.Ub|yj.Ea);if(d)if(a.u|=yj.Ea,a.v(1,"%s.readSector(%d:%d:%d)\n",a.type,e,0,f),c=d.seek(e,0,f,!0)){e=0;for(f=a.C.length;e<f;){var g=d.read(c,e);if(0>g){b=vj.kd;break}a.C[e++]=g}c.Af&&(a.u|=yj.Ub)}else b=vj.ld;else b=c?vj.cd:vj.bd;uj(a,b)}
k.Gg=function(a,b){a=this.g;if(!b)switch(a&=U.Yb,this.A){case T.Yc:case T.EMPTY:this.B<this.C.length&&(this.g|=U.ab);break;case T.ob:case T.$b:case T.Fc:2>this.B&&(this.g|=U.ab)}return a};
k.Wh=function(a){this.g=this.g&~U.Sa|a&U.Sa;if(this.g&U.INIT)this.xb();else if(this.g&U.Vb&&this.A==T.Db)switch(this.A=this.g&U.va,this.g&=~(U.Vb|U.ab|U.DONE|U.eb),Jd(this.i,this.Pa),this.v(1,"%s.processCommand(%s)\n",this.type,zj[this.A>>1]),this.A){case T.Yc:case T.EMPTY:case T.ob:case T.$b:case T.Fc:this.B=0;break;case T.Ve:a=this.j[this.g&U.pd?1:0];this.u&=~yj.Ea;a&&a.ea&&(this.u|=yj.Ea);this.F=this.u;uj(this);break;case T.Ue:this.F=this.M,uj(this)}else this.g&U.Bb?this.g&U.DONE&&Dd(this.i,this.Pa):
Jd(this.i,this.Pa)};k.Hg=function(a,b){if(!b)switch(this.A){case T.EMPTY:this.g&U.ab&&(this.g&=~U.ab,this.F=this.C[this.B]&255,this.v(1,"%s.readByte(%d): %#04x\n",this.type,this.B,this.F),++this.B>=this.C.length&&uj(this))}return this.F};
k.Xh=function(a){switch(this.A){case T.Yc:this.g&U.ab&&(this.g&=~U.ab,this.C[this.B]=a&255,this.v(1,"%s.writeByte(%d,%#04x)\n",this.type,this.B,a),++this.B>=this.C.length&&uj(this));break;case T.ob:case T.$b:case T.Fc:if(this.g&U.ab)switch(this.g&=~U.ab,this.B++){case 0:this.I=a;break;case 1:if(this.K=a,this.A==T.ob)tj(this);else{var b=this.A==T.Fc,c=0,d=this.g&U.pd?1:0,e=this.j[d];e=e&&e.ea;var f=this.K&wj.$a,g=this.I&xj.$a;this.u&=~(yj.Hd|yj.Ud|yj.Ub|yj.Ea);if(e)if(this.u|=yj.Ea,this.v(1,"%s.writeSector(%d:%d:%d)\n",
this.type,f,0,g),d=e.seek(f,0,g,!0))for(b&&(d.Af=!0),b=0,f=this.C.length;b<f;){if(!e.write(d,b,this.C[b]&255)){c=vj.kd;break}b++}else c=vj.ld;else c=d?vj.cd:vj.bd;uj(this,c)}}}this.F=a};var U=ic.ff,wj=ic.jf,xj=ic.hf,yj=ic.gf,T=ic.va,vj=ic.Ge,zj="FILL EMPTY WRITE READ UNUSED RDSTAT WRDEL RDERR".split(" "),Aj={},sj=(Aj[65144]=[null,null,ce.prototype.Gg,ce.prototype.Wh,"RXCS"],Aj[65146]=[null,null,ce.prototype.Hg,ce.prototype.Xh,"RXDB"],Aj);
function Bj(a,b,c){E.call(this,a,b,c);this.Y=+b.base||16;this.S=["{","}"];this.ka=["[","]"];this.Ra=this.D=0;this.U=!1;this.C=-1;this.B=[];this.u={}}u(Bj,E);Bj.prototype.me=function(){return-1};Bj.prototype.wd=function(){};
function Cj(a,b,c,d){if(c)if(b){0>a.C&&a.B.length&&(a.C=0);if(0>a.C||b!=a.B[a.C])a.B.splice(0,0,b),a.C=0;a.C--}else a.U?b="end":b=a.B[a.C+1];a=[];if(b){b=b.replace(/""/g,"'");c=0;var e=null;d=d||";";for(var f=0;f<=b.length;f++){var g=b.charAt(f);if('"'==g||"'"==g)e?g==e&&(e=null):e=g;else if(g==d&&!e||!g)a.push(Va(b.substring(c,f))),c=f+1}}return a}
function Dj(a,b,c){var d=a;b=b||32;if(c)if(32==b)d=a>>>0;else if(32>b)d=a&(1<<b)-1;else{if(b=Math.pow(2,b),0>a||a>=b)d=a%b,0>d&&(d+=b)}else 32>=b?d=a<<32-b>>32-b:(b=Math.pow(2,b-1),a>=b?(d=a%b,(a/b|0)&1&&(d-=b)):a<-b&&(d=a%b,((-a-1)/b|0)&1?d&&(d+=b):d||(d-=b)));a!=d&&(a=d);return a}
function Ej(a,b,c){for(c=void 0===c?-1:c;c--&&b.length;){var d=b.pop();if(2>a.length)return!1;var e=a.pop();var f=a.pop();switch(d){case "*":f*=e;break;case "/":if(!e)return!1;f=Math.trunc(f/e);break;case "^/":if(!e)return!1;f%=e;break;case "+":f+=e;break;case "-":f-=e;break;case "<<":f<<=e;break;case ">>":f>>=e;break;case ">>>":f>>>=e;break;case "<":f=f<e?1:0;break;case "<=":f=f<=e?1:0;break;case ">":f=f>e?1:0;break;case ">=":f=f>=e?1:0;break;case "==":f=f==e?1:0;break;case "!=":f=f!=e?1:0;break;
case "&":f&=e;break;case "!":case "|":f|=e;break;case "^!":f^=e;break;case "&&":f=f&&e?1:0;break;case "||":f=f||e?1:0;break;case ",,":f=Dj(f,18,!0)*Math.pow(2,18)+Dj(e,18,!0);break;case "_":case "^_":"^_"==d&&(e=35-(e&255));e&&(f=Dj(f,0,!0),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));break;default:return!1}a.push(Dj(f))}return!0}
function Fj(a,b,c,d,e,f){var g,h=!1,l=0,m=[],n=[],p=a.Y;for(a.Y=e;c<d;){var q=b[c++].trim();var r=c<d?b[c++]:"";if(q)var w=Gj(a,q,void 0,f,l);else if("{"==r){q=1;for(w=c;c<d;)if(c++,r=c<b.length?b[c++]:"","{"==r)q++;else if("}"==r&&!--q)break;w=Fj(a,b,w,c-1,a.Y,f);null!=w&&l&&(w=Hj(w,l));q=c<d?b[c++].trim():"";r=c<d?b[c++]:""}else{if(" "==r)continue;if("^B"==r){a.Y=2;continue}if("^O"==r){a.Y=8;continue}if("^D"==r){a.Y=10;continue}if(!(l&-1073741824)){if("+"==r)continue;if("-"==r){l=l<<2|1;continue}if("~"==
r||"^-"==r){l=l<<2|2;continue}if("^L"==r){l=l<<2|3;continue}}h=!0;break}if(void 0===w)if(f)f.push(q),w=0;else{h=!0;f=[];break}m.push(Dj(w));if(" "==r)if(c<b.length-1&&!b[c])c++,r=b[c++];else{h=!0;break}if(!r)break;l="<"==a.S[0]?Ij:Jj;if(!l[r]){h=!0;break}n.length&&l[r]<=l[n[n.length-1]]&&Ej(m,n,1);n.push(r);a.Y="^_"==r?10:e;l=0}if(h||!Ej(m,n)||1!=m.length)h=!0;h?f||a.v("parse error (%s)\n",q||r):g=m.pop();a.Y=p;return g}
function Kj(a,b,c,d,e){for(var f;0<=(f=b.indexOf(c));){for(var g=0,h=f+1,l=e;h<b.length;){var m=b[h++];if(m==c){l=-1;break}if(!l)break;l--;m=m.charCodeAt(0);7==d?m&=127:m=m-32&63;g=Dj(g*Math.pow(2,d)+m,d*e,!0)}if(0<=l){a.v("parse error (%s%s%s)\n",c,b,c);return}b=b.substr(0,f)+G(a,g,-1)+b.substr(h)}return b}
function Lj(a,b,c){var d=void 0,e=!1===c;c=Array.isArray(c)?c:void 0;if(b){"{"!=a.S[0]&&(b=b.split(a.S[0]).join("{").split(a.S[1]).join("}"));b=Kj(a,b,'"',7,5);if(!b)return d;b=Kj(a,b,"'",6,6);if(!b)return d;16!=a.Y&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);d=Fj(a,b,0,b.length,a.Y,c);void 0!==d&&e&&Mj(a,null,d)}return d}
function Hj(a,b){for(;b;){var c;switch(b&3){case 1:a=-Dj(a);break;case 2:a^=-1;break;case 3:for(c=35;0<=c&&!(a&Math.pow(2,c));)c--;a=35-c}b>>>=2}return a}
function Gj(a,b,c,d,e){e=void 0===e?0:e;var f=Array.isArray(d)?d:void 0;if(void 0!=b){var g=a.me(b);if(0<=g)g=a.wd(g);else if(g=b,a.u[g]?g=a.u[g].value:(g=g.substr(0,6),g=a.u[g]&&a.u[g].value),void 0!=g){var h=a.u[b]&&a.u[b].dh;h&&(f?f.push(h):(f=Lj(a,h,d),void 0!==f?g+=f:(d||a.v("undefined %s: %s (%s)\n",c||"value",b,h),g=void 0)))}else g=Ga(b,1<b.length||10<a.Y?a.Y:10);void 0!=g?g=Dj(Hj(g,e)):d||a.v("invalid %s: %s\n",c||"value",b)}else d||a.v("missing %s\n",c||"value");return g}
function Mj(a,b,c){var d=!1;if(void 0!==c){d=!0;var e=8==a.Y?G(a,c,32,8,1)+"  "+c+".":G(a,c,32,16,1)+"  "+G(a,c,32,8,1)+"  "+G(a,c,32,2,8)+"  "+c+".";32<=c&&127>c&&(e+=" '"+String.fromCharCode(c)+"'")}a.v("%s%s\n",null!=b?b+": ":"",e);return d}function Nj(a,b){var c=0;if(a.u){if(b)return Mj(a,b,a.u[b]&&a.u[b].value);b=Object.keys(a.u);b.sort();for(var d=0;d<b.length;d++)Mj(a,b[d],a.u[b[d]].value),c++}return 0<c}
function G(a,b,c,d,e){c=void 0===c?0:c;e=void 0===e?0:e;switch((void 0===d?0:d)||a.Y){case 2:a=Ja(b,0<c?c:0,e);break;case 8:a=Ka(b,0<c?(c+2)/3|0:0,!!e);break;case 10:a=La(b,0<c?Math.ceil(.3*c):0);break;default:a=Ma(b,0<c?c+3>>2:0,!!e)}return c=0>c?a.replace(/^0+([0-9A-F]+)$/i,"$1"):a}
var Jj={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},Ij={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,_:19,"^_":19,"{":20,"}":20};
function Oj(a){Bj.call(this,"Debugger",a,-1);this.Ga=!1;this.S=["(",")"];this.ka=[];this.M=V();this.Fa=V();this.T=V();this.F=[];this.g=this.P=this.K=[];Pj(this);this.W=this.ha=0;this.A=[];this.sa=void 0;Qj(this);this.H=this;this.pa={};this.ja=0;this.Z=null;this.R=[];Rj(this,a.messages);this.xa=a.commands;this.Ja=Sj;this.aa=[];this.O=0;this.Na=this.wa=null;this.D=this.Ia=this.Ha=this.ba=this.ra=0;this.j=this.I=null;var b=this;void 0===y.pdp11&&(y.pdp11=function(c){return ze(b,c)})}u(Oj,Bj);
function Tj(a){a=a&&a.N;null==a&&(a=-1);return a}function V(a,b,c){return{N:void 0===a?null:a,La:void 0===b?!1:b,Ta:!1,Y:c}}k=Oj.prototype;k.Cd=function(a,b){a.N=b;a.Ta=!1;a.Y=void 0};function Uj(a){return[a.N,a.La,a.Y,a.Ta,a.Jc]}function Vj(a,b){var c=V(b[0],b[1],b[2]);c.Ta=b[3];b[4]&&(c.de=Cj(a,c.Jc=b[4]));return c}
k.Aa=function(a,b,c,d){this.G=b;this.L=a;this.i=c;this.j=a.u;(a=ue(a,"messages"))&&Rj(this,a);1140>this.i.model&&(this.aa=this.aa.concat(Wj));1145>this.i.model&&(this.aa=this.aa.concat(Xj));Hd(this,32,function(e){a:{var f=d.G.g,g=e[0],h=e=0,l=f.length;if(g){e=Tj(Yj(d,g));if(-1===e){d.v("invalid address: %s\n",g);break a}h=e>>>d.G.j;l=1}d.v("blockid   physical   blockaddr  used    size    type\n");d.v("--------  ---------  ---------  ------  ------  ----\n");g=-1;for(var m=0;l--;){var n=f[h];n.type==
g?m++||d.v("...\n"):(g=n.type,m=sd[g],n&&d.v("%08x  %%08x  %%08x  %#06x  %#06x  %s\n",n.id,h<<d.G.j,n.N,n.Pb,n.size,m),g!=ee&&(g=-1),m=0);e+=d.G.u;h++}}});F(this)};
k.ua=function(a,b,c){var d=this;switch(b){case "debugInput":return this.I=this.J[b]=c,c.onkeydown=function(e){if(13==e.keyCode){var f=d.I.value;d.I.value="";ze(d,f,!0)}else if(27==e.keyCode)d.I.value=f="";else if(38==e.keyCode?(f=null,d.C<d.B.length-1&&(f=d.B[++d.C])):40==e.keyCode&&(0<d.C?f=d.B[--d.C]:(f="",d.C=-1)),null!=f){var g=f.length;d.I.value=f;d.I.setSelectionRange(g,g)}null!=f&&e.preventDefault&&e.preventDefault()},!0;case "debugEnter":return this.J[b]=c,tb(c,function(){if(d.I){var e=d.I.value;
d.I.value="";ze(d,e,!0);return!0}return!1}),!0;case "step":return this.J[b]=c,tb(c,function(e){var f=!1;Yb(d,!0)||(Zb(d,!0),f=Jc(d,e?1:0,null),Zb(d,!1));return f}),!0}return!1};function ye(a){if(a.I){var b=0,c=0;window&&(b=window.scrollX,c=window.scrollY);a.I.focus();window&&window.scrollTo(b,c)}}k.Nd=function(a,b){var c=255,d=Tj(a);-1!==d&&(a.La||65535<d?(c=this.G,d=$e(this.i,d),c.I=!1,c.B++,d=ud(c,d).B(d&c.A,d),c.B--):(c=this.i,c.pa++,d=c.G.Ld($c(c,d,3)),c.pa--),c=d,b&&Zj(a,b));return c};
k.Qa=function(a,b){var c=65535,d=Tj(a);-1!==d&&(c=a.La||65535<d?ad(this.G,$e(this.i,d)):bd(this.i,d),b&&Zj(a,b));return c};k.Od=function(a,b,c){var d=Tj(a);if(-1!==d){if(a.La||65535<d)vd(this.G,$e(this.i,d),b);else{var e=this.i;e.pa++;e.G.Md($c(e,d,5),b);e.pa--}c&&Zj(a,c);Xc(this.L,-1)}};k.Oe=function(a,b,c){var d=Tj(a);if(-1!==d){if(a.La||65535<d)Zc(this.G,$e(this.i,d),b);else{var e=this.i;e.pa++;e.G.Wb($c(e,d,4),b);e.pa--}c&&Zj(a,c);Xc(this.L,-1)}};
function Yj(a,b,c){c=(c?a.M:a.Fa).N;var d;if(void 0!==b){a:{var e=a.S[0];c=a.S[1];var f="("==e||"{"==e||"["==e?"\\":"";var g="["==e?"\\":"";for(g=new RegExp(f+e+"([^"+g+e+g+c+"]+)"+f+c);f=b.match(g);){var h=Lj(a,f[1]);if(void 0===h){b=void 0;break a}b=b.replace(e+f[1]+c,null!=h?G(a,h):"undefined")}if(a.ka.length)for(e=a.ka[0],c=a.ka[1],f="("==e||"{"==e||"["==e?"\\":"",g="["==e?"\\":"",g=new RegExp(f+e+"([^"+g+e+g+c+"]+)"+f+c);f=b.match(g);)b=b.replace("["+f[1]+"]","unimplemented");for(;e=b.match(/\$([a-z]+)/i);){c=
null;switch(e[1].toLowerCase()){case "ops":c=a.Ra}if(null==c)break;b=b.replace(e[0],c.toString())}}if("%"==b.charAt(0)){var l=!0;b=b.substr(1)}var m;a:{e=a.G;c=b.toUpperCase();for(n in e.Oa)if(f=+n,e.Oa[f][4]==c){var n=e.F+f;break a}n=null}if(null==n&&b.match(/^[a-z_][a-z0-9_]*$/i))for(e=b.toUpperCase(),c=0;c<a.F.length;c++)if(f=a.F[c].ia[e],null!=f){n=f.o;break}null!=n&&(m=V(n));if(e=m)return e;0<=b.indexOf("0x")?d=16:0<=b.indexOf("0o")?d=8:0<=b.indexOf(".")&&(d=10);c=Lj(a,b)}null!=c&&(e=V(c,l,d));
return e}function ak(a,b,c){c&&(c=c.match(/(['"])(.*?)\1/))&&(b.de=Cj(a,b.Jc=c[2]))}function Zj(a,b){null!=a.N&&(a.N+=b||1)}function bk(a,b){return(b.La?"%":"")+G(a,b.N)}
function Rj(a,b){a.H=a;a.ja=549755813888;a.Z=null;a.R=[];b=Cj(a,b.replace("keys","key").replace("kbd","keyboard"),!1,"|");if(b.length)for(var c in v){a:{var d=void 0;if(Array.prototype.indexOf)d=b.indexOf(c,d);else{d=d||0;0>d&&(d+=b.length);0>d&&(d=0);for(var e=b.length;d<e;d++)if(d in b&&b[d]===c)break a;d=-1}}0<=d&&(a.ja|=v[c],a.v("%s messages enabled\n",c))}}function Hd(a,b,c){for(var d in v)if(b==v[d]){a.pa[d]=c;break}}
k.me=function(a){a=a.toUpperCase();var b=ck[a];null==b&&(b=-1,"R"==a.charAt(0)&&(b=+a.charAt(1),0>b||7<b))&&(b=-1);return b};function dk(a,b){if(b<ek||a.j)var c=fk[b];return c||""}
k.wd=function(a){if(0<=a)if(8>a)var b=this.i.j[a];else if(16>a)b=this.i.sa[a-8];else if(20>a)b=this.i.aa[a-16];else{var c=this.i,d=this.j;switch(a){case gk:b=Qd(this.i);break;case hk:b=c.kb;break;case ik:b=c.S;break;case jk:b=c.xa&65280;break;case kk:b=Kd(c);break;case lk:b=Md(c);break;case mk:b=Nd(c);break;case nk:b=c.Z;break;case ek:d&&(b=d.ga);break;case ok:d&&(b=d.yb);break;case pk:d&&(b=d.Va)}}return b};
k.message=function(a,b){var c;if(b&1&&this.i){var d=" @"+bk(this,V(this.i.R&65535));a=a.replace(/(\n?)$/,d)}if(!this.Z||a!=this.Z)if(this.Z=a,this.ja&0x800000000000)this.R.push(a);else{if(this.ja&70368744177664&&this.i&&(c=this.i.flags.X)||Yb(this,!0))c&&(a=a.replace(/(\n?)$/," (cpu halted)$1")),qk(this);this.print(a,b);this.i&&(a=this.i,Fe(a),a.mb=0,a.L&&Xc(a.L))}};
function Qj(a){var b;if(!Ff(a))a.A&&a.A.length&&a.v("instruction history buffer freed\n"),a.W=0,a.A=[];else if(!a.A||!a.A.length){a.A=Array(rk);for(b=0;b<a.A.length;b++)a.A[b]=V();a.W=0;a.v("instruction history buffer allocated\n")}}function sk(a,b,c){if(!tk(a,c))return!1;Hc(a.i,b);return!0}
function Jc(a,b,c,d){if(!tk(a))return!1;var e="";null===c&&(e=(c=!a.wa||"tr"==a.wa)?"tr":"t");a.D=0;b||Ff(a)&&Gf(a,a.i.j[7],0);try{b=Ge(a.i,b);var f=a.i.xc(b);0<f&&(Kc(a.i,f),a.D+=f,Lc(a.i,f,!0),Wc(a.i,f),a.ba++)}catch(g){"number"!=typeof g&&(b=g,a.D=0,Vb(a.i,b.stack||b.message))}!1!==d&&(a.j&&a.j.stop(),Xc(a.L,-1));xe(a,c||!1,e);return 0<a.D}function qk(a,b){a.i&&Ic(a.i,b)}
function xe(a,b,c){if(a.Ga){void 0===b&&(b=!0);c&&a.v("%s%s\n",uk,c);c=a.i;if(c=c.u&128?c.vc|c.uc<<8:0){var d=c>>8;a.v("trapped to %s (%s)\n",G(a,c&255,8),0>d?fc[-d]:G(a,d))}a.M=V(a.i.j[7]);b&&1!=a.O?vk(a):wk(a)}}function tk(a,b){var c;(c=!a.i||!Xb(a.i))||(c=a.i,c.flags.da?c=!0:(c.v("%s not powered\n",c.toString()),c=!1),c=!c);return c||a.i.flags.X?(b||a.v("cpu busy or unavailable, command ignored\n"),!1):!Wb(a.i)}k.Ca=function(a,b){return!b&&(this.reset(!0),a)?this.restore(a):!0};
k.Ba=function(a,b){b&&this.v("%s\n",a?"suspending":"shutting down");return a?this.save():!0};k.reset=function(a){Qj(this);this.ba=0;this.Z=null;this.D=0;this.M=V(this.i.j[7]);this.flags.X=!1;xk(this);a||xe(this)};k.save=function(){var a=new xc(this);a.set(0,Uj(this.M));a.set(1,Uj(this.T));a.set(2,[this.B,this.U,this.ja]);a.set(3,this.F);return a.data()};
k.restore=function(a){var b=0;void 0!==a[2]&&(this.M=Vj(this,a[b++]),this.T=Vj(this,a[b++]),this.B=a[b][0],"string"==typeof this.B&&(this.B=[this.B]),this.U=a[b][1],this.ja|=a[b][2]);a[3]&&(this.F=a[3]);return!0};k.start=function(a,b){this.O||this.v("running\n");this.flags.X=!0;this.Ha=a;this.Ia=b};
k.stop=function(a,b){if(this.flags.X){this.flags.X=!1;this.D=b-this.Ia;if(!this.O){b="stopped";if(this.D){a-=this.Ha;var c=0<a?Math.round(1E3*this.D/a):0;b+=" (";Ff(this)&&(b+=this.ba+" instructions, ",this.ba=0);b+=this.D+" cycles, "+a+" ms, "+c+" hz)"}else ec(this,70368744177664)&&(b+=" (use the 't' command to execute blocked faults)");this.v("%s\n",b)}xe(this,!0);ye(this);xk(this,this.i.j[7]);this.Z=null}};function Ff(a){return 1<a.g.length||!!a.ha}
function Gf(a,b,c){var d=-1;c||(d=bd(a.i,b),0==d&&(a.i.R&65535)==b&&(b=Re(a.i,2)));if(0<c&&(a.ha&&!--a.ha||yk(a,b,1,a.g)))return!0;0<=c&&a.A.length&&(a.ba++,0>d&&(d=bd(a.i,b)),65535!=(d&65535)&&(a.Cd(a.A[a.W],b),++a.W==a.A.length&&(a.W=0)));return!1}function Lg(a){var b=a.i;if(b.flags.X)throw Ec(b,a.i.R&65535),qk(a),-1;return!1}function pe(a,b,c){yk(a,b,c||1,a.P)&&qk(a,!1)}function qe(a,b,c){yk(a,b,c||1,a.K)&&qk(a,!1)}
function Pj(a){var b;a.g=["bp"];if(void 0!==a.P)for(b=1;b<a.P.length;b++){var c=a.P[b];var d=Tj(c);c.La?(c=a.G,oe(c.g[d>>>c.j],!1)):cf(a.i,!1)}a.P=["br"];if(void 0!==a.K)for(b=1;b<a.K.length;b++)c=a.K[b],d=Tj(c),c.La?(c=a.G,oe(c.g[d>>>c.j],!0)):cf(a.i,!0);a.K=["bw"];a.ra=0;a.ha=0}
k.vb=function(a,b,c){var d=!0;c||zk(this,a,b,!1,!0);if(a!=this.g){var e=Tj(b);if(-1===e)this.v("invalid address: %s\n",bk(this,b)),d=!1;else{var f=a==this.K;65535<e&&(b.La=!0);if(b.La){var g=this.G;g.g[e>>>g.j].vb(e&g.A,f)}else e=this.i,(f?e.lc++:e.kc++)||Le(e)}}d&&(a.push(b),c?b.Ta=!0:(Ak(this,a,a.length-1,"set"),Qj(this)))};
function zk(a,b,c,d,e){var f=!1;c=Tj(c);for(var g=1;g<b.length;g++){var h=b[g];if(c==Tj(h)&&(!d||h.Ta)){f=!0;h.Ta||e||Ak(a,b,g,"cleared");b.splice(g,1);b!=a.g&&(b=b==a.K,h.La?(d=a.G,oe(d.g[c>>>d.j],b)):cf(a.i,b));h.Ta||Qj(a);break}}return f}function Bk(a,b){for(var c=1;c<b.length;c++)Ak(a,b,c);return b.length-1}function Ak(a,b,c,d){c=b[c];a.v("%s %s%s\n",b[0],bk(a,c),d?" "+d:c.Jc?' "'+c.Jc+'"':"")}
function xk(a,b){if(void 0!==b)yk(a,b,1,a.g,!0),a.O=0;else for(b=1;b<a.g.length;b++){var c=a.g[b];if(c.Ta){if(!zk(a,a.g,c,!0))break;b=0}}}
function yk(a,b,c,d,e){var f=!1;if(!a.ra++)for(var g=1;!f&&g<d.length;g++){var h=d[g];if(!e||h.Ta)for(var l=Tj(h)&(d==a.g?65535:-1),m=0;m<c;m++)if(b+m==l){var n;f=!0;h.Ta&&(zk(a,d,h,!0),e=!0);if(n=h.de){f=!1;for(var p=0;p<n.length;p++)if(!Ck(a,n[p],!0)){if(n[p].indexOf("if")){f=!0;break}for(var q=p+1;q<n.length&&n[q].indexOf("else");q++)p++;if(q==n.length){f=!0;break}}a.i.flags.X||(f=!0)}if(f){e||Ak(a,d,g,"hit");break}}}a.ra--;return f}
function Dk(a,b,c,d){var e=V(b.N),f=a.Qa(b,2),g,h;for(h in a.Ja)if(g=a.Ja[h][f&h])break;g||(g=Ek);var l=g[0];0<=a.aa.indexOf(l)&&(g=Ek,l=g[0]);var m=h="",n=Fk[l],p=g.length-1;l||p||(h=G(a,f));for(l=1;l<=p;l++){var q=g[l];if(void 0!==q){var r=a;var w=q;q=b;var B="";var z=w&Gk;if(z==X)q=q.N+((f&255)<<24>>23)&65535,B=G(r,q);else if(z==Hk)q=q.N-((f&63)<<1)&65535,B=G(r,q);else if(z==Ik)B=G(r,f&7,3);else if(z==Jk)B=G(r,f&63,6);else if(z==Kk)B=G(r,f&255,8);else if(z=f&w,w&Lk&&(z>>=6,w>>=6),w&Z){w=null;var x=
z&Mk;switch(z&Nk){case 0:B=dk(r,x);break;case 8:B="@"+dk(r,x);w=Ok(r,r.i.j[x]);break;case 16:7>x?B="("+dk(r,x)+")+":(z=r.Qa(q,2),B="#"+G(r,z,-1));break;case 24:7>x?B="@("+dk(r,x)+")+":(z=r.Qa(q,2),B="@#"+G(r,z,-1),w=Ok(r,z));break;case 32:B="-("+dk(r,x)+")";break;case 40:B="@-("+dk(r,x)+")";break;case 48:z=r.Qa(q,2);B=G(r,z,-1)+"("+dk(r,x)+")";7==x&&(B=G(r,z=z+q.N&65535),w=Ok(r,z));break;case 56:z=r.Qa(q,2),B="@"+G(r,z)+"("+dk(r,x)+")",7==x&&(B="@"+G(r,z=z+q.N&65535),w=Ok(r,bd(r.i,z)))}w&&(B=[B,w])}r=
B;if(!r||!r.length){h="INVALID";break}"string"!=typeof r&&(m=r[1],r=r[0]);0<h.length&&(h+=",");h+=r||"???"}}f="";g=bk(a,e)+":";if(-1!==e.N&&-1!==b.N){do if(f+=" "+G(a,a.Qa(e,2)),null==e.N)break;while(e.N!=b.N)}g+=Ua(f,24);g+=Ua(n,5);h&&(g+=" "+h);if(c||m)g=Ua(g,60)+";"+(c||""),g=a.i.flags.Hb?g+("cycles="+Ae(a.i).toString()+" cs="+Ma(a.i.hc)):g+(null!=d?"="+d.toString():""),m&&(";"!=g.slice(-1)&&(g+=" "),g+=m);return g}
function Ok(a,b){b=af(a.i,b)[0];b>=a.i.pb&&b<a.G.F&&(b=b-a.i.pb+a.G.F);var c=a.G;a=null;b>=c.F&&(b=c.Oa[b&zd])&&(a=b[4]);return a}function Pk(a,b){switch(b){case "N":a=Qe(a.i);break;case "Z":a=Pe(a.i);break;case "V":a=Oe(a.i);break;case "C":a=Ne(a.i);break;default:a=0}return b.charAt(0)+(a?"1":"0")+" "}function Qk(a,b){var c=dk(a,b);c&&(c+="="+G(a,a.wd(b))+" ");return c}k.he=function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0};
function Lh(a,b,c,d,e){var f=[],g;for(g in e){var h=e[g];"number"==typeof h&&(e[g]=h={o:h});var l=h.o,m=h.a;if(void 0!==l){var n=f;l=[l>>>0,g];var p=Za(n,l,a.he);0>p&&n.splice(-(p+1),0,l)}m&&(h.a=m.replace(/''/g,'"'))}a.F.push({Ek:b,N:c,Hf:d,ia:e,ee:f})}function Rk(a,b,c){var d=[],e=Tj(b)>>>0;for(b=0;b<a.F.length;b++){var f=a.F[b],g=f.N>>>0,h=f.Hf;if(e>=g&&e<g+h){e=Za(f.ee,[e-g],a.he);0<=e?Sk(a,b,e,d):c&&(e=~e,Sk(a,b,e-1,d),Sk(a,b,e,d));break}}return d}
function Sk(a,b,c,d){var e={},f=a.F[b].ee,g=0,h=null;0<=c&&c<f.length&&(g=f[c][0],h=f[c][1]);h&&(e=a.F[b].ia[h],h="."==h.charAt(0)?null:e.l||h);d.push(h);d.push(g);d.push(e.a);d.push(e.c)}function Tk(a,b){var c=b.match(/^\s*([A-Z_]?[A-Z0-9_]*)\s*(=?)\s*(.*)$/i);if(c){if(!c[1])return Nj(a)||a.v("no variables\n"),!0;if(!c[2])return Nj(a,c[1]);if(!c[3])return delete a.u[c[1]],!0;b=Lj(a,c[3]);return void 0!==b?(a.u[c[1]]={value:b,dh:void 0},!0):!1}a.v("invalid assignment: %s\n",b);return!1}
function Uk(a,b,c){var d=null;if(b=Yj(a,b,!0)){var e=Rk(a,b,!0);if(e.length){var f;if(e[0]){var g="";(f=b.N-e[1])&&(g=" + "+Ma(f,4,!0));f=e[0]+" ("+G(a,e[1])+")"+g;c&&a.v("%s\n",f);d=f}4<e.length&&e[4]&&(g="",(f=e[5]-b.N)&&(g=" - "+Ma(f,4,!0)),f=e[4]+" ("+G(a,e[5])+")"+g,c&&a.v("%s\n",f),d||(d=f))}else c&&a.v("no symbols\n")}return d}
function vk(a,b){var c;if(b&&"?"==b[1])a.v("register commands:\n"),a.v("\tr\tdump registers\n"),a.v("\trm\tdump misc registers\n"),a.v("\trx [#]\tset flag or register x to [#]\n");else{var d=!1,e=a.i;null==c&&(c=!0);if(null!=b&&1<b.length){var f=b[1];if("m"==f)d=!0;else{var g=f.indexOf("=");if(0<g)b=f.substr(g+1),f=f.substr(0,g);else if(2<b.length)b=b[2];else{a.v("missing value for %s\n",b[1]);return}g=Lj(a,b);if(void 0===g)return;b=f.toUpperCase();switch(b){case "SP":case "R6":e.j[6]=g&65535;break;
case "PC":case "R7":Ec(e,g);a.M=V(e.j[7]);break;case "N":e.K=g?32768:0;break;case "Z":e.M=g?0:1;break;case "V":e.I=g?32768:0;break;case "C":e.F=g?65536:0;break;case "PS":$d(e,g);break;case "PI":Pd(e,g);break;case "ER":e.S=g;d=!0;break;case "SL":e.xa=g|255;break;case "M0":Ld(e,g);d=!0;break;case "M3":Od(e,g);d=!0;break;case "AR":a.j&&(d=a.j,yc(d,d.ga=g));d=!0;break;case "DR":a.j&&nc(a.j,g);d=!0;break;case "SR":a.j&&zc(a.j,g);d=!0;break;default:if("R"==b.charAt(0)&&(b=+b.charAt(1),0<=b&&6>b)){e.j[b]=
g&65535;break}a.v("unknown register: %s\n",f);return}Xc(a.L);a.v("updated registers:\n")}}f=a.v;b="";for(g=0;6>g;g++)b+=Qk(a,g);b=b+"\n"+(Qk(a,6)+Qk(a,7));b+=Qk(a,gk)+Qk(a,hk)+Qk(a,jk);b+=Pk(a,"T")+Pk(a,"N")+Pk(a,"Z")+Pk(a,"V")+Pk(a,"C");d&&(d=b,g=Qk(a,kk)+Qk(a,lk),g+=Qk(a,mk)+Qk(a,nk)+Qk(a,ik),g=g+"\n"+(Qk(a,pk)+Qk(a,ek)+Qk(a,ok)),b=d+("\n"+g));f.call(a,"%s\n",b);c&&(a.M=V(e.j[7]),wk(a,bk(a,a.M)))}}
function Vk(a,b){b=Va(b);var c=b.match(/^(['"])(.*?)\1$/);c?1<c[2].length?a.v("%s\n",c[2]):Mj(a,null,c[2].charCodeAt(0)):Lj(a,b,!1)}
function Wk(a,b,c){if("?"==c)a.v("trace commands:\n"),a.v("\tt  [#]\ttrace # instructions\n"),a.v("\ttr [#]\ttrace # instructions with register updates\n"),a.v("\ttc [#]\ttrace # cycles\n"),a.v("note: bn [#] breaks after # instructions without updates\n");else{var d="t"!=b;c=Gj(a,c,void 0,!0)||1;var e=0;"tc"==b&&(e=c,c=1);a.wa=b;qb(c,function(){return Zb(a,!0)&&Jc(a,e,d,!1)},function(){a.j&&a.j.stop();Xc(a.L,-1);Zb(a,!1)})}}
function wk(a,b,c,d){if(b=Yj(a,b,!0)){void 0===d&&(d=1);var e=256;if(void 0!==c)if("l"==c.charAt(0))c=Gj(a,c.substr(1)),null!=c&&(d=c);else{d=Yj(a,c,!0);if(!d||d.N<b.N)return;e=d.N-b.N;if(256<e){a.v("range too large\n");return}d=-1}c=0;for(var f;0<e&&d--;){f=Yb(a,!1)||a.O?a.D:null;var g=null!=f?"cycles":null,h=Rk(a,b),l=b.N;if(h[0]&&d&&(!c&&d||0>h[0].indexOf("+"))){var m=h[0]+":";h[2]&&(m+=" "+h[2]);a.v("%s\n",m)}h[3]&&(g=h[3],f=null);f=Dk(a,b,g,f);a.v("%s\n",f);a.M=b;e-=b.N-l;c++}}}
function Ck(a,b,c){var d=!0;try{b.length&&"end"!=b?c||a.v("%s%s\n",uk,b):(a.U&&(a.v("ended assemble at %s\n",bk(a,a.T)),a.M=a.T,a.U=!1),b="");var e=b.charAt(0);if('"'==e||"'"==e)return!0;a.Z=null;if(Xb(a)&&0<b.length){a.U&&(b="a "+bk(a,a.T)+" "+b);var f=!1,g=b.replace(/ +/g," ").split(" ");g[0]=g[0].toLowerCase();if(g&&g.length)for(var h=g[0],l=h.charAt(0),m=1;m<h.length;m++){var n=h.charAt(m);if("?"==l||"r"==l||"a">n||"z"<n){g[0]=h.substr(m);g.unshift(h.substr(0,m));break}}switch(g[0].charAt(0)){case "a":var p=
Yj(a,g[1],!0);if(p)if(a.T=p,void 0===g[2])a.v("begin assemble at %s\n",bk(a,p)),a.U=!0,Xc(a.L);else{a.v("not supported yet\n");var q=[];if(q.length){for(var r=0;r<q.length;r++)a.Od(p,q[r],1);a.v("%s\n",Dk(a,a.T))}}break;case "b":a:{var w=g[0],B=g[1],z=b;if("?"==B)a.v("breakpoint commands:\n"),a.v("\tbp #\tset exec breakpoint\n"),a.v("\tbr #\tset read breakpoint\n"),a.v("\tbw #\tset write breakpoint\n"),a.v("\tbc #\tclear breakpoint (* to clear all)\n"),a.v("\tbl\tlist all breakpoints\n"),a.v("\tbn [#]\tbreak after # instruction(s)\n");
else{var x=w.charAt(1);if("l"==x){var W=Bk(a,a.g);W+=Bk(a,a.P);(W+=Bk(a,a.K))||a.v("no breakpoints\n")}else if("n"==x){var oa=+B||0;B&&(a.ha=oa);a.v("break after %d instruction(s)\n",oa)}else if(void 0===B)a.v("missing breakpoint address\n");else{var I=V();if("*"!=B&&(I=Yj(a,B,!0),!I))break a;"c"==x?null==I.N?(Pj(a),a.v("all breakpoints cleared\n")):zk(a,a.g,I)||zk(a,a.P,I)||zk(a,a.K,I)||a.v("breakpoint missing: %s\n",bk(a,I)):null!=I.N&&(ak(a,I,z),"p"==x?a.vb(a.g,I):"r"==x?a.vb(a.P,I):"w"==x?a.vb(a.K,
I):a.v("unknown breakpoint command: %s\n",x))}}}break;case "c":var Oa=a.L;Oa.C&&(Oa.C.value="");break;case "d":a:{var Y,ua=g[0],va=g[1],rb=g[2],ul=g[3];if("?"==va){var ac="";for(Y in v)a.pa[Y]&&(ac&&(ac+=","),ac+=Y);ac+=",state,symbols";a.v("dump memory commands:\n");a.v("\tda [a]        dump info for address a\n");a.v("\tdb [a] [n]    dump n bytes at address a\n");a.v("\tdw [a] [n]    dump n words at address a\n");a.v("\tdd [a] [n]    dump n dwords at address a\n");a.v("\tds [a] [n]    dump n words at address a as JSON\n");
a.v("\tdh [p] [n]    dump n instructions from history position p\n");ac.length&&a.v("dump extension commands:\n\t%s\n",ac)}else if("state"==va){var hf=Xk(a.L,!0);if("console"==rb)console.log(hf);else{var zi=a.L;zi.C&&(zi.C.value="");hf&&a.v("%s\n",hf)}}else if("symbols"==va)for(var jf=0;jf<a.F.length;jf++){var kf=a.F[jf],bc;for(bc in kf.ia)if("."!=bc.charAt(0)){var Ai=kf.ia[bc].o;if(void 0!==Ai){var Bi=kf.ia[bc].l;Bi&&(bc=Bi);a.v("%s %s\n",G(a,Ai),bc)}}}else{if("d"==ua){for(Y in v)if(g[1]==Y){var Ci=
a.pa[Y];Ci?(g.shift(),g.shift(),Ci(g)):a.v("no dump registered for %s\n",va);break a}va||(ua=a.Na||"dw")}else a.Na=ua;if("dh"==ua){var Di=va,Ei=rb,Fi="",Gi=0,Pa=a.W,cb=a.A;if(cb.length){var Ia=+Di||a.sa,Mc=+Ei||10;isNaN(Ia)?Ia=Mc:Fi="more ";Ia>cb.length&&(a.v("note: only %d available\n",cb.length),Ia=cb.length);Pa-=Ia;0>Pa&&(null==cb[cb.length-1].N?(Ia=Pa+Ia,Pa=0):Pa+=cb.length);var lf=[];"call"==Ei&&(Mc=1E5,lf=["CALL"]);for(void 0!==Di&&a.v("%d instructions earlier:\n",Ia);0<Mc&&Pa!=a.W;){var Hi=
cb[Pa++];if(null==Hi.N)break;var Nc=V(Hi.N),vl=Ia--,Ii=Dk(a,Nc,"history",vl);(!lf.length||0<=Ii.indexOf(lf[0]))&&a.v("%s\n",Ii);Nc.td&&(Pa+=Nc.td,Mc-=Nc.td,Ia-=Nc.td);Pa>=cb.length&&(Pa=0);a.sa=Ia;Gi++;Mc--}}Gi||(a.v("no %shistory available\n",Fi),a.sa=void 0)}else{var wa=Yj(a,va);if(wa)if("da"==ua){var mf=wa.La||65535<wa.N,M=af(a.i,wa.N||0,mf);a.v("%s%s  %08o\n",Ua("",mf?12:19),Ja(wa.N,mf?22:17,3),wa.N);6>M.length?(2<M.length&&(a.v("    OFFSET:             %s  %08o\n",Ja(M[3],13,3),M[3]),a.v("UNIMAP[%s]: %s  %08o\n",
La(M[1],2),Ja(M[2],22,3),M[2])),a.v("  PHYSICAL: %s  %08o\n",Ja(M[0],22,3),M[0])):(a.v("    OFFSET:             %s  %08o\n",Ja(M[1],13,3),M[1]),a.v("+   %sPAR%s: %s  %08o\n",Yk[M[2]],M[3],Ja(M[4],22,3),M[4]),a.v("&  MMUMASK: %s  %08o\n",Ja(M[5],22,3),M[5]),a.v("= PHYSICAL: %s  %08o\n",Ja(M[0],22,3),M[0]))}else{var Bb=0,nf="ds"==ua;if(rb){if("l"==rb.charAt(0))rb=rb.substr(1)||ul,Bb=Gj(a,rb);else{var Ji=Yj(a,rb);Ji&&(Bb=Ji.N-wa.N)}0>Bb&&(Bb=0);65536<Bb&&(Bb=65536)}var xl=a.Y;wa.Y&&(a.Y=wa.Y);for(var Cb=
"dd"==ua?4:"db"==ua?1:2,Rd=Cb*Bb||128,of=nf?16:a.Y,yl=(Rd+of-1)/of|0||1,Db="";yl--&&0<Rd;){var Eb="",Ki="";va=bk(a,wa);for(var Sd=of,Td=0,Ud=0;0<Sd&&0<Rd;){var cc=1,pf=1==Cb?a.Nd(wa,cc):a.Qa(wa,cc=2);Td|=pf<<(Ud<<3);Ud+=cc;Ud==Cb&&(nf?(Eb&&(Eb+=","),Eb+="0x"+Ma(Td,Cb<<1)):(Eb+=G(a,Td,Cb<<3),Eb+=1==Cb?9==Sd?"-":" ":"  "),Td=Ud=0);Sd-=cc;for(Rd-=cc;1==Cb&&cc--;){var qf=pf&255;Ki+=32<=qf&&127>qf?String.fromCharCode(qf):".";pf>>=8}}Db&&(Db+="\n");Db=nf?Db+(Eb+","):Db+(va+":  "+Eb+(0==Sd?" "+Ki:""))}Db&&
a.v("%s\n",Db);a.Fa=wa;a.Y=xl}}}}break;case "e":if("else"==g[0])break;var rf=g[0],sf=g[1];if("eb"==rf){var Oc=1;var Li=255;var Mi=a.Nd;var Ni=a.Od}else"e"==rf||"ew"==rf?(Oc=2,Li=65535,Mi=a.Qa,Ni=a.Oe):sf=null;if(null==sf)a.v("edit memory commands:\n"),a.v("\teb [a] [...]  edit bytes at address a\n"),a.v("\tew [a] [...]  edit words at address a\n");else{var Vd=Yj(a,sf);if(Vd)for(var Wd=2;Wd<g.length;Wd++){var Pc=Lj(a,g[Wd]);if(void 0===Pc){a.v("unrecognized value: %s\n",g[Wd]);break}Pc&~Li&&a.v("warning: %x exceeds %s-byte value\n",
Pc,Oc);a.v("changing %s%s to %s\n",bk(a,Vd),ec(a,32)?"":" from "+G(a,Mi.call(a,Vd),Oc<<3),G(a,Pc,Oc<<3));Ni.call(a,Vd,Pc,Oc)}}break;case "g":a:{var Oi=g[1],zl=b;if(void 0!==Oi){var tf=Yj(a,Oi,!0);if(!tf)break a;ak(a,tf,zl);a.vb(a.g,tf,!0)}sk(a,!0,c)}break;case "h":a.flags.X?(c||a.v("halting\n"),qk(a)):Yb(a,!0)||c||a.v("already halted\n");break;case "i":if("if"==g[0]){var Qc=b.substr(2);Qc=Va(Qc);if(Lj(a,Qc)){c||a.v("true: %s\n",Qc);var Pi=!0}else c||a.v("false: %s\n",Qc),Pi=!1;Pi||(d=!1);break}f=
!0;break;case "k":var Al=g[0];if("?"==g[1])a.v("stack trace commands:\n"),a.v("\tk\tshow frame addresses\n"),a.v("\tks\tshow symbol information\n");else{var uf=0,vf=V(),Rc=V(a.i.j[6]);for(a.v("stack trace for %s\n",bk(a,Rc));10>uf;){for(var Fb=null,Bl=256;65536>Rc.N>>>0;){vf.N=a.Qa(Rc,2);if(null==Rc.N||!Bl--)break;if(!(vf.N&1)){for(var Cl=a,Xd=vf,Qi=null,Sc=Xd.N,Ri=Sc,wf=1;6>=wf&&Sc;wf++){if(2<wf){Xd.N=Sc;var Yd=Dk(Cl,Xd);if(0<=Yd.indexOf("JSR")){var Si=Yd.indexOf(" ");if(Sc+(Yd.indexOf(" ",Si+1)-
Si-1)/2==Ri){Qi=Yd;break}}}Sc-=2}Xd.N=Ri;if(Fb=Qi)break}}if(!Fb||null==Fb)break;var Ti=null;if("ks"==Al){var Ui=Fb.match(/[0-9A-F]+$/);Ui&&(Ti=Uk(a,Ui[0]))}Fb=Ua(Fb,50)+"  ;"+(Ti||"stack="+bk(a,Rc));a.v("%s\n",Fb);uf++}uf||a.v("no return addresses found\n")}break;case "l":if("ln"==g[0]){Uk(a,g[1],!0);break}f=!0;break;case "m":a:{var db,eb=null,S=g[1];"?"==S&&(S=void 0);if(void 0!==S){var sb=0;if("all"==S)sb=-4097,S=null;else if("on"==S)eb=!0,S=null;else if("off"==S)eb=!1,S=null;else{"keys"==S&&(S=
"key");"kbd"==S&&(S="keyboard");for(db in v)if(S==db){sb=v[db];eb=!!(a.ja&sb);break}if(!sb){a.v("unknown message category: %s\n",S);break a}}if(sb)if("on"==g[2])a.ja|=sb,eb=!0;else if("off"==g[2]&&(a.ja&=~sb,eb=!1,0x800000000000==sb)){for(var Vi=1E3<=a.R.length?a.R.length-1E3:0;Vi<a.R.length;)a.v("%s\n",a.R[Vi++]);a.R=[]}}var Dl=0,Tc="";for(db in v)if(!S||S==db){var El=!!(a.ja&v[db]);if(null===eb||eb==El)Tc&&(Tc+=","),++Dl%10||(Tc+="\n\t"),"key"==db&&(db="keys"),Tc+=db}void 0===S&&a.v("message commands:\n\tm [category] [on|off]\tturn categories on/off\n");
a.v("%s%s\n",null!==eb?eb?"messages on:  ":"messages off: ":"message categories:\n\t",Tc||"none");Qj(a)}break;case "p":if("print"==g[0]){Vk(a,b.substr(5));break}var Fl=g[0];if("?"==g[1])a.v("step commands:\n"),a.v("\tp\tstep over instruction\n"),a.v("\tpr\tstep over instruction with register update\n");else{var Wi="pr"==Fl?1:0,Xi=1+Wi;if(a.O)a.v("step in progress\n");else{var Zd=V(a.i.j[7]),dc=a.Qa(Zd);3==dc||4==dc||34816==(dc&65280)||32256==(dc&65024)||35072==(dc&65280)?(a.O=Xi,Zj(Zd,2)):2048==(dc&
65024)&&(Dk(a,Zd),a.O=Xi);a.O?(a.vb(a.g,Zd,!0),sk(a)||(a.L&&Ee(a.L),a.O=0)):Wk(a,Wi?"tr":"t")}}break;case "r":if("reset"==b){a.L&&a.L.reset();break}vk(a,g);break;case "s":a:switch(g[1]){case "base":if(g[2]){var Uc=+g[2];if(8==Uc||10==Uc||16==Uc)a.Y=Uc;else{a.v("invalid base: %d\n",Uc);break}}a.v("default base: %d\n",a.Y);break;case "cs":var Vc;void 0!==g[3]&&(Vc=+g[3]);switch(g[2]){case "int":a.i.Fb=Vc;break;case "start":a.i.ic=Vc;break;case "stop":a.i.Ib=Vc;break;default:a.v("unknown cs option\n");
break a}void 0!==Vc&&we(a.i);a.v("checksums %s\n",a.i.flags.Hb?"enabled":"disabled");break;case "sp":void 0!==g[2]&&(Be(a.i,+g[2])||a.v("warning: using 1x multiplier, previous target not reached\n"));a.v("target speed: %s (%dx)\n",a.i.rb.toFixed(2)+"Mhz",a.i.ib);break;default:if(g[1]){a.v("unknown option: %s\n",g[1]);break}case "?":a.v("debugger options:\n"),a.v("\tbase #\t\tset default base to #\n"),a.v("\tcs int #\tset checksum cycle interval to #\n"),a.v("\tcs start #\tset checksum cycle start count to #\n"),
a.v("\tcs stop #\tset checksum cycle stop count to #\n"),a.v("\tsp #\t\tset speed multiplier to #\n")}break;case "t":Wk(a,g[0],g[1]);break;case "u":wk(a,g[1],g[2],8);break;case "v":if("var"==g[0]){Tk(a,b.substr(3))||(d=!1);break}if("ver"==g[0]){a.v("%s version %s (%s%s%s)\n","PDPjs","2.20",a.i.model,kc.zi?",RELEASE":kc.bj?",DEBUG":",NODEBUG",kc.dk?",TYPEDARRAYS":kc.wi?",BYTEARRAYS":",LONGARRAYS");a.v("%s\n",y.navigator?y.navigator.userAgent:"");break}f=!0;break;case "?":if(g[1]){Vk(a,b.substr(1));
break}var xf="commands:",yf;for(yf in Zk)xf+="\n"+Ua(yf,9)+Zk[yf];Ff(a)||(xf+="\nnote: history disabled if no exec breakpoints");a.v("%s\n",xf);break;default:f=!0}f&&(a.v("unknown command: %s\n",b),d=!1)}}catch(Zi){a.v("debugger error: %s\n",Zi.stack||Zi.message),d=!1}return d}function ze(a,b,c){b=Cj(a,b,c);for(var d in b)if(!Ck(a,b[+d]))return!1;return!0}
var Zk={"?":"help/print","a [#]":"assemble","b [#]":"breakpoint",c:"clear output","d [#]":"dump memory","e [#]":"edit memory","g [#]":"go [to #]",h:"halt","if":"eval expression","int [#]":"request interrupt",k:"stack trace",ln:"list nearest symbol(s)",m:"messages",p:"step over",print:"print expression",r:"dump/set registers",reset:"reset machine",s:"set options","t [#]":"trace","u [#]":"unassemble","var":"assign variable",ver:"print version"},Fk=".WORD ADC ADCB ADD ASL ASLB ASR ASRB BCC BCS BEQ BGE BGT BHI BIC BICB BIS BISB BIT BITB BLE BLOS BLT BMI BNE BPL BPT BR BVC BVS CCC CLC CLCN CLCV CLCVN CLCVZ CLCZ CLCZN CLN CLR CLRB CLV CLVN CLVZ CLVZN CLZ CLZN CMP CMPB COM COMB DEC DECB INC INCB HALT JMP JSR MARK MFPD MFPI MFPS MOV MOVB MTPD MTPI MTPS NEG NEGB NOP RESET ROL ROLB ROR RORB RTI RTS SBC SBCB SCC SEC SECN SECV SECVN SECVZ SECZ SECZN SEN SEV SEVN SEVZ SEVZN SEZ SEZN SUB SWAB SXT TST TSTB WAIT MUL DIV ASH ASHC XOR SOB EMT TRAP SPL IOT RTT MFPT".split(" "),
gk=20,hk=21,ik=22,jk=23,kk=24,lk=25,mk=26,nk=27,ek=28,ok=29,pk=30,ck={SP:6,PC:7,PS:gk,PI:hk,ER:ik,SL:jk,M0:kk,M1:lk,M2:mk,M3:nk,AR:ek,DR:ok,SR:pk},fk="R0 R1 R2 R3 R4 R5 SP PC A0 A1 A2 A3 A4 A5 A6 A7 S0 S1 S2 S3 PS PI ER SL M0 M1 M2 M3 AR DR SR".split(" "),Yk="KI KD SI SD ?? ?? UI UD".split(" "),Mk=7,Nk=56,Z=Nk|Mk,Lk=4032,X=4096,Hk=8192,Ik=12288,Jk=24576,Kk=32768,Gk=61440,Sj={61440:{4096:[62,Lk,Z],8192:[47,Lk,Z],12288:[18,Lk,Z],16384:[14,Lk,Z],20480:[16,Lk,Z],24576:[3,Lk,Z],36864:[63,Lk,Z],40960:[48,
Lk,Z],45056:[19,Lk,Z],49152:[15,Lk,Z],53248:[17,Lk,Z],57344:[94,Lk,Z]},65024:{2048:[57,448,Z],28672:[100,Z,448],29184:[101,Z,448],29696:[102,Z,448],30208:[103,Z,448],30720:[104,448,Z],32256:[105,448,Hk]},65280:{256:[27,X],512:[24,X],768:[10,X],1024:[11,X],1280:[22,X],1536:[12,X],1792:[20,X],32768:[25,X],33024:[23,X],33280:[13,X],33536:[21,X],33792:[28,X],34048:[29,X],34304:[8,X],34560:[9,X],34816:[106,Kk],35072:[107,Kk]},65472:{64:[56,Z],192:[95,Z],2560:[39,Z],2624:[49,Z],2688:[53,Z],2752:[51,Z],
2816:[67,Z],2880:[1,Z],2944:[77,Z],3008:[97,Z],3072:[73,Z],3136:[71,Z],3200:[6,Z],3264:[4,Z],3328:[58,Jk],3392:[60,Z],3456:[65,Z],3520:[96,Z],35328:[40,Z],35392:[50,Z],35456:[54,Z],35520:[52,Z],35584:[68,Z],35648:[2,Z],35712:[78,Z],35776:[98,Z],35840:[74,Z],35904:[72,Z],35968:[7,Z],36032:[5,Z],36096:[66,Z],36160:[59,Z],36224:[64,Z],36288:[61,Z]},65528:{128:[76,Mk],152:[108,Ik]},65535:{0:[55],1:[99],2:[75],3:[26],4:[109],5:[70],6:[110],7:[111],160:[69],161:[31],162:[41],163:[33],164:[45],165:[36],
166:[43],167:[35],168:[38],169:[32],170:[42],171:[34],172:[46],173:[37],174:[44],175:[30],176:[69],177:[80],178:[88],179:[82],180:[92],181:[85],182:[90],183:[84],184:[87],185:[81],186:[89],187:[83],188:[93],189:[86],190:[91],191:[79]}},Ek=[0],Wj=[58,60,65,96,110,100,101,102,103,104,105],Xj=[108,59,64],rk=1E3,uk=">> ";vb(function(){for(var a=Mb("pdp11","debugger"),b=0;b<a.length;b++){var c=a[b],d=Nb(c);d=new Oj(d);Lb(d,c)}});
function $k(a,b,c){E.call(this,"Computer",a,67108864);this.flags.da=!1;this.S=null;al(this,b);this.O=ue(this,"autoPower",a,6);this.A=0;this.W=+a.busWidth||+a.buswidth;this.K=this.D=this.M=null;this.I=this.U=!1;this.F=this.B=null;this.T=this.P=this.R=!1;this.url=ue(this,"url")||"";(Math.random()+.1).toString(36);this.j=bl(this);if(this.i=Qb("CPU",this.id)){this.H=Qb("Debugger",this.id);this.G=new fd({id:this.fb+".bus",busWidth:this.W},this.i,this.H);var d=Ob(this.id);if(this.C=(this.u=Qb("Panel",this.id))&&
this.u.J.print)for(b=0;b<d.length;b++){var e=d[b];e.print=this.u.print;e.V=this.u.V}this.v(0,"%s v%s\n%s\n%s\n","PDPjs","2.20","Copyright \u00a9 2012-2023 Jeff Parsons <Jeff@pcjs.org>","License: MIT <https://www.pcjs.org/LICENSE.txt>");this.v(0,"Portions adapted from the PDP-11/70 Emulator by Paul Nankervis <http://skn.noip.me/pdp11/pdp11.html>\n");for(b=0;b<d.length;b++)e=d[b],e.Aa&&e.Aa(this,this.G,this.i,this.H);b=null;e=ue(this,"resume",a);void 0!==e&&(1<e.length?b=this.D=e:this.g=parseInt(e,
10));e=!1;d=ue(this,"state");d||(e=!0,d=a.state);d&&(this.M=b=d,e||(this.I=!0,this.g=cl),this.g&&(this.F=new xc(this,"2.20"),this.F.load()?b=null:delete this.F));!b&&this.g&&(b=dl(this))&&(this.I=!0);if(b){var f=this;$a(b,null,!0,function(g,h,l){l?(f.D=null,f.I=!1,f.V("Unable to load machine state from server (error "+l+(h?": "+Va(h):"")+")")):(f.K=h,f.U=!0);F(f)})}else F(this);this.J.power||(this.O=!0);!c&&this.O&&this.wait(this.mc)}else D("Unable to find CPU component")}u($k,E);
function al(a,b){if(!b){var c,d=y.resources;if("object"==typeof d&&(c=d.parms))try{b=eval("("+c+")")}catch(e){D(e.message+" ("+c+")")}}a.S=b}function ue(a,b,c,d){var e=b.toLowerCase();e=ob(b)||ob(e);var f=y.resources;void 0===e&&a.S&&(e=a.S[b]);void 0===e&&c&&(e=c[b]);void 0===e&&"object"==typeof f&&f[b]&&(e=b);void 0===e&&(e=void 0);if("string"==typeof e&&d)switch(d){case 4:e=+e;isNaN(e)&&(e=0);break;case 6:e="true"==e}return e}k=$k.prototype;
k.wait=function(a,b){for(var c=this,d=Ob(this.id),e=0;e<=d.length;e++){var f=e<d.length?d[e]:this;if(!Xb(f)){Xb(f,function(){c.wait(a,b)});return}}a.call(this,b)};function el(a,b){var c=new xc(a,"2.20",fl);if(c.load()&&gl(c)){var d=c.get(hl),e=b?b.get(hl):"unknown";d!=e&&(a.V("Machine state may be out-of-date\n("+d+" vs. "+e+")\nCheck your browser's local storage limits"),b||c.clear())}}
k.mc=function(a){void 0===a&&(a=this.g||(this.K?il:cl));if(!this.A){this.A++;var b=!1,c=!1;this.R=!1;var d=this.F||new xc(this,"2.20");if(a==jl)b=!0;else if(a>cl){if(d.load(this.K)){this.B=new xc(this,"2.20",kl);this.B.load()&&(ll(),a=ml,nl(this.B));this.B.set(hl,Ya("%T",new Date));this.B.store();var e=this.g&&!this.I;if(a==il||Kb("Click OK to restore the previous PDPjs machine state, or CANCEL to reset the machine.")){if(c=gl(d)){var f=d.get("code"),g=d.get("data");f&&("ok"==f?d.load(g):("error"==
f&&"no machine state"!=g?(this.V("Error: "+g),"unable to verify user"==g&&(lb(ol,""),this.j=null)):this.v("%s: %s\n",f,g),nl(d),d.load()?(c=gl(d),e=!0):c=!1))}e&&el(this,c?d:null)}else a==ml&&d.clear()}else el(this);delete this.K;delete this.F}e=Ob(this.id);for(f=0;f<e.length;f++)g=e[f],g!==this&&g!=this.i&&(c=pl(this,g,d,b,c));b=[d,a,c];a!=jl?this.wait(this.je,b):this.je(b)}};
function pl(a,b,c,d,e){if(!b.flags.da){b.flags.da=!0;var f=null;try{if(e&&((f=c.get(b.id))||(f=c.get(b.id.replace(/-[0-9]+\./i,".")))),"string"===typeof f&&(f=null),!b.Ca(f,d)&&f&&(D("Unable to restore state for "+b.type),a.M&&!a.U?(c.clear(),a.g=cl,y.location&&y.location.reload()):a.R=!0,b.Ca(null),e=!1),!d&&b.Qd){var g=b.Qd.split("|");for(a=0;a<g.length;a++)b.v(137438953472,"%s\n",g[a])}}catch(h){D("Error restoring state for "+b.type+" ("+h.message+")")}}return e}
k.je=function(a){var b=a[0],c=0>a[1];a=a[2];this.T=!0;this.flags.da=!0;var d=this.J.power;d&&(d.textContent="Shutdown");this.i&&(pl(this,this.i,b,c,a),Xc(this,-2),this.i.qa());this.R&&(ll(),b.clear());!c&&this.B&&(this.B.clear(),delete this.B);this.A=0};function ll(){xb("There may be a problem with your PDPjs machine.")}
function Xk(a,b,c){var d="none";if(a.A)return null;a.A--;var e=new xc(a,"2.20"),f=new xc(a,"2.20",fl),g=Ya("%T",new Date);f.set(hl,g);e.set(hl,g);e.set(ql,"2.20");e.set(rl,y.location?y.location.href:null);e.set(sl,y.navigator?y.navigator.userAgent:"");if(a.i&&a.i.Ba){c&&(b&&(a.i.flags.qa=a.i.flags.X),Ic(a.i));var h=a.i.Ba(b,c);"object"===typeof h&&e.set(a.i.id,h);c&&(a.i.flags.da=!1,!1===h&&(d=null))}g=Ob(a.id);for(var l=0;l<g.length;l++){var m=g[l];m.flags.da&&(m.Ba&&(h=m.Ba(b,c),"object"===typeof h&&
e.set(m.id,h)),c&&(m.flags.da=!1,!1===h&&(d=null)))}d&&(c?(g=h=!1,b?(a.j&&tl(a,a.j,e.toString()),f.store()&&e.store()||(d=null,h=g=!0)):a.g&&(h=!0,g=a.g==wl),h&&e.clear(g)):d=e.toString());c&&(a.flags.da=!1,b=a.J.power)&&(b.textContent="Power");a.A=0;return d}
k.reset=function(){this.flags.reset=!0;this.G&&this.G.reset&&(this.v("Resetting %s\n",this.G.type),this.G.reset());this.i&&this.i.reset&&(this.v("Resetting %s\n",this.i.type),this.i.reset());for(var a=Ob(this.id),b=0;b<a.length;b++){var c=a[b];c!==this&&c!==this.G&&c!==this.i&&c.reset&&(this.v("Resetting %s\n",c.type),c.reset())}this.flags.reset=!1;Xc(this,-1)};k.start=function(a,b){for(var c=Ob(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.start&&e.start(a,b)}Xc(this,-1)};
k.stop=function(a,b){for(var c=Ob(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.stop&&e.stop(a,b)}Xc(this,-1)};
function Xc(a,b){if(a.i){var c=a.i,d=b||0,e=c.J.speed;e&&(0>=d||30<=(c.ed+=d))&&(e.textContent=c.flags.X?c.qb.toFixed(2)+"Mhz":"Stopped",c.ed=0)}if(a.u&&(a=a.u,b=b||0,a.C)){c=a.i.flags.X;d=!!(a.i.u&8);if(0>=b||60<=(a.B+=b)){for(e=0;e<a.i.j.length;e++)Cc(a,"R"+e,a.i.j[e]);e=Qd(a.i);Cc(a,"PS",e);Cc(a,"NF",e&8?1:0,1);Cc(a,"ZF",e&4?1:0,1);Cc(a,"VF",e&2?1:0,1);Cc(a,"CF",e&1?1:0,1);a.B=0}-1>b?a.ga=a.i.j[7]:0<b&&c&&!d&&(a.ga=a.i.Na);yc(a,a.ga);oc(a,a.yb);b=a.i;b=b.sb?b.Z&16?1:2:4;dd(a,"B22",b&1);dd(a,"B18",
b&2);dd(a,"B16",b&4)}}
k.ua=function(a,b,c){var d=this;switch(b){case "power":return this.J[b]=c,c.onclick=function(){d.A||(d.flags.da?Xk(d,!1,!0):d.wait(d.mc))},!0;case "reset":return this.J[b]=c,c.onclick=function(){if(d.flags.da&&!d.A)if(d.g&&!d.D){var e=Kb("Click OK to save changes to this PDPjs machine.\n\nWARNING: If you CANCEL, all disk changes will be discarded.");Xk(d,e,!0);!e&&d.M?y.location&&y.location.reload():(e||(d.P=!0),d.mc(cl),d.P=!1)}else d.reset(),d.i&&!d.H&&d.i.qa()},!0;case "save":if(Ra(y.location?y.location.hostname:
"localhost","pcjs.org"))c.parentNode.removeChild(c);else return this.J[b]=c,c.onclick=function(){var e=bl(d,!0);if(e){var f=!!(d.g&&!d.D||d.M),g=Xk(d,f);f?tl(d,e,g):d.V("Resume disabled, machine state not saved")}},!0}return!1};
function bl(a,b){var c=a.j;c||((c=kb(ol),void 0!==c)?!c&&b&&(b=null,y.prompt&&(b=y.prompt("Saving machine states on the pcjs.org server is currently unsupported.\n\nIf you're running your own server, enter your user ID below.","")),c=b)&&((c=Gl(a,c))||a.V("The user ID is invalid.")):b&&a.V("Browser local storage is not available"));return c}
function Gl(a,b){a.j=null;b=$a(fb()+"/api/v1/user?req=verify&user="+b);var c=b[1];if(!b[0]&&c)try{b=eval("("+c+")"),b.code&&"ok"==b.code&&(lb(ol,b.data),a.j=b.data)}catch(d){D(d.message+" ("+c+")")}return a.j}function dl(a){var b=null;a.j&&(b=fb()+"/api/v1/user?req=load&user="+a.j+"&state="+Hl(a,"2.20"));return b}
function tl(a,b,c){if(c){var d={req:"store"};d.user=b;d.state=Hl(a,"2.20");d.data=c;b=$a(fb()+"/api/v1/user",d);d=b[0];if(b[1]){if(d){var e=d.indexOf("\n");0<e&&(d=d.substr(0,e));d.indexOf("Error: ")||(d=d.substr(7))}d='{"code":'+b[1]+',"data":"'+d+'"}'}b=JSON.parse(d);b&&"ok"==b.code?a.V("Machine state saved to server"):c&&(c=b&&b.data||"unable to save machine state",c="error"==b.code?"Error: "+c:"Error "+b.code+": "+c,a.V(c),lb(ol,""),a.j=null)}}
function ai(a){var b=void 0===b?null:b;a=Ob(a.id);for(var c=0;c<a.length;c++){var d=a[c];if(b)b==d&&(b=null);else if("RAM"==d.type)return d}return null}function Ee(a,b){if(a.C){var c=0,d=0;!b&&window&&(c=window.scrollX,d=window.scrollY);a.C.focus();!b&&window&&window.scrollTo(c,d)}}var kl="failsafe",fl="validate",hl="timestamp",ql="version",rl="url",sl="browser",ol="user",jl=-1,cl=0,il=1,ml=2,wl=3;
vb(function(){for(var a=Mb("pdp11","machine"),b=0;b<a.length;b++){var c=a[b],d=Nb(c);c=Mb("pdp11","computer",c);for(var e=0;e<c.length;e++){var f=c[e],g=Nb(f);g=new $k(g,d,!0);Lb(g,f);g.O&&g.wait(g.mc)}}});wb.show.push(function(){for(var a=Mb("pdp11","computer"),b=0;b<a.length;b++){var c=Nb(a[b]);if(c=Qb("Computer",c.id))c.flags.Ed=!1,c.T&&!c.flags.da&&c.mc(jl)}});
wb.exit.push(function(){for(var a=Mb("pdp11","computer"),b=0;b<a.length;b++){var c=Nb(a[b]);if(c=Qb("Computer",c.id))c.flags.Ed=!0,c.flags.da&&Xk(c,!(!c.g||c.D),!0)}});function xc(a,b,c){this.id=a.id;this.g="";this.i={};this.j=this.G=!1;this.key=Hl(a,b,c);nl(this,a.rf)}k=xc.prototype;k.set=function(a,b){try{this.i[a]=b}catch(c){C(1099511627776,c.message)}};k.get=function(a){return this.i[a]||null};k.data=function(){return this.i};
k.load=function(a){return a?(this.g=a,this.j=!0,this.G=!1,!0):this.j?!0:hb()&&(a=kb(this.key))?(this.g=a,this.j=!0):!1};function gl(a){var b=!0;if(!a.G)try{a.i=JSON.parse(a.g),a.G=!0}catch(c){D(c.message||c),b=!1}return b}k.store=function(){var a=!0;if(hb()){var b=JSON.stringify(this.i);lb(this.key,b)||(C(1099511627776,"Unable to store %d bytes in browser local storage\n",b.length),a=!1)}return a};k.toString=function(){return this.i?JSON.stringify(this.i):this.g};
function nl(a,b){a.g="";a.i={};a.j=a.G=!1;b&&a.set("parms",b)}k.clear=function(a){nl(this);var b=[];if(hb())try{for(var c=0,d=y.localStorage.length;c<d;c++)b.push(y.localStorage.key(c))}catch(f){jb(f)}for(c=0;c<b.length;c++)if((d=b[c])&&(a||d.substr(0,this.key.length)==this.key)){var e=d;if(hb())try{y.localStorage.removeItem(e)}catch(f){jb(f)}C(2199023255552,"localStorage(%s) removed\n",d);b.splice(c,1);c=0}};
function Hl(a,b,c){a=a.id;if(b){var d=b.indexOf(".");0<d&&(a+=".v"+b.substr(0,d))}c&&(a+="."+c);return a}var Il=0;function Jl(a,b,c,d,e,f,g,h,l){h("Loading "+a+"...");$a(a,null,!0,function(m,n,p){p?(n||(n="unable to load "+a+" ("+p+")"),l(m,n,null)):Kl(n,a,b,c,d,e,f,g,h,l)})}
function Kl(a,b,c,d,e,f,g,h,l,m){function n(p,q,r){if(r)m(p,r,null);else{c&&(Ib(c,b,q),(r=b)&&0>r.indexOf("/")&&"/"==window.location.pathname.slice(-1)&&(r=window.location.pathname+r),f?"}"==f.slice(-1)?(f=f.slice(0,-1),1<f.length&&(f+=",")):f='{state:"'+f+'",':f="{",f+='url:"'+r+'"}',"object"==typeof resources&&(r=null),f=f.replace(/\$/g,"$$$$").replace(/'/g,"&apos;"),g&&(p=q.match(/(<machine[^>]*\sclass=)(['"])(.*?)(\2[^>]*>)/))&&(q=q.replace(p[0],p[1]+p[2]+g+p[4]),g=""),(p=q.match(/(<machine[^>]*\sdebugger=)(['"])(available)(\2[^>]*>)/))&&
(q=q.replace(p[0],p[1]+p[2]+"optional"+p[4])),q=q.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+c+"$2"+(g?' class="'+g+'"':"")+(f?" parms='"+f+"'":"")+(r?' url="'+r+'"':"")));h||(q=q.replace(/(<xsl:variable name="APPNAME">).*?(<\/xsl:variable>)/,"$1"+d+"$2"),q=q.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1"+e+"$2"),q=q.replace(/<xsl:variable name="APPVERSION"(\/>|>[^<]*<\/xsl:variable>)/,'<xsl:variable name="APPVERSION">2.20</xsl:variable>'));p=null;if("<"==q.charAt(0))try{h||
(q=q.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(p=new window.ActiveXObject("Microsoft.XMLDOM"),p.async=!1,p.loadXML(q)):p=(new window.DOMParser).parseFromString(q,"text/xml")}catch(w){p=null,q=w.message}else q="unrecognized XML: "+(255<q.length?q.substr(0,255)+"...":q);m(b,q,p)}}a?h?Ll(b,a,l,n):n(b,a,""):m(b,"no data",null)}
function Ll(a,b,c,d){var e;if(e=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(b)){var f=e[2];c("Loading "+f+"...");$a(f,null,!0,function(g,h,l){if(l||!h)d(g,b,"unable to resolve XML reference: "+e[0]+" ("+l+")");else{if(l=e[3]){var m=h.match(new RegExp("<"+e[1]+"[^>]*>"));if(m){for(var n=m[0],p,q=/( [a-z]+=)(['"])(.*?)\2/gi;p=q.exec(l);)n=0>n.toLowerCase().indexOf(p[1].toLowerCase())?n.replace(">",p[0]+">"):n.replace(new RegExp(p[1]+"(['\"])(.*?)\\1"),p[0]);m[0]!=n&&(h=h.replace(m[0],n))}else{d(g,b,"missing <"+
e[1]+"> in "+f);return}}h=h.replace(/<\?xml[^>]*>[\r\n]*/,"");b=b.replace(e[0],h);Ll(g,b,c,d)}})}else d(a,b,"")}
function Ml(a,b,c,d,e,f,g){function h(x){if(void 0===p){var W=n&&Mb("machine-warning","",n);p=W&&W[0]||n}p&&(p.innerHTML=Sa(x))}function l(x,W){if("string"==typeof W&&0<=W.indexOf("<!DOCTYPE html>")){var oa=W.match(/<title>(?:PCjs: |)(.*?)<\/title>/);oa&&(W=oa[1])}C(1099511627776,"%s\n",W);h("Error: "+W+(x?" ("+x+")":""));q&&m();q=!1}function m(){--Il||Ab(!0)}var n,p,q=!0;Il++;A.machines[c]={};if(!d)return f&&Ib(c,"parms",f),m(),q;"true"==ob("debugger")&&0>d.indexOf("/debugger")&&(d=d.replace("/machine.xml",
"/debugger/machine.xml"));try{if(n=document.getElementById(c)){var r,w=y.resources;if("object"==typeof w&&(r=w.css)){var B=document.head||document.getElementsByTagName("head")[0],z=document.createElement("style");z.type="text/css";z.styleSheet?z.styleSheet.cssText=r:z.appendChild(document.createTextNode(r));B.appendChild(z)}e||(e="/machines/"+b+"/xsl/components.xsl");b=b.split("/").pop();r=function(x,W,oa){oa?Jl(e||"","",a,b,"","",!1,h,function(I,Oa,Y){if(Y)if(Ib(c,e||"",Oa),h("Processing "+d+"..."),
window.ActiveXObject||"ActiveXObject"in window)(Y=oa.transformNode(Y))?(n.outerHTML=Y,m()):l(I,"transformNodeToObject failed");else if(document.implementation&&document.implementation.createDocument)if(Oa=new XSLTProcessor,Oa.importStylesheet(Y),Y=Oa.transformToFragment(oa,document))if(Oa=n.parentNode){var ua=I=0,va=n.getBoundingClientRect();0>va.bottom&&(I=window.scrollX,ua=window.scrollY);Oa.replaceChild(Y,n);(n=document.getElementById(c))&&0>va.bottom&&(Y=n.getBoundingClientRect(),ua=window.performance&&
window.performance.navigation.type==window.performance.navigation.TYPE_RELOAD?0:ua+Math.ceil(Y.height-va.height),window.scrollTo(I,ua));m()}else l(I,"invalid machine element: "+c);else l(I,"transformToFragment failed");else l(I,"unable to transform XML: unsupported browser");else l(I,Oa)}):l(x,W)};"<"!=d.charAt(0)?Jl(d,c,a,b,f||"",g||"",!0,h,r):Kl(d,"",c,a,b,f||"",g||"",!1,h,r)}else l(d,"missing machine element: "+c)}catch(x){l(d,x.message)}return q}
function Nl(a,b,c,d,e){Ab(!1);return Ml("PCx86","pcx86",a,b,c,d,e)}y.embedC1P=function(a,b,c,d,e){Ab(!1);return Ml("C1Pjs","osi/c1p",a,b,c,void 0,e)};y.embedPC=Nl;y.embedPCx86=Nl;y.embedPCx80=function(a,b,c,d,e){Ab(!1);return Ml("PCx80","pcx80",a,b,c,d,e)};y.embedPDP10=function(a,b,c,d,e){Ab(!1);return Ml("PDPjs","dec/pdp10",a,b,c,d,e)};y.embedPDP11=function(a,b,c,d,e){Ab(!1);return Ml("PDPjs","dec/pdp11",a,b,c,d,e)};
y.commandMachine=function(a,b,c,d,e,f){if("script"==e){d=!1;e=A.commands;c+=".machine";if(!f)delete e[c],d=!0;else if("string"==typeof f&&!e[c]){d=!0;for(var g=c,h=f.length,l=[],m=[],n="",p=null,q=0;q<h;q++){var r=f[q];if('"'==r||"'"==r)p&&r!=p?n+=r:(p?p=null:p=r,n&&(m.push(n),n=""));else{if(!p){if("\r"==r||"\n"==r)r=";";if(" "==r||"\t"==r||";"==r){n&&(m.push(n),n="");";"==r&&m.length&&(l.push(m),m=[]);continue}}n+=r}}n&&m.push(n);m.length&&l.push(m);e[g]=l;Rb(c)||(d=!1)}return d?(b&&(a.disabled=
!0),!0):!1}if(d&&(g=Qb(d,c+".machine"))&&(h=g.exports)&&(h=h[e]))return h.call(g,f)?(b&&(a.disabled=!0),!0):!1;console.log("unimplemented: commandMachine('"+c+"','"+d+"','"+e+"','"+f+"')");return!1};y.enableEvents=Ab;y.sendEvent=yb;})()

//# sourceMappingURL=pdp11.js.map
